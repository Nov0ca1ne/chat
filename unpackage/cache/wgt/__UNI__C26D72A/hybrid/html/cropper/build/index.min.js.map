{"version":3,"sources":["webpack://SimpleCrop/webpack/universalModuleDefinition","webpack://SimpleCrop/webpack/bootstrap","webpack://SimpleCrop/./index.js","webpack://SimpleCrop/./node_modules/prefix-umd/index.js","webpack://SimpleCrop/./node_modules/exif-js/exif.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/applyToPoint.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/fromObject.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/fromString.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/identity.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/inverse.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/utils.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/isAffineMatrix.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/translate.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/transform.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/rotate.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/scale.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/shear.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/skew.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/toString.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/smoothMatrix.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/fromTriangles.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/fromDefinition.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/fromTransformAttribute.autogenerated.js","webpack://SimpleCrop/./node_modules/transformation-matrix/src/fromTransformAttribute.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Prefix","EXIF","TransformationMatrix","transitionEndEvent","el","document","createElement","transitions","transition","OTransition","MozTransition","WebkitTransition","MsTransition","undefined","style","whichTransitionEvent","transformProperty","prefix","transitionProperty","SimpleCrop","params","this","id","Date","getTime","initSize","width","size","height","visible","debug","$container","body","self","passiveSupported","options","addEventListener","err","isSupportTouch","_precision","_multiPoint","_rotateScale","_baseMoveX","_curMoveX","_changedX","_downPoints","_isControl","_baseAngle","scaleTimes","rotateAngle","construct","initFuncBtns","initRotateSlider","initChilds","initTitle","initBox","initBoxBorder","initBoxCursor","setImage","src","bindEvent","Array","includes","valueToFind","fromIndex","len","length","x","y","k","Math","max","abs","isNaN","title","$title","querySelector","innerText","onlyInit","borderWidth","borderColor","boldCornerLen","boldCornerWidth","coverColor","coverDraw","borderDraw","defaultBorderDraw","$cropCover","defaultCursorWidth","cursorHoverWidth","isFixedAspectRatio","funcBtns","cropCallback","closeCallback","uploadCallback","$cropBtns","html","innerHTML","$uploadBtn","removeEventListener","__uploadInput","uploadInput","$uploadInput","$cropBtn","__crop","crop","$aroundBtn","__around","around","$resetBtn","reset","__reset","$closeBtn","close","__close","visibility","rotateSlider","startAngle","endAngle","gapAngle","lineationItemWidth","parseInt","ceil","lineationWidth","$cropRotate","$lineation","$rotateCurrent","rotateStyle","getComputedStyle","rotateWidth","parseFloat","getPropertyValue","angle","startControl","transform","endControl","$cropMask","maskRect","getBoundingClientRect","maskViewSize","top","left","cropCoverContext","getContext","devicePixelRatio","positionOffset","cropSizePercent","updateBox","times","cropRect","initCropRect","cropPoints","rectToPoints","cropCenter","getPointsCenter","getControlPoints","e","touches","clientX","clientY","getControlEvents","start","move","end","cancel","$target","classList","add","appendChild","coverWidth","coverHeight","clearRect","fillStyle","fillRect","borderRect","txtCanvas","ctx","font","textBaseline","textAlign","curSizeWidth","curSizeHeight","fillText","drawImage","init","contentWidth","contentHeight","initContentPoints","contentPoints","slice","initScale","_contentCurMoveX","_contentCurMoveY","load","originImage","onload","getData","_orientation","getTag","getRealCotentSize","transformCoordinates","image","type","toString","Image","crossOrigin","fileToSrc","show","hide","getCropImage","$resultCanvas","evt","files","target","moveCursor","point","innerRect","outerRect","cursor","_moveCursor","cropMove","movePos","startPos","moveCursorAction","_moveCursorAction","toLowerCase","changeX","finalMovePos","indexOf","tag","fixedChangeY","controlEvents","moveX","curMoveX","translate","getRotateTranslate","translateX","translateY","stopPropagation","preventDefault","$imageListenerEle","ev","center","fingerLen","sqrt","pow","fingerScale","fingerCenter","passive","capture","newScale","getScaleTranslate","contentMove","_wheelTimeout","wheelDelta","clearTimeout","setTimeout","scale","scaleCenter","fingerPoints","push","newCenter","rotateCenter","vec","toFixed","vecLen","rad","PI","newVec","cos","sin","$cropContent","removeChild","imageCtx","rotate","_initTransform","position","insertBefore","scaleNum","cropWidth","cropHeight","ratio","$contentCanvas","contentCtx","$cropCanvas","newSize","newTimes","newRectPoints","newRectCenter","pLens","minIndexs","minLen","j","cropScaleCenter","horizontal","vertical","cropScale","isWholeCover","coverTr","getCoverTransform","coverMat","getTransformMatrix","f","getTransformPoints","coverTrAr","substring","trim","split","no","tr","isTwoFingerEvent","moveY","rotateCover","scaleKeepCover","scMat","rotatePoints","coverScale","getCoverRectScale","changedX","totalMoveX","centerVec","percent","outer","inner","num","getCoverPointScale","rectA","rectB","isPointInRectCheckByLen","rectPoints","pcv","getPCVectorProjOnUpAndRight","uLen","uproj","up","rLen","rproj","right","onlyTranslate","cRect","getCoveRect","uScale","rScale","cup","cright","tup","tright","uAng","vecAngle","scalePoints","count","outDetails","getOutDetails","sort","a","b","aLen","iv","bLen","maxFarOut","maxFarPcv","uOver","rAng","rOver","pt","rect","nRect","points","matrix","nPoints","item","applyToPoint","reverse","transforms","result","func","getTransformFunctionName","compose","arr","defParams","unshift","getProjectionVector","vecA","vecB","ab","line","round","isPointInRectCheckByAngle","vecs","sIndex","sLen","eVec","sVec","splice","tVec","angles","data","getMinAngle","index","sum","aVec","minAngle","minIndex","vec1","vec2","acos","file","callback","reader","FileReader","readAsDataURL","prefixes","upper","memo","replace","_","char","toUpperCase","Key","charAt","dash","test","lastIndex","obj","EXIFwrapped","ExifTags","Tags","TiffTags","GPSTags","0","IFD1Tags","StringValues","ExposureProgram","1","2","3","4","5","6","7","8","MeteringMode","255","LightSource","9","10","11","12","13","14","15","17","18","19","20","21","22","23","24","Flash","SensingMethod","SceneCaptureType","SceneType","CustomRendered","WhiteBalance","GainControl","Contrast","Saturation","Sharpness","SubjectDistanceRange","FileSource","Components","imageHasData","img","getImageData","handleBinaryFile","binFile","findEXIFinJPEG","exifdata","iptcdata","dataView","DataView","getUint8","offset","byteLength","isFieldSegmentStart","nameHeaderLength","startOffset","sectionLength","getUint16","readIPTCData","findIPTCinJPEG","isXmpEnabled","xmpdata","dom","DOMParser","getStringFromDB","xmpString","xmpEndIndex","indexOfXmp","xml2Object","parseFromString","findXMPinJPEG","base64","contentType","match","binary","atob","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","base64ToArrayBuffer","fileReader","url","http","XMLHttpRequest","open","responseType","status","response","send","objectURLToBlob","blob","readAsArrayBuffer","Blob","File","readEXIFData","IptcFieldMap","fieldValue","fieldName","dataSize","segmentType","segmentStartPos","getInt16","readTags","tiffStart","dirStart","strings","bigEnd","entryOffset","entries","tags","readTagValue","vals","val","numerator","denominator","numValues","getUint32","valueOffset","Number","getInt32","outstr","String","fromCharCode","exifData","gpsData","tiffOffset","firstIFDOffset","ExifIFDPointer","GPSInfoIFDPointer","IFD1OffsetPointer","getNextIFDOffset","thumbTags","JpegIFOffset","JpegIFByteCount","tOffset","tLength","console","log","readThumbnailImage","xml2json","xml","json","nodeType","attributes","attribute","nodeName","nodeValue","hasChildNodes","childNodes","child","old","children","idx","itemAtt","dataKey","dataValue","textContent","message","enableXmp","disableXmp","HTMLImageElement","complete","getIptcTag","getAllTags","getAllIptcTags","pretty","strPretty","readFromBinaryFile","isArray","applyToPoints","map","fromObject","matrixRegex","fromString","string","parsed","Error","identity","inverse","denom","isUndefined","isNumeric","isFinite","isAffineMatrix","tx","ty","matrices","multiply","m1","m2","rest","cx","cy","cosAngle","sinAngle","rotationMatrix","rotateDEG","sx","sy","scaleMatrix","shear","shx","shy","tan","skew","ax","ay","skewDEG","toCSS","toSVG","smoothMatrix","precision","fromTriangles","t1","t2","px1","py1","px2","py2","qx1","qy1","qx2","qy2","rx1","ry1","rx2","ry2","fromDefinition","definitionOrArrayOfDefinition","mapper","descriptor","peg$SyntaxError","expected","found","location","captureStackTrace","peg$parse","input","peg$result","peg$FAILED","peg$startRuleFunctions","transformList","peg$parsetransformList","peg$startRuleFunction","peg$r0","peg$r1","peg$r2","peg$r3","peg$e0","peg$literalExpectation","peg$e1","peg$e2","peg$e3","peg$e4","peg$e5","peg$e6","peg$e7","peg$e8","peg$e9","peg$otherExpectation","peg$e10","peg$classExpectation","peg$e11","peg$e12","peg$e13","peg$currPos","peg$posDetailsCache","column","peg$expected","peg$silentFails","startRule","text","ignoreCase","parts","inverted","description","peg$computePosDetails","pos","details","peg$VALIDFILENAME","filename","peg$computeLocation","endPos","loc","startPosDetails","endPosDetails","peg$expect","variants","peg$buildStructuredError","buildMessage","s0","s1","s2","s3","s4","peg$parsewsp","peg$parsetransforms","peg$parsetransform","peg$parsecommaWsp","ts","concat","s5","s7","s9","s11","s13","s15","s16","s17","rule$expects","substr","peg$parsenumber","peg$parsematrix","s6","s8","peg$parsecommaWspNumber","peg$parsetranslate","peg$parsescale","peg$parsecommaWspTwoNumbers","peg$parserotate","peg$parseskewX","peg$parseskewY","peg$parsesign","peg$parsedigitSequence","d2","d1","join","peg$parsefractionalConstant","peg$parseexponent","peg$f14","peg$parsefloatingPointConstant","peg$parseintegerConstant","peg$parsecomma","peg$parsedigit","failPos","peg$buildError","parent","C","constructor","peg$subclass","DESCRIBE_EXPECTATION_FNS","literal","expectation","literalEscape","class","escapedParts","part","classEscape","any","other","not","describeExpectation","hex","ch","descriptions","describeExpected","describeFound","fromTransformAttribute","transformString"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,GACe,iBAAZC,QACdA,QAAoB,WAAID,IAExBD,EAAiB,WAAIC,IARvB,CASGK,QAAQ,WACX,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUP,QAGnC,IAAIC,EAASI,EAAiBE,GAAY,CACzCC,EAAGD,EACHE,GAAG,EACHT,QAAS,IAUV,OANAU,EAAQH,GAAUI,KAAKV,EAAOD,QAASC,EAAQA,EAAOD,QAASM,GAG/DL,EAAOQ,GAAI,EAGJR,EAAOD,QA0Df,OArDAM,EAAoBM,EAAIF,EAGxBJ,EAAoBO,EAAIR,EAGxBC,EAAoBQ,EAAI,SAASd,EAASe,EAAMC,GAC3CV,EAAoBW,EAAEjB,EAASe,IAClCG,OAAOC,eAAenB,EAASe,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhEV,EAAoBgB,EAAI,SAAStB,GACX,oBAAXuB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAenB,EAASuB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAenB,EAAS,aAAc,CAAEyB,OAAO,KAQvDnB,EAAoBoB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQnB,EAAoBmB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAxB,EAAoBgB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOnB,EAAoBQ,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRvB,EAAoB2B,EAAI,SAAShC,GAChC,IAAIe,EAASf,GAAUA,EAAO2B,WAC7B,WAAwB,OAAO3B,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAK,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG7B,EAAoBgC,EAAI,GAIjBhC,EAAoBA,EAAoBiC,EAAI,G,kBClFrD,UAKI,EAAO,CAAC,KAAc,KAAW,WAAiC,0BAAP,EAgB5D,SAASC,EAAQC,EAAMC,GAkBxB,IAAIC,EAhBJ,WACE,IAAIjB,EACAkB,EAAKC,SAASC,cAAc,OAC5BC,EAAc,CAChBC,WAAY,gBACZC,YAAa,iBACbC,cAAe,gBACfC,iBAAkB,sBAClBC,aAAc,mBAEhB,IAAK1B,KAAKqB,EACR,QAAoBM,IAAhBT,EAAGU,MAAM5B,GACX,OAAOqB,EAAYrB,GAIA6B,GACrBC,EAAoBhB,EAAOiB,OAAO,aAClCC,EAAqBlB,EAAOiB,OAAO,cA6HvC,SAASE,EAAWC,GAElBC,KAAKC,GAAK,SAAU,IAAIC,MAAOC,UAC/BH,KAAKI,SAAW,CACdC,MAAON,EAAOO,KAAKD,MACnBE,OAAQR,EAAOO,KAAKC,QAEtBP,KAAKQ,QAA4B,MAAlBT,EAAOS,SAAkBT,EAAOS,QAC/CR,KAAKS,MAAwB,MAAhBV,EAAOU,OAAgBV,EAAOU,MAC3CT,KAAKU,WACkB,MAArBX,EAAOW,WAAqBX,EAAOW,WAAa1B,SAAS2B,KAG3D,IAAIC,EAAOZ,KACXY,EAAKC,kBAAmB,EACxB,IACE,IAAIC,EAAUzD,OAAOC,eAAe,GAAI,UAAW,CACjDE,IAAK,WACHoD,EAAKC,kBAAmB,KAG5BtE,OAAOwE,iBAAiB,OAAQ,KAAMD,GACtC,MAAOE,IAGThB,KAAKiB,eAAiB,eAAgBjC,SACtCgB,KAAKkB,WAAa,EAGlBlB,KAAKmB,aAAc,EACnBnB,KAAKoB,aAAe,EACpBpB,KAAKqB,WAAa,EAClBrB,KAAKsB,UAAY,EACjBtB,KAAKuB,UAAY,EACjBvB,KAAKwB,YAAc,GACnBxB,KAAKyB,YAAa,EAMlBzB,KAAK0B,WAAa,EAClB1B,KAAK2B,WAAa,EAClB3B,KAAK4B,YAAc,EAEnB5B,KAAK6B,YAEL7B,KAAK8B,aAAa/B,GAClBC,KAAK+B,iBAAiBhC,GACtBC,KAAKgC,aACLhC,KAAKiC,UAAUlC,GACfC,KAAKkC,QAAQnC,GACbC,KAAKmC,cAAcpC,GAAQ,GAC3BC,KAAKoC,cAAcrC,GACnBC,KAAKqC,SAAuB,MAAdtC,EAAOuC,IAAcvC,EAAOuC,IAAMtC,KAAKsC,KACrDtC,KAAKuC,YAs5DP,OAvkEKC,MAAMjE,UAAUkE,UACnBpF,OAAOC,eAAekF,MAAMjE,UAAW,WAAY,CACjDX,MAAO,SAAS8E,EAAaC,GAC3B,IAAIvF,EAAIC,OAAO2C,MACX4C,EAAMxF,EAAEyF,SAAW,EACvB,GAAY,IAARD,EACF,OAAO,EAeT,IAZA,IAGuBE,EAAGC,EAHtB3E,EAAgB,EAAZuE,EACJK,EAAIC,KAAKC,IAAI9E,GAAK,EAAIA,EAAIwE,EAAMK,KAAKE,IAAI/E,GAAI,GAW1C4E,EAAIJ,GAAK,CACd,IAVqBE,EAUH1F,EAAE4F,OAVID,EAUAL,IAPR,iBAANI,GACO,iBAANC,GACPK,MAAMN,IACNM,MAAML,GAKR,OAAO,EAETC,IAEF,OAAO,KA0JblD,EAAWvB,UAAU0D,UAAY,SAASlC,GACxCC,KAAKqD,MAAwB,MAAhBtD,EAAOsD,MAAgBtD,EAAOsD,MAAQ,GACnDrD,KAAKsD,OAAStE,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,gBACrDD,KAAKsD,OAAOE,UAAYxD,KAAKqD,OAI/BvD,EAAWvB,UAAU4D,cAAgB,SAASpC,EAAQ0D,GACpDzD,KAAK0D,YAAoC,MAAtB3D,EAAO2D,YAAsB3D,EAAO2D,YAAc,EACrE1D,KAAK2D,YAAoC,MAAtB5D,EAAO4D,YAAsB5D,EAAO4D,YAAc,OACrE3D,KAAK4D,cACqB,MAAxB7D,EAAO6D,cAAwB7D,EAAO6D,cAAgB,GACxD5D,KAAK6D,gBAAkB9D,EAAO8D,gBAAkB9D,EAAO8D,gBAAkB,EACzE7D,KAAK8D,WACkB,MAArB/D,EAAO+D,WAAqB/D,EAAO+D,WAAa,iBAClD9D,KAAK+D,UACiB,MAApBhE,EAAOgE,UAAoBhE,EAAOgE,UAAY,aAChD/D,KAAKgE,WACkB,MAArBjE,EAAOiE,WAAqBjE,EAAOiE,WAAahE,KAAKiE,kBAElDR,IACHzD,KAAKgE,WAAWhE,KAAKkE,YACrBlE,KAAK+D,UAAU/D,KAAKkE,cAKxBpE,EAAWvB,UAAU6D,cAAgB,SAASrC,GAC5C,MAAMoE,EAAqBnE,KAAKiB,eACT,GAAnBjB,KAAK0D,YACc,EAAnB1D,KAAK0D,YACT1D,KAAKoE,iBACwB,MAA3BrE,EAAOqE,iBACHrE,EAAOqE,iBACPD,EAENnE,KAAKqE,mBAC0B,MAA7BtE,EAAOsE,oBAA6BtE,EAAOsE,oBAI/CvE,EAAWvB,UAAUuD,aAAe,SAAS/B,GAS3CC,KAAKsE,SACgB,MAAnBvE,EAAOuE,SACHvE,EAAOuE,SACP,CAAC,QAAS,OAAQ,SAAU,SAClCtE,KAAKuE,aACoB,MAAvBxE,EAAOwE,aAAuBxE,EAAOwE,aAAe,aACtDvE,KAAKwE,cACqB,MAAxBzE,EAAOyE,cAAwBzE,EAAOyE,cAAgB,aACxDxE,KAAKyE,eACsB,MAAzB1E,EAAO0E,eAAyB1E,EAAO0E,eAAiB,aAE1DzE,KAAK0E,UAAY1F,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,eACxD,IAAI0E,EAAO,GACP3E,KAAKsE,SAAS7B,SAAS,YACzBkC,GAAQ,qCACRA,GAAQ,uCACRA,GAAQ,oDACRA,GAAQ,UAEN3E,KAAKsE,SAAS7B,SAAS,WACzBkC,GAAQ,wCAEN3E,KAAKsE,SAAS7B,SAAS,YACzBkC,GAAQ,yCAEN3E,KAAKsE,SAAS7B,SAAS,WACzBkC,GAAQ,wCAEN3E,KAAKsE,SAAS7B,SAAS,UACzBkC,GAAQ,sCAEV3E,KAAK0E,UAAUE,UAAYD,EAGvB3E,KAAKsE,SAAS7B,SAAS,YACrBzC,KAAK6E,WACP7E,KAAK6E,WAAWC,oBAAoB,SAAU9E,KAAK+E,eAEnD/E,KAAK+E,cAAgB/E,KAAKgF,YAAY7G,KAAK6B,MAE7CA,KAAK6E,WAAa7F,SAASuE,cACzB,IAAMvD,KAAKC,GAAK,0BAElBD,KAAKiF,aAAejG,SAASuE,cAC3B,IAAMvD,KAAKC,GAAK,gCAElBD,KAAK6E,WAAW9D,iBAAiB,SAAUf,KAAK+E,gBAI9C/E,KAAKsE,SAAS7B,SAAS,UACrBzC,KAAKkF,SACPlF,KAAKkF,SAASJ,oBAAoB,QAAS9E,KAAKmF,QAEhDnF,KAAKmF,OAASnF,KAAKoF,KAAKjH,KAAK6B,MAE/BA,KAAKkF,SAAWlG,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,cACvDD,KAAKkF,SAASnE,iBAAiB,QAASf,KAAKmF,SAI3CnF,KAAKsE,SAAS7B,SAAS,YACrBzC,KAAKqF,WACPrF,KAAKqF,WAAWP,oBAAoB,QAAS9E,KAAKsF,UAElDtF,KAAKsF,SAAWtF,KAAKuF,OAAOpH,KAAK6B,MAEnCA,KAAKqF,WAAarG,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,iBACzDD,KAAKqF,WAAWtE,iBAAiB,QAASf,KAAKsF,WAI7CtF,KAAKsE,SAAS7B,SAAS,WACrBzC,KAAKwF,UACPxF,KAAKwF,UAAUV,oBAAoB,QAAS9E,KAAKyF,OAEjDzF,KAAK0F,QAAU1F,KAAKyF,MAAMtH,KAAK6B,MAEjCA,KAAKwF,UAAYxG,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,gBACxDD,KAAKwF,UAAUzE,iBAAiB,QAASf,KAAK0F,UAI5C1F,KAAKsE,SAAS7B,SAAS,WACrBzC,KAAK2F,UACP3F,KAAK2F,UAAUb,oBAAoB,QAAS9E,KAAK4F,OAEjD5F,KAAK6F,QAAU7F,KAAK4F,MAAMzH,KAAK6B,MAEjCA,KAAK2F,UAAY3G,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,gBACxDD,KAAK2F,UAAU5E,iBAAiB,QAASf,KAAK6F,UAG5C7F,KAAKsE,SAASzB,OAAS,EACzB7C,KAAK0E,UAAUjF,MAAMqG,WAAa,GAElC9F,KAAK0E,UAAUjF,MAAMqG,WAAa,UAKtChG,EAAWvB,UAAUwD,iBAAmB,SAAShC,GAC/CC,KAAK+F,aACoB,MAAvBhG,EAAOgG,cAAuBhG,EAAOgG,aACvC/F,KAAKgG,WAAkC,MAArBjG,EAAOiG,WAAqBjG,EAAOiG,YAAc,GACnEhG,KAAKiG,SAA8B,MAAnBlG,EAAOkG,SAAmBlG,EAAOkG,SAAW,GAC5DjG,KAAKkG,SAA8B,MAAnBnG,EAAOmG,SAAmBnG,EAAOmG,SAAW,GAC5DlG,KAAKmG,mBAC0B,MAA7BpG,EAAOoG,mBAA6BpG,EAAOoG,mBAAqB,KAClEnG,KAAKmG,mBACHnG,KAAKmG,oBAAsB,KAAOnG,KAAKmG,mBAAqB,KAG9DnG,KAAKgG,WAAahG,KAAKgG,WAAa,EAAII,SAASpG,KAAKgG,YAAc,EACpEhG,KAAKiG,SAAWjG,KAAKiG,SAAW,EAAIG,SAASpG,KAAKiG,UAAY,EAC9DjG,KAAKkG,SAAWlG,KAAKkG,SAAW,EAAIE,SAASpG,KAAKkG,UAAY,GACzDlG,KAAKiG,SAAWjG,KAAKgG,YAAchG,KAAKkG,UAAY,IACvDlG,KAAKiG,SACHhD,KAAKoD,MAAMrG,KAAKiG,SAAWjG,KAAKgG,YAAchG,KAAKkG,UACjDlG,KAAKkG,SACPlG,KAAKgG,YAEThG,KAAKsG,eACHtG,KAAKmG,qBACHnG,KAAKiG,SAAWjG,KAAKgG,YAAchG,KAAKkG,SAAW,GAEvDlG,KAAKuG,YAAcvH,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,iBAC1DD,KAAKwG,WAAaxH,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,eACzDD,KAAKyG,eAAiBzH,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,aAC7D,IAAIyG,EAAcnK,OAAOoK,iBAAiB3G,KAAKuG,aAC/CvG,KAAK4G,YAAcC,WAAWH,EAAYI,iBAAiB,UAC3D9G,KAAKqB,aACFrB,KAAKsG,gBAAkB,EAAItG,KAAKgG,WAAahG,KAAKkG,SAAW,IAC3DlG,KAAKiG,SAAWjG,KAAKgG,WAAahG,KAAKkG,UAC1ClG,KAAK4G,YAAc,GAErB,IAAIG,EAAQ/G,KAAK4B,YAAc5B,KAAK0B,WACpC1B,KAAKsB,UACFyF,EAAQ/G,KAAKsG,gBACXtG,KAAKiG,SAAWjG,KAAKgG,WAAahG,KAAKkG,UAC1ClG,KAAKqB,YAILrB,KAAKsB,UAAY,GACjBtB,KAAKsB,UAAYtB,KAAK4G,YAAc5G,KAAKsG,kBAEzCtG,KAAKgH,eACLhH,KAAKsB,UAAYtB,KAAKqB,WACtBrB,KAAK0B,WAAa,EAClB1B,KAAK4B,YAAc,EACnB5B,KAAKuB,UAAY,EACjBvB,KAAKoB,aAAe,EACpBpB,KAAKiH,WAAU,GACfjH,KAAKkH,cAKP,IADA,IAAIvC,EAAO,GACFhI,EAAIqD,KAAKgG,WAAYrJ,GAAKqD,KAAKiG,SAAUtJ,GAAKqD,KAAKkG,SAC1DvB,GACE,2BAA6BhI,EAAI,oCAErCqD,KAAKwG,WAAW5B,UAAYD,EAC5B3E,KAAKwG,WAAW/G,MAAMY,MAAQL,KAAKsG,eAAiB,KACpDtG,KAAKwG,WAAW/G,MAAME,GACpB,cAAgBK,KAAKsB,UAAY,MAC/BtB,KAAK+F,aACP/F,KAAKuG,YAAY9G,MAAMqG,WAAa,GAEpC9F,KAAKuG,YAAY9G,MAAMqG,WAAa,UAKxChG,EAAWvB,UAAUyD,WAAa,WAChChC,KAAKmH,UAAYnI,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,eACxD,IAAImH,EAAWpH,KAAKmH,UAAUE,wBAC9BrH,KAAKsH,aAAe,CAClBC,IAAKH,EAASG,IACdC,KAAMJ,EAASI,KACfnH,MAAO+G,EAAS/G,MAChBE,OAAQ6G,EAAS7G,QAEnBP,KAAKkE,WAAalF,SAASuE,cAAc,IAAMvD,KAAKC,GAAK,gBACzDD,KAAKyH,iBAAmBzH,KAAKkE,WAAWwD,WAAW,MACnD1H,KAAKkE,WAAW7D,MAAQL,KAAKsH,aAAajH,MAAQ9D,OAAOoL,iBACzD3H,KAAKkE,WAAW3D,OAASP,KAAKsH,aAAa/G,OAAShE,OAAOoL,kBAI7D7H,EAAWvB,UAAU2D,QAAU,SAASnC,GACtCC,KAAKM,KAAOP,EAAOO,KACnBN,KAAK4H,eACsB,MAAzB7H,EAAO6H,eACH7H,EAAO6H,eACP,CACEL,IAAK,EACLC,KAAM,GAEdxH,KAAK6H,gBACuB,MAA1B9H,EAAO8H,gBAA0B9H,EAAO8H,gBAAkB,IAI9D/H,EAAWvB,UAAUuJ,UAAY,SAAS/H,GACxCC,KAAKkC,QAAQnC,GAEbC,KAAK+H,MACH/H,KAAKM,KAAKD,MAAQL,KAAKsH,aAAajH,MACpCL,KAAKM,KAAKC,OAASP,KAAKsH,aAAa/G,OACjCP,KAAKM,KAAKD,MAAQL,KAAKsH,aAAajH,MAAQL,KAAK6H,gBACjD7H,KAAKM,KAAKC,OAASP,KAAKsH,aAAa/G,OAASP,KAAK6H,gBAGzD7H,KAAKgI,SAAW,CACd3H,MAAOL,KAAKM,KAAKD,MAAQL,KAAK+H,MAC9BxH,OAAQP,KAAKM,KAAKC,OAASP,KAAK+H,OAElC/H,KAAKgI,SAASR,MACXxH,KAAKsH,aAAajH,MAAQL,KAAKgI,SAAS3H,OAAS,EAClDL,KAAK4H,eAAeJ,KACtBxH,KAAKgI,SAAST,KACXvH,KAAKsH,aAAa/G,OAASP,KAAKgI,SAASzH,QAAU,EACpDP,KAAK4H,eAAeL,IACtBvH,KAAKiI,aAAe,CAClBT,KAAMxH,KAAKgI,SAASR,KACpBD,IAAKvH,KAAKgI,SAAST,IACnBlH,MAAOL,KAAKgI,SAAS3H,MACrBE,OAAQP,KAAKgI,SAASzH,QAExBP,KAAKkI,WAAalI,KAAKmI,aAAanI,KAAKgI,UACzChI,KAAKoI,WAAapI,KAAKqI,gBAAgBrI,KAAKkI,YAE5ClI,KAAKgE,WAAWhE,KAAKkE,YACrBlE,KAAK+D,UAAU/D,KAAKkE,YACpBlE,KAAKiH,WAAU,GAAO,IAIxBnH,EAAWvB,UAAU+J,iBAAmB,SAASC,GAC/C,OAAIA,EAAEC,QACGD,EAAEC,QAEF,CACL,CACEC,QAASF,EAAEE,QACXC,QAASH,EAAEG,WAOnB5I,EAAWvB,UAAUoK,iBAAmB,WACtC,OAAI3I,KAAKiB,eACA,CACL2H,MAAO,aACPC,KAAM,YACNC,IAAK,WACLC,OAAQ,eAGH,CACLH,MAAO,YACPC,KAAM,YACNC,IAAK,UACLC,OAAQ,eAMdjJ,EAAWvB,UAAUsD,UAAY,WAC/B,IAAI8C,EAAO,GACXA,GAAQ,+BACRA,GAAQ,6BACRA,GAAQ,0BACRA,GAAQ,uCACRA,GAAQ,SAGJ3E,KAAK+F,aACPpB,GAAQ,4BAERA,GAAQ,uDAEVA,GAAQ,yBACRA,GAAQ,QACRA,GAAQ,8BACRA,GAAQ,SAGRA,GAAQ,2DACRA,GAAQ,SAER3E,KAAKgJ,QAAUhK,SAASC,cAAc,OACtCe,KAAKgJ,QAAQ/I,GAAKD,KAAKC,GACvBD,KAAKgJ,QAAQC,UAAUC,IAAI,oBACvBlJ,KAAKQ,QACPR,KAAKgJ,QAAQvJ,MAAMqG,WAAa,GAEhC9F,KAAKgJ,QAAQvJ,MAAMqG,WAAa,SAElC9F,KAAKgJ,QAAQpE,UAAYD,EACzB3E,KAAKU,WAAWyI,YAAYnJ,KAAKgJ,UAInClJ,EAAWvB,UAAU0F,kBAAoB,SAASC,GAChD,IAAIR,EAAc1D,KAAK0D,YACnBG,EAAkB7D,KAAK6D,gBACvBD,EAAgB5D,KAAK4D,cACzBA,EACEA,GAA+B,EAAdF,EAAkBE,EAA8B,EAAdF,EAErD,IAAI0F,EAAalF,EAAW7D,MACxBgJ,EAAcnF,EAAW3D,OAC7BP,KAAKyH,iBAAiB6B,UAAU,EAAG,EAAGF,EAAYC,GAClDrJ,KAAKyH,iBAAiB8B,UAAYvJ,KAAK8D,WACvC9D,KAAKyH,iBAAiB+B,SAAS,EAAG,EAAGJ,EAAYC,GAGjD,IAAII,EAAa,CACfjC,KAAMxH,KAAKgI,SAASR,KAAOjL,OAAOoL,iBAClCJ,IAAKvH,KAAKgI,SAAST,IAAMhL,OAAOoL,iBAChCtH,MAAOL,KAAKgI,SAAS3H,MAAQ9D,OAAOoL,iBACpCpH,OAAQP,KAAKgI,SAASzH,OAAShE,OAAOoL,kBAExC3H,KAAKyH,iBAAiB8B,UAAYvJ,KAAK2D,YACvC3D,KAAKyH,iBAAiB+B,SACpBC,EAAWjC,KACXiC,EAAWlC,IACXkC,EAAWpJ,MACXoJ,EAAWlJ,QAGTP,KAAK4D,cAAgB,IAEvB5D,KAAKyH,iBAAiB+B,SACpBC,EAAWjC,KAAO3D,EAClB4F,EAAWlC,IAAM1D,EACjBD,EACAA,GAEF5D,KAAKyH,iBAAiB+B,SACpBC,EAAWjC,KAAOiC,EAAWpJ,MAAQuD,EAAgBC,EACrD4F,EAAWlC,IAAM1D,EACjBD,EACAA,GAEF5D,KAAKyH,iBAAiB+B,SACpBC,EAAWjC,KAAO3D,EAClB4F,EAAWlC,IAAMkC,EAAWlJ,OAASqD,EAAgBC,EACrDD,EACAA,GAEF5D,KAAKyH,iBAAiB+B,SACpBC,EAAWjC,KAAOiC,EAAWpJ,MAAQuD,EAAgBC,EACrD4F,EAAWlC,IAAMkC,EAAWlJ,OAASqD,EAAgBC,EACrDD,EACAA,IAKJ,IAAI8F,EAAY1K,SAASC,cAAc,UACvCyK,EAAUrJ,MAAQoJ,EAAWpJ,MAC7BqJ,EAAUnJ,OAAS,GACnB,IAAIoJ,EAAMD,EAAUhC,WAAW,MAC/BiC,EAAIC,KAAO,eACXD,EAAIJ,UAAYvJ,KAAK2D,YACrBgG,EAAIE,aAAe,SACnBF,EAAIG,UAAY,SAChB,IAAIC,EAAe3D,SAChBpG,KAAKM,KAAKD,MAAQL,KAAKgI,SAAS3H,MAASL,KAAKiI,aAAa5H,OAE1D2J,EAAgB5D,SACjBpG,KAAKM,KAAKC,OAASP,KAAKgI,SAASzH,OAAUP,KAAKiI,aAAa1H,QAEhEoJ,EAAIM,SACFF,EAAe,MAAQC,EACvBN,EAAUrJ,MAAQ,EAClBqJ,EAAUnJ,OAAS,GAErBP,KAAKyH,iBAAiByC,UACpBR,EACA,EACA,EACAA,EAAUrJ,MACVqJ,EAAUnJ,OACVkJ,EAAWjC,KACXiC,EAAWlC,IAAM,GAAK,EAAIvH,KAAK6D,gBAC/B6F,EAAUrJ,MACVqJ,EAAUnJ,QAIZP,KAAKyH,iBAAiB6B,UACpBG,EAAWjC,KAAO9D,EAClB+F,EAAWlC,IAAM7D,EACjB+F,EAAWpJ,MAAQ,EAAIqD,EACvB+F,EAAWlJ,OAAS,EAAImD,IAK5B5D,EAAWvB,UAAU4L,KAAO,WAC1B,IAAI9J,EAAQL,KAAKoK,aAAe,EAC5B7J,EAASP,KAAKqK,cAAgB,EAClCrK,KAAKsK,kBAAoB,CACvB,CACExH,GAAIzC,EACJ0C,EAAGxC,GAEL,CACEuC,EAAGzC,EACH0C,EAAGxC,GAEL,CACEuC,EAAGzC,EACH0C,GAAIxC,GAEN,CACEuC,GAAIzC,EACJ0C,GAAIxC,IAGRP,KAAKuK,cAAgBvK,KAAKsK,kBAAkBE,QAI1CxK,KAAKM,KAAKD,MAAQL,KAAKM,KAAKC,OAC5BP,KAAKoK,aAAepK,KAAKqK,cAEzBrK,KAAKyK,UAAYzK,KAAKM,KAAKD,MAAQL,KAAKoK,aAExCpK,KAAKyK,UAAYzK,KAAKM,KAAKC,OAASP,KAAKqK,cAG3CrK,KAAKyF,SAIP3F,EAAWvB,UAAUkH,MAAQ,WAC3BzF,KAAKgH,eACLhH,KAAK0K,kBAAoB1K,KAAK4H,eAAeJ,KAC7CxH,KAAK2K,kBAAoB3K,KAAK4H,eAAeL,IAE7CvH,KAAKoB,aAAe,EACpBpB,KAAK0B,WAAa,EAClB1B,KAAK4B,YAAc,EACnB5B,KAAKsB,UAAYtB,KAAKqB,WACtBrB,KAAKuB,UAAY,EACjBvB,KAAKwG,WAAW/G,MAAME,GACpB,cAAgBK,KAAKqB,WAAa,MACpCrB,KAAK2B,WAAa3B,KAAKyK,UAEvBzK,KAAK8H,UAAU,CACbF,eAAgB5H,KAAK4H,eACrBC,gBAAiB7H,KAAK6H,gBACtBvH,KAAM,CACJD,MAAOL,KAAKI,SAASC,MACrBE,OAAQP,KAAKI,SAASG,UAG1BP,KAAKkH,cAIPpH,EAAWvB,UAAUqM,KAAO,WAC1B,IAAIhK,EAAOZ,KACXY,EAAKiK,YAAYC,OAAS,WACxBlM,EAAKmM,QAAQnK,EAAKiK,aAAa,WAC7BjK,EAAKoK,aAAepM,EAAKqM,OAAOjL,KAAM,eACtCY,EAAKsK,oBACLtK,EAAKuK,uBACLvK,EAAKuJ,YAMXrK,EAAWvB,UAAU8D,SAAW,SAAS+I,GACvC,GAAa,MAATA,GAA0B,IAATA,EAAa,CAChC,IAAIxK,EAAOZ,KACPqL,EAAOhO,OAAOkB,UAAU+M,SAASxO,KAAKsO,GAC7B,oBAATC,GAEFzK,EAAK0B,IAAM8I,EACXxK,EAAKiK,YAAc,IAAIU,MACvB3K,EAAKiK,YAAYW,YAAc,YAC/B5K,EAAKiK,YAAYvI,IAAM1B,EAAK0B,IAC5B1B,EAAKgK,OACLhK,EAAK6D,eAAe7D,EAAK0B,MACP,kBAAT+I,GAETzK,EAAK6K,UAAUL,GAAO,SAAS9I,GAC7B1B,EAAK0B,IAAMA,EACX1B,EAAKiK,YAAc,IAAIU,MACvB3K,EAAKiK,YAAYW,YAAc,YAC/B5K,EAAKiK,YAAYvI,IAAM1B,EAAK0B,IAC5B1B,EAAKgK,OACLhK,EAAK6D,eAAe7D,EAAK0B,UAOjCxC,EAAWvB,UAAUmN,KAAO,SAASN,GAC/BA,GACFpL,KAAKqC,SAAS+I,GAEhBpL,KAAKQ,SAAU,EACfR,KAAKgJ,QAAQvJ,MAAMqG,WAAa,IAIlChG,EAAWvB,UAAUoN,KAAO,WAC1B3L,KAAKQ,SAAU,EACfR,KAAKgJ,QAAQvJ,MAAMqG,WAAa,UAIlChG,EAAWvB,UAAUqH,MAAQ,WAC3B5F,KAAK2L,OACL3L,KAAKwE,iBAIP1E,EAAWvB,UAAU6G,KAAO,WAC1BpF,KAAK4L,eACL5L,KAAKuE,aAAavE,KAAK6L,eACvB7L,KAAK2L,QAIP7L,EAAWvB,UAAUyG,YAAc,SAAS8G,GAC1C,IAAIC,EAAQD,EAAIE,OAAOD,MACnBA,EAAMlJ,OAAS,GACjB7C,KAAK0L,KAAKK,EAAM,IAElB/L,KAAKiF,aAAarH,MAAQ,IAI5BkC,EAAWvB,UAAUgH,OAAS,WAC5BvF,KAAKgH,eACLhH,KAAK4B,aAAe5B,KAAK0B,WAAa,IAAM,IAC5C1B,KAAK0B,WAAa1B,KAAK4B,YACvB5B,KAAKsB,UAAYtB,KAAKqB,WACtBrB,KAAKuB,UAAY,EACjBvB,KAAKoB,aAAe,EACpBpB,KAAKwG,WAAW/G,MAAME,GACpB,cAAgBK,KAAKqB,WAAa,MACpCrB,KAAKiH,WAAU,GAAO,GACtBjH,KAAKkH,cAIPpH,EAAWvB,UAAU0N,WAAa,SAASzD,GACzC,IAAI0D,EACC1D,EAAQ,GAAGC,QAAUzI,KAAKsH,aAAaE,KADxC0E,EAEC1D,EAAQ,GAAGE,QAAU1I,KAAKsH,aAAaC,IAExC4E,EACInM,KAAKgI,SAASR,KAAOxH,KAAKoE,iBAD9B+H,EAEGnM,KAAKgI,SAAST,IAAMvH,KAAKoE,iBAF5B+H,EAGKnM,KAAKgI,SAAS3H,MAAQ,EAAIL,KAAKoE,iBAHpC+H,EAIMnM,KAAKgI,SAASzH,OAAS,EAAIP,KAAKoE,iBAEtCgI,EACIpM,KAAKgI,SAASR,KAAOxH,KAAKoE,iBAD9BgI,EAEGpM,KAAKgI,SAAST,IAAMvH,KAAKoE,iBAF5BgI,EAGKpM,KAAKgI,SAAS3H,MAAQ,EAAIL,KAAKoE,iBAHpCgI,EAIMpM,KAAKgI,SAASzH,OAAS,EAAIP,KAAKoE,iBAGxC8H,GAAWE,GACXF,GAAWE,EAAiBA,GAC5BF,GAAWE,GACXF,GAAWE,EAAmBA,KAE5BF,GAAWC,GACXD,GAAWC,EAAiBA,GAC5BD,GAAWC,GACXD,GAAWC,EAAmBA,GAI9BD,GAAWE,EAAiBpM,KAAK4D,eACjCsI,GAAWE,EAAgBpM,KAAK4D,eAEhC5D,KAAKkE,WAAWzE,MAAM4M,OAAS,cAC/BrM,KAAKsM,YAAc,gBAEnBJ,GAAWE,EAAiBpM,KAAK4D,eACjCsI,GAAWE,EAAmBA,EAAgBpM,KAAK4D,eAEnD5D,KAAKkE,WAAWzE,MAAM4M,OAAS,cAC/BrM,KAAKsM,YAAc,mBAEnBJ,GAAWE,EAAkBA,EAAiBpM,KAAK4D,eACnDsI,GAAWE,EAAgBpM,KAAK4D,eAEhC5D,KAAKkE,WAAWzE,MAAM4M,OAAS,cAC/BrM,KAAKsM,YAAc,iBAEnBJ,GAAWE,EAAkBA,EAAiBpM,KAAK4D,eACnDsI,GAAWE,EAAmBA,EAAgBpM,KAAK4D,eAEnD5D,KAAKkE,WAAWzE,MAAM4M,OAAS,cAC/BrM,KAAKsM,YAAc,oBAEnBJ,GAAWE,EAAgBpM,KAAK4D,gBAC/B5D,KAAKqE,oBAENrE,KAAKkE,WAAWzE,MAAM4M,OAAS,YAC/BrM,KAAKsM,YAAc,YAEnBJ,GAAWE,EAAmBA,EAAgBpM,KAAK4D,gBAClD5D,KAAKqE,oBAENrE,KAAKkE,WAAWzE,MAAM4M,OAAS,YAC/BrM,KAAKsM,YAAc,eAEnBJ,GAAWE,EAAiBpM,KAAK4D,gBAChC5D,KAAKqE,oBAENrE,KAAKkE,WAAWzE,MAAM4M,OAAS,YAC/BrM,KAAKsM,YAAc,aAEnBJ,GAAWE,EAAkBA,EAAiBpM,KAAK4D,gBAClD5D,KAAKqE,qBAENrE,KAAKkE,WAAWzE,MAAM4M,OAAS,YAC/BrM,KAAKsM,YAAc,eAGrBtM,KAAKkE,WAAWzE,MAAM4M,OAAS,OAC/BrM,KAAKsM,YAAc,SAKvBxM,EAAWvB,UAAUgO,SAAW,SAAS/D,GACvC,IAAIgE,EAAUhE,EAAQ,GAClBiE,EAAWzM,KAAKwB,YAAY,GAC5BkL,EAAmB1M,KAAK2M,kBAAkBC,cAC1CC,EAAUL,EAAQ/D,QAAUgE,EAAShE,QACrCqE,EAAe,CACjBrE,QAAS+D,EAAQ/D,QACjBC,QAAS8D,EAAQ9D,SAEnB,MACwC,GAArCgE,EAAiBK,QAAQ,UACc,GAAtCL,EAAiBK,QAAQ,WACU,GAApCL,EAAiBK,QAAQ,SACe,GAAvCL,EAAiBK,QAAQ,WAC3B,CACA,IAAIC,EAAM,EAERA,EADE,CAAC,eAAgB,oBAAoBvK,SAASiK,GAC1C,GAEC,EAET,IAAIO,EACDJ,EAAU7M,KAAKiI,aAAa1H,OAAUP,KAAKiI,aAAa5H,MAC3DyM,EAAapE,QAAU+D,EAAS/D,QAAUuE,EAAeD,GAGlB,GAArCN,EAAiBK,QAAQ,UAC3B/M,KAAKgI,SAASR,KACZxH,KAAKiI,aAAaT,MAAQsF,EAAarE,QAAUgE,EAAShE,SAC5DzI,KAAKgI,SAAS3H,MACZL,KAAKiI,aAAa5H,OAASyM,EAAarE,QAAUgE,EAAShE,WAErB,GAAtCiE,EAAiBK,QAAQ,WAC3B/M,KAAKgI,SAAS3H,MACZL,KAAKiI,aAAa5H,OAASyM,EAAarE,QAAUgE,EAAShE,WAEvB,GAApCiE,EAAiBK,QAAQ,SAC3B/M,KAAKgI,SAAST,IACZvH,KAAKiI,aAAaV,KAAOuF,EAAapE,QAAU+D,EAAS/D,SAC3D1I,KAAKgI,SAASzH,OACZP,KAAKiI,aAAa1H,QAAUuM,EAAapE,QAAU+D,EAAS/D,WAErB,GAAvCgE,EAAiBK,QAAQ,YAC3B/M,KAAKgI,SAASzH,OACZP,KAAKiI,aAAa1H,QAAUuM,EAAapE,QAAU+D,EAAS/D,UAG5D1I,KAAKgI,SAAS3H,OAASL,KAAK4D,gBAC9B5D,KAAKgI,SAAS3H,MAAQL,KAAK4D,eAEzB5D,KAAKgI,SAASzH,QAAUP,KAAK4D,gBAC/B5D,KAAKgI,SAASzH,OAASP,KAAK4D,eAG9B5D,KAAKgE,WAAWhE,KAAKkE,YACrBlE,KAAK+D,UAAU/D,KAAKkE,aAItBpE,EAAWvB,UAAUgE,UAAY,WAC/B,IAAI3B,EAAOZ,KACPkN,EAAgBlN,KAAK2I,mBAIzB/H,EAAK2F,YAAYxF,iBAAiBmM,EAActE,OAAO,SAASL,GAC9D,IAAIC,EAAU5H,EAAK0H,iBAAiBC,GACpC3H,EAAKoG,aAAawB,MAEpB5H,EAAK2F,YAAYxF,iBAAiBmM,EAAcrE,MAAM,SAASN,GAC7D,IAAIC,EAAU5H,EAAK0H,iBAAiBC,GACpC,GACE3H,EAAKY,aACLZ,EAAKY,YAAYqB,OAAS,IACzBjC,EAAKO,YACN,CACA,IACIgM,EADQ3E,EAAQ,GACFC,QAAU7H,EAAKY,YAAY,GAAGiH,QAE5C2E,EADYxM,EAAKU,UACM6L,EAC3B,GACEC,GAAY,GACZA,GAAYxM,EAAKgG,YAAchG,EAAK0F,eACpC,CAEA,IAAIS,GACAqG,EAAWxM,EAAKS,YAAcT,EAAK0F,gBACpC1F,EAAKqF,SAAWrF,EAAKoF,WAAapF,EAAKsF,UAC1CtF,EAAKU,UAAY8L,EACjBxM,EAAKW,UAAY4L,EACjBvM,EAAK4F,WAAW/G,MAAME,GACpB,cAAgByN,EAAW,MAC7B,IAAIC,EAAYzM,EAAK0M,mBACnB1M,EAAKc,WAAaqF,EAAQnG,EAAKgB,YAC/BhB,EAAKwH,YAEPxH,EAAK8J,kBAAoB2C,EAAUE,WACnC3M,EAAK+J,kBAAoB0C,EAAUG,WACnC5M,EAAKgB,YAAchB,EAAKc,WAAaqF,EACrCnG,EAAKqG,WAAU,GACfrG,EAAKY,YAAcgH,GAGvBD,EAAEkF,kBACFlF,EAAEmF,oBAEJ9M,EAAK2F,YAAYxF,iBACfmM,EAAcpE,IACdlI,EAAKsG,WAAW/I,KAAKyC,IAEvBA,EAAK2F,YAAYxF,iBACfmM,EAAcnE,OACdnI,EAAKsG,WAAW/I,KAAKyC,IAMvB,IAAI+M,EAAoB/M,EAAKK,eACzBL,EAAKF,WACLE,EAAKuG,UACTwG,EAAkB5M,iBAAiBmM,EAActE,OAAO,SAASgF,GAC/D,IAAIpF,EAAU5H,EAAK0H,iBAAiBsF,GAIpC,GAHAhN,EAAKoG,aAAawB,GAClB5H,EAAKO,aAAc,EACnBP,EAAKqL,WAAWzD,GACZ5H,EAAKY,aAAeZ,EAAKY,YAAYqB,QAAU,EAAG,CACpDjC,EAAKO,aAAc,EACnB,IAAI0M,EAAS,CACXpF,SACG7H,EAAKY,YAAY,GAAGiH,QAAU7H,EAAKY,YAAY,GAAGiH,SAAW,EAChEC,SACG9H,EAAKY,YAAY,GAAGkH,QAAU9H,EAAKY,YAAY,GAAGkH,SAAW,GAElE9H,EAAKkN,UAAY7K,KAAK8K,KACpB9K,KAAK+K,IACHpN,EAAKY,YAAY,GAAGiH,QAAU7H,EAAKY,YAAY,GAAGiH,QAClD,GAEAxF,KAAK+K,IACHpN,EAAKY,YAAY,GAAGkH,QAAU9H,EAAKY,YAAY,GAAGkH,QAClD,IAGN9H,EAAKqN,YAAc,EACnBrN,EAAKsN,aAAe,CAElBpL,EAAG+K,EAAOpF,QAAU7H,EAAK0G,aAAajH,MAAQ,EAC9C0C,EAAGnC,EAAK0G,aAAa/G,OAAS,EAAIsN,EAAOnF,cAElC9H,EAAK0L,cAAqD,GAAtC1L,EAAK0L,YAAYS,QAAQ,WACtDnM,EAAK+L,kBAAoB/L,EAAK0L,gBAGlC,IAAIxL,IAAUF,EAAKC,kBACf,CAEEsN,SAAS,EACTC,SAAS,GAGfT,EAAkB5M,iBAChBmM,EAAcrE,MACd,SAAS+E,GACP,IAAIpF,EAAU5H,EAAK0H,iBAAiBsF,GACpC,GAAIhN,EAAKY,aAAeZ,EAAKY,YAAYqB,OAAS,EAChD,GAAKjC,EAAKO,YAMH,CAEL,IAIIkN,EAJepL,KAAK8K,KACtB9K,KAAK+K,IAAIxF,EAAQ,GAAGC,QAAUD,EAAQ,GAAGC,QAAS,GAChDxF,KAAK+K,IAAIxF,EAAQ,GAAGE,QAAUF,EAAQ,GAAGE,QAAS,IAExB9H,EAAKkN,UACnClN,EAAKe,WAAcf,EAAKe,WAAaf,EAAKqN,YAAeI,EACzD,IAAIhB,EAAYzM,EAAK0N,kBACnBD,EAAWzN,EAAKqN,YAChBrN,EAAKsN,cAEPtN,EAAK8J,kBAAoB2C,EAAUE,WACnC3M,EAAK+J,kBAAoB0C,EAAUG,WACnC5M,EAAKqN,YAAcI,EACnBzN,EAAKqG,WAAU,GAAO,QApBjBrG,EAAK+L,kBAGR/L,EAAK2L,SAAS/D,GAFd5H,EAAK2N,YAAY/F,QAsBrB5H,EAAKqL,WAAWzD,GAEd5H,EAAKJ,SAEPoN,EAAGF,mBAGP5M,GAEF6M,EAAkB5M,iBAChBmM,EAAcpE,IACdlI,EAAKsG,WAAW/I,KAAKyC,IAEvB+M,EAAkB5M,iBAChBmM,EAAcnE,OACdnI,EAAKsG,WAAW/I,KAAKyC,IAMvB+M,EAAkB5M,iBAAiB,SAAS,SAASwH,GAC9C3H,EAAK4N,eACR5N,EAAKoG,eAEPuB,EAAEmF,iBACEnF,EAAEkG,WAAa,EACjB7N,EAAKe,WAAaf,EAAKe,YAAc4G,EAAEkG,WAAa,KAAQ,GAE5D7N,EAAKe,WAAaf,EAAKe,YAAc,EAAI4G,EAAEkG,WAAa,MAE1D7N,EAAKqG,WAAU,GAAO,GAClBrG,EAAK4N,eACPE,aAAa9N,EAAK4N,eAEpB5N,EAAK4N,cAAgBG,YAAW,WAC9B/N,EAAKsG,aACLtG,EAAK4N,cAAgB,OACpB,SAMP1O,EAAWvB,UAAU+P,kBAAoB,SAASM,EAAOC,GAGvD,IAFA,IAAIC,EAAe,GACfjB,EAAS7N,KAAKqI,gBAAgBrI,KAAKuK,eAC9B5N,EAAI,EAAGA,EAAIqD,KAAKuK,cAAc1H,OAAQlG,IAAK,CAClD,IAAIuP,EAAQlM,KAAKuK,cAAc5N,GAC/BmS,EAAaC,KAAK,CAChBjM,EAAGoJ,EAAMpJ,EAAI8L,EAAQC,EAAY/L,GAAK8L,EAAQ,GAC9C7L,EAAGmJ,EAAMnJ,EAAI6L,EAAQC,EAAY9L,GAAK6L,EAAQ,KAGlD,IAAII,EAAYhP,KAAKqI,gBAAgByG,GACrC,MAAO,CACLvB,WAAYM,EAAO/K,EAAIkM,EAAUlM,EACjC0K,WAAYK,EAAO9K,EAAIiM,EAAUjM,IAKrCjD,EAAWvB,UAAU+O,mBAAqB,SAASvG,EAAOkI,GACxD,IAAIpB,EAAS7N,KAAKqI,gBAAgBrI,KAAKuK,eACnC2E,EAAM,CACRpM,GAAI+K,EAAO/K,EAAImM,EAAanM,GAAGqM,QAAQnP,KAAKkB,YAC5C6B,GAAI8K,EAAO9K,EAAIkM,EAAalM,GAAGoM,QAAQnP,KAAKkB,aAG9C,GADWlB,KAAKoP,OAAOF,GACZ,GAAc,GAATnI,EAAY,CAC1B,IAAIsI,EAAOtI,EAAQ,IAAO9D,KAAKqM,GAC3BC,EAAS,CACXzM,EAAGG,KAAKuM,KAAKH,GAAOH,EAAIpM,EAAIG,KAAKwM,KAAKJ,GAAOH,EAAInM,EACjDA,EAAGE,KAAKwM,KAAKJ,GAAOH,EAAIpM,EAAIG,KAAKuM,KAAKH,GAAOH,EAAInM,GAEnD,MAAO,CACLwK,WAAY2B,EAAIpM,EAAIyM,EAAOzM,EAC3B0K,WAAY0B,EAAInM,EAAIwM,EAAOxM,GAG7B,MAAO,CACLwK,WAAY,EACZC,WAAY,IAMlB1N,EAAWvB,UAAU2M,kBAAoB,WACvClL,KAAKoK,aAAepK,KAAK6K,YAAYxK,MACrCL,KAAKqK,cAAgBrK,KAAK6K,YAAYtK,OAElCP,KAAKgL,aAAe,IACtBhL,KAAKoK,aAAepK,KAAK6K,YAAYtK,OACrCP,KAAKqK,cAAgBrK,KAAK6K,YAAYxK,QAK1CP,EAAWvB,UAAU4M,qBAAuB,WACtCnL,KAAK0P,cACP1P,KAAKmH,UAAUwI,YAAY3P,KAAK0P,cAGlC1P,KAAK0P,aAAe1Q,SAASC,cAAc,UAC3Ce,KAAK0P,aAAarP,MAAQL,KAAKoK,aAC/BpK,KAAK0P,aAAanP,OAASP,KAAKqK,cAChC,IAAIuF,EAAW5P,KAAK0P,aAAahI,WAAW,MAExCrH,EAAQL,KAAK6K,YAAYxK,MACzBE,EAASP,KAAK6K,YAAYtK,OAE9B,OAAQP,KAAKgL,cACX,KAAK,EAEH4E,EAASvC,UAAUhN,EAAO,GAC1BuP,EAAShB,OAAO,EAAG,GACnB,MACF,KAAK,EAEHgB,EAASvC,UAAUhN,EAAOE,GAC1BqP,EAASC,OAAO5M,KAAKqM,IACrB,MACF,KAAK,EAEHM,EAASvC,UAAU,EAAG9M,GACtBqP,EAAShB,MAAM,GAAI,GACnB,MACF,KAAK,EAEHgB,EAASC,OAAO,GAAM5M,KAAKqM,IAC3BM,EAAShB,MAAM,GAAI,GACnB,MACF,KAAK,EAEHgB,EAASC,OAAO,GAAM5M,KAAKqM,IAC3BM,EAASvC,UAAU,GAAI9M,GACvB,MACF,KAAK,EAEHqP,EAASC,OAAO,GAAM5M,KAAKqM,IAC3BM,EAASvC,UAAUhN,GAAQE,GAC3BqP,EAAShB,OAAO,EAAG,GACnB,MACF,KAAK,EAEHgB,EAASC,QAAQ,GAAM5M,KAAKqM,IAC5BM,EAASvC,WAAWhN,EAAO,GAG/BuP,EAAS1F,UAAUlK,KAAK6K,YAAa,EAAG,EAAGxK,EAAOE,GAGlDP,KAAK8P,eAAiB,2BACtB9P,KAAK0P,aAAazG,UAAUC,IAAI,gBAChClJ,KAAK0P,aAAajQ,MAAMsQ,SAAW,WACnC/P,KAAK0P,aAAajQ,MAAM+H,KAAO,MAC/BxH,KAAK0P,aAAajQ,MAAM8H,IAAM,MAC9BvH,KAAK0P,aAAajQ,MAAME,GAAqBK,KAAK8P,eAClD9P,KAAKmH,UAAU6I,aAAahQ,KAAK0P,aAAc1P,KAAKkE,aAItDpE,EAAWvB,UAAUqN,aAAe,WAClC,IAAIqE,EAAYjQ,KAAK2B,WAAa3B,KAAK+H,MAAS/H,KAAKoB,aACjDgJ,EAAepK,KAAKoK,aACpBC,EAAgBrK,KAAKqK,cACrB6F,EAAYlQ,KAAKM,KAAKD,MACtB8P,EAAanQ,KAAKM,KAAKC,OAGvB6P,EAAQ,GACRhG,EAAe8F,GAAa7F,EAAgB8F,KAE1CD,EAAY9F,EAAe+F,EAAa9F,GAE1CA,GADA+F,EAAQF,EAAY9F,EAEpBA,EAAe8F,IAGf9F,GADAgG,EAAQD,EAAa9F,EAErBA,EAAgB8F,IAGpB,IAAItC,EAAS,CACX/K,EAAGsH,EAAe,EAClBrH,EAAGsH,EAAgB,GAGjBgG,EAAiBrR,SAASC,cAAc,UAC5CoR,EAAehQ,MAAQ+J,EACvBiG,EAAe9P,OAAS8J,EACxB,IAAIiG,EAAaD,EAAe3I,WAAW,MAC3C4I,EAAWjD,UAAUQ,EAAO/K,EAAG+K,EAAO9K,GACtCuN,EAAW1B,MACRqB,EAAWjQ,KAAK+H,MAASqI,EACzBH,EAAWjQ,KAAK+H,MAASqI,GAE5BE,EAAWjD,WACPrN,KAAK0K,iBAAmB1K,KAAK4H,eAAeJ,MAAQyI,EAAYG,GAChEpQ,KAAK2K,iBAAmB3K,KAAK4H,eAAeL,KAAO0I,EAAYG,GAEnEE,EAAWT,OAAQ7P,KAAK4B,YAAc,IAAOqB,KAAKqM,IAClDgB,EAAWjD,WAAWQ,EAAO/K,GAAI+K,EAAO9K,GACxCuN,EAAWpG,UAAUlK,KAAK0P,aAAc,EAAG,EAAGtF,EAAcC,GAE5D,IAAIkG,EAAcvR,SAASC,cAAc,UACzCsR,EAAYlQ,MAAQ6P,EACpBK,EAAYhQ,OAAS4P,EACPI,EAAY7I,WAAW,MAC7BwC,UACNmG,GACCjG,EAAe8F,GAAa,GAC5B7F,EAAgB8F,GAAc,EAC/BD,EACAC,EACA,EACA,EACAD,EACAC,GAEFnQ,KAAK6L,cAAgB0E,GAIvBzQ,EAAWvB,UAAU2I,WAAa,WAChC,GAAIlH,KAAKyB,WAAY,CACnB,IAAIb,EAAOZ,KAIX,GAHAA,KAAKwB,YAAc,GAGfxB,KAAK2M,kBAAmB,CAC1B,MAAM6D,EAAU,CACdnQ,MACGL,KAAKgI,SAAS3H,MAAQL,KAAKiI,aAAa5H,MAASL,KAAKM,KAAKD,MAC9DE,OACGP,KAAKgI,SAASzH,OAASP,KAAKiI,aAAa1H,OAC1CP,KAAKM,KAAKC,QAERkQ,EACJD,EAAQnQ,MAAQL,KAAKsH,aAAajH,MAClCmQ,EAAQjQ,OAASP,KAAKsH,aAAa/G,OAC/BiQ,EAAQnQ,MAAQL,KAAKsH,aAAajH,MAAQL,KAAK6H,gBAC/C2I,EAAQjQ,OAASP,KAAKsH,aAAa/G,OAASP,KAAK6H,gBAMvD,IAHA,IAAI6I,EAAgB1Q,KAAKmI,aAAanI,KAAKgI,UACvC2I,EAAgB3Q,KAAKqI,gBAAgBqI,GACrCE,EAAQ,GACHjU,EAAI,EAAGA,EAAI+T,EAAc7N,OAAQlG,IACxCiU,EAAM7B,KACJ/O,KAAKoP,OAAO,CACVtM,EAAG4N,EAAc/T,GAAGmG,EAAI9C,KAAKkI,WAAWvL,GAAGmG,EAC3CC,EAAG2N,EAAc/T,GAAGoG,EAAI/C,KAAKkI,WAAWvL,GAAGoG,KAMjD,IAFA,IAAI8N,EAAY,CAAC,GACbC,EAASF,EAAM,GACVG,EAAI,EAAGA,EAAIH,EAAM/N,OAAQkO,IAC5BH,EAAMG,GAAKD,GACbA,EAASF,EAAMG,GACfF,EAAY,CAACE,IACJH,EAAMG,IAAMD,GACrBD,EAAU9B,KAAKgC,GAKnB,IAAIC,EAAkB,CACpBlO,EAAG9C,KAAKkI,WAAW2I,EAAU,IAAI/N,EACjCC,EAAG/C,KAAKkI,WAAW2I,EAAU,IAAI9N,GAEX,GAApB8N,EAAUhO,SACZmO,EAAgBlO,GACb9C,KAAKkI,WAAW2I,EAAU,IAAI/N,EAC7B9C,KAAKkI,WAAW2I,EAAU,IAAI/N,GAChC,EACFkO,EAAgBjO,GACb/C,KAAKkI,WAAW2I,EAAU,IAAI9N,EAC7B/C,KAAKkI,WAAW2I,EAAU,IAAI9N,GAChC,GAIJ,IAAI2J,EAAmB1M,KAAK2M,kBAAkBC,cAC9C5M,KAAK2M,kBAAoB,KACzB,IAAIsE,GACmC,GAArCvE,EAAiBK,QAAQ,UACa,GAAtCL,EAAiBK,QAAQ,SACvBmE,GACkC,GAApCxE,EAAiBK,QAAQ,SACc,GAAvCL,EAAiBK,QAAQ,UAGvBoE,EAAYF,EACZjR,KAAKiI,aAAa5H,MAAQL,KAAKgI,SAAS3H,MACxCL,KAAKiI,aAAa1H,OAASP,KAAKgI,SAASzH,OACzC8M,EAAYzM,EAAK0N,kBAAkB6C,EAAW,CAChDrO,EAAGkO,EAAgBlO,EACnBC,EAAGiO,EAAgBjO,IAIjBkO,GAAcC,GAChBlR,KAAK0K,kBAAoB2C,EAAUE,WACnCvN,KAAK2K,kBAAoB0C,EAAUG,YAC1ByD,EAIF,GAFLhO,KAAKE,IAAInD,KAAK+H,MAAQ0I,EAAWU,GAAWhC,QAC1CnP,KAAKkB,YAGPlB,KAAK0K,kBACD2C,EAAUE,WAAa4D,EAAanR,KAAK+H,MAAS0I,GAEtDzQ,KAAK0K,kBAAoBiG,EAAc7N,EAAI9C,KAAK4H,eAAeJ,KAC/DxH,KAAK0K,kBAAoB1K,KAAK+H,MAAQ0I,GAE/BS,IAIF,GAFLjO,KAAKE,IAAInD,KAAK+H,MAAQ0I,EAAWU,GAAWhC,QAC1CnP,KAAKkB,YAGPlB,KAAK2K,kBACD0C,EAAUG,WAAa2D,EAAanR,KAAK+H,MAAS0I,GAEtDzQ,KAAK2K,kBAAoBgG,EAAc5N,EAAI/C,KAAK4H,eAAeL,IAC/DvH,KAAK2K,kBAAoB3K,KAAK+H,MAAQ0I,IAK1CzQ,KAAK8H,UAAU,CACbF,eAAgB5H,KAAK4H,eACrBC,gBAAiB7H,KAAK6H,gBACtBvH,KAAM,CACJD,MAAOmQ,EAAQnQ,MACfE,OAAQiQ,EAAQjQ,UAKtB,GACEP,KAAK0P,eACJ1P,KAAKoR,aAAapR,KAAKuK,cAAevK,KAAKkI,YAC5C,CAEA,IAAI+H,EAAYjQ,KAAK2B,WAAa3B,KAAK+H,MAAS/H,KAAKoB,aACjD6F,EAAY,GAChBA,GAAa,UAAYgJ,EAAW,IACpChJ,GACE,eACAjH,KAAK0K,iBAAmBuF,EACxB,kBACAjQ,KAAK2K,iBAAmBsF,EACxB,MACFhJ,GAAa,WAAajH,KAAK4B,YAAc,QAG7C,IAAIyP,EAAUrR,KAAKsR,kBAAkBrK,GACjCsK,EAAWvR,KAAKwR,mBAAmBH,GAQvC,GAPArR,KAAK0K,iBAAmB6G,EAAShJ,EACjCvI,KAAK2K,iBAAmB4G,EAASE,EACjCzR,KAAKuK,cAAgBvK,KAAK0R,mBACxB,aAAeL,EACfrR,KAAKsK,mBAGFtK,KAAKS,MAGH,CACLT,KAAK0P,aAAajQ,MAAMI,GAAsB,uBAC9C,IAAI+I,EAAQyI,EAAQtE,QAAQ9F,GAAaA,EAAUpE,OAC/C8O,EAAYN,EACbO,UAAUhJ,EAAOyI,EAAQxO,QACzBgP,OACAC,MAAM,KACLC,EAAK,EACLC,EAAKhS,KAAK8P,eAAiB7I,EAAY0K,EAAUI,GACrD/R,KAAK0P,aAAajQ,MAAME,GAAqBqS,EAC7ChS,KAAK0P,aAAa3O,iBAAiBjC,GAAoB,aACrDiT,EACSV,EAAQxO,SACfmP,GAAML,EAAUI,GAChBnR,EAAK8O,aAAajQ,MAAME,GAAqBqS,WAhBjDhS,KAAK0P,aAAajQ,MAAME,GACtBK,KAAK8P,eAAiBuB,EAqB5BrR,KAAKyB,YAAa,IAKtB3B,EAAWvB,UAAUyI,aAAe,SAASwB,GAC3CA,EAAUA,GAAoB,GACzBxI,KAAKyB,aAAczB,KAAKiS,iBAAiBzJ,KAC5CxI,KAAKyB,YAAa,EACdzB,KAAK0P,eACP1P,KAAK0P,aAAajQ,MAAMI,GAAsB,QAEhDG,KAAKwB,YAAcgH,IAKvB1I,EAAWvB,UAAU0T,iBAAmB,SAASzJ,GAI/C,SACExI,KAAKyB,YACLzB,KAAKwB,aACsB,GAA3BxB,KAAKwB,YAAYqB,QACjB2F,EAAQ3F,QAAU,IAChB2F,EAAQ,GAAGC,SAAWzI,KAAKwB,YAAY,GAAGiH,SAC1CD,EAAQ,GAAGE,SAAW1I,KAAKwB,YAAY,GAAGkH,SACzCF,EAAQ,GAAGC,SAAWzI,KAAKwB,YAAY,GAAGiH,SACzCD,EAAQ,GAAGE,SAAW1I,KAAKwB,YAAY,GAAGkH,WAQlD5I,EAAWvB,UAAUgQ,YAAc,SAAS/F,GAC1C,IAAI0D,EAAQ1D,EAAQ,GAChB2E,EAAQjB,EAAMzD,QAAUzI,KAAKwB,YAAY,GAAGiH,QAC5CyJ,EAAQhG,EAAMxD,QAAU1I,KAAKwB,YAAY,GAAGkH,QAEhD1I,KAAK0K,kBAAoByC,EACzBnN,KAAK2K,kBAAoBuH,EACzBlS,KAAKwB,YAAcgH,EAEnBxI,KAAKiH,aAIPnH,EAAWvB,UAAU0I,UAAY,SAASkL,EAAaC,GACrD,GAAIpS,KAAK0P,aAAc,CACrB,IAAIO,EAAYjQ,KAAK2B,WAAa3B,KAAK+H,MAAS/H,KAAKoB,aACjD6F,EAAY,GAUhB,GATAA,GAAa,UAAYgJ,EAAW,IACpChJ,GACE,eACAjH,KAAK0K,iBAAmBuF,EACxB,kBACAjQ,KAAK2K,iBAAmBsF,EACxB,MACFhJ,GAAa,WAAajH,KAAK4B,YAAc,OAEzCwQ,EAAgB,CAElBnL,EAAYjH,KAAKsR,kBAAkBrK,GAAW,GAC9C,IAAIoL,EAAQrS,KAAKwR,mBAAmBvK,GACpCjH,KAAK0K,iBAAmB2H,EAAM9J,EAC9BvI,KAAK2K,iBAAmB0H,EAAMZ,EAGhC,GAAIU,EAAa,CAEf,IAAIG,EAAetS,KAAK0R,mBACtB,aAAezK,EACfjH,KAAKsK,mBAEHiI,EAAavS,KAAKwS,kBAAkBF,EAActS,KAAKkI,YACvDuK,EAAWzS,KAAKuB,UAEhBmR,EADW1S,KAAKsB,UACQmR,EAAWzS,KAAKqB,WACxC4N,EAAejP,KAAKqI,gBAAgBiK,GACpCK,EAAY,CACd7P,EAAGmM,EAAanM,EAAI9C,KAAKoI,WAAWtF,EACpCC,EAAGkM,EAAalM,EAAI/C,KAAKoI,WAAWrF,GAElC6P,EAAU3P,KAAKE,IAAIsP,GAAYxP,KAAKE,IAAIuP,GACxCH,EAAa,GACfvS,KAAKoB,aAAepB,KAAKoB,aAAemR,EACxCtC,GAAsBsC,GACbvS,KAAKoP,OAAOuD,GAAa,GAAKC,EAAU,IAE7CL,EAAa,EAAIK,IAEnBL,EAAa,EAAIK,GAEf5S,KAAKoB,aAAemR,EAAa,EACnCvS,KAAKoB,aAAepB,KAAKoB,aAAemR,GAGxCvS,KAAKoB,aAAe,EACpBmR,EAAa,GAEftC,GAAsBsC,GAK1BtL,EAAY,GACZA,GAAa,UAAYgJ,EAAW,IACpChJ,GACE,eACAjH,KAAK0K,iBAAmBuF,EACxB,kBACAjQ,KAAK2K,iBAAmBsF,EACxB,MACFhJ,GAAa,WAAajH,KAAK4B,YAAc,OAC7C5B,KAAK0P,aAAajQ,MAAME,GACtBK,KAAK8P,eAAiB7I,EACxBjH,KAAKuK,cAAgBvK,KAAK0R,mBACxB,aAAezK,EACfjH,KAAKsK,qBAMXxK,EAAWvB,UAAUiU,kBAAoB,SAASK,EAAOC,GAEvD,IADA,IAAIlE,EAAQ,EACHjS,EAAI,EAAGA,EAAImW,EAAMjQ,OAAQlG,IAAK,CACrC,IAAIoW,EAAM/S,KAAKgT,mBAAmBF,EAAMnW,GAAIkW,GACxCE,EAAMnE,IACRA,EAAQmE,GAGZ,OAAOnE,GAIT9O,EAAWvB,UAAU6S,aAAe,SAAS6B,EAAOC,GAClD,IAAK,IAAIvW,EAAI,EAAGA,EAAIuW,EAAMrQ,OAAQlG,IAChC,IAAKqD,KAAKmT,wBAAwBD,EAAMvW,GAAIsW,GAC1C,OAAO,EAGX,OAAO,GAITnT,EAAWvB,UAAUyU,mBAAqB,SAAS9G,EAAOkH,GACxD,IAAIC,EAAMrT,KAAKsT,4BAA4BpH,EAAOkH,GAG9CG,EAAOvT,KAAKoP,OAAOiE,EAAIG,OACvBjT,EAASP,KAAKoP,OAAOiE,EAAII,IAAM,EAC/BC,EAAO1T,KAAKoP,OAAOiE,EAAIM,OACvBtT,EAAQL,KAAKoP,OAAOiE,EAAIO,OAAS,EAGrC,OAAIL,EAAOhT,EAASmT,EAAOrT,EAClB,GAAKkT,EAAOhT,GAAUA,EAEtB,GAAKmT,EAAOrT,GAASA,GAKhCP,EAAWvB,UAAU+S,kBAAoB,SAASrK,EAAW4M,GAC3D,IAAIC,EAAQ9T,KAAK+T,YAAY/T,KAAKkI,WAAYlI,KAAK4B,aACnDiS,EAAgBA,IAAgC,EAGhD,IAAIG,EAAS,EACTC,EAAS,EACTC,EAAM,CACRpR,EAAG9C,KAAKuK,cAAc,GAAGzH,EAAI9C,KAAKuK,cAAc,GAAGzH,EACnDC,EAAG/C,KAAKuK,cAAc,GAAGxH,EAAI/C,KAAKuK,cAAc,GAAGxH,GAEjDoR,EAAS,CACXrR,EAAG9C,KAAKuK,cAAc,GAAGzH,EAAI9C,KAAKuK,cAAc,GAAGzH,EACnDC,EAAG/C,KAAKuK,cAAc,GAAGxH,EAAI/C,KAAKuK,cAAc,GAAGxH,GAEjDqR,EAAM,CACRtR,EAAGgR,EAAM,GAAGhR,EAAIgR,EAAM,GAAGhR,EACzBC,EAAG+Q,EAAM,GAAG/Q,EAAI+Q,EAAM,GAAG/Q,GAEvBsR,EAAS,CACXvR,EAAGgR,EAAM,GAAGhR,EAAIgR,EAAM,GAAGhR,EACzBC,EAAG+Q,EAAM,GAAG/Q,EAAI+Q,EAAM,GAAG/Q,GAEvBuR,EAAOtU,KAAKuU,SAASL,EAAKE,GAE5BnR,KAAKE,IAAI,IAAMmR,GAAQrR,KAAKE,IAAI,GAAKmR,IACrCrR,KAAKE,IAAI,EAAImR,GAAQrR,KAAKE,IAAI,GAAKmR,IAGnCN,EAAShU,KAAKoP,OAAOgF,GAAOpU,KAAKoP,OAAO8E,GACxCD,EAASjU,KAAKoP,OAAOiF,GAAUrU,KAAKoP,OAAO+E,KAE3CH,EAAShU,KAAKoP,OAAOgF,GAAOpU,KAAKoP,OAAO+E,GACxCF,EAASjU,KAAKoP,OAAOiF,GAAUrU,KAAKoP,OAAO8E,IAK7C,IAAItF,GAHJoF,EAASA,EAAS,EAAI,EAAIA,IAC1BC,EAASA,EAAS,EAAI,EAAIA,GAEID,EAASC,EAEvC,GAAIJ,GAAiBjF,EAAQ,EAC3B,OAAO3H,EAKT,IADA,IAAIuN,EAAc,GACT7X,EAAI,EAAGA,EAAIqD,KAAKuK,cAAc1H,OAAQlG,IAC7C6X,EAAYzF,KAAK,CACfjM,EAAG9C,KAAKuK,cAAc5N,GAAGmG,EACzBC,EAAG/C,KAAKuK,cAAc5N,GAAGoG,IAKzB6L,EAAQ,IACV3H,GAAa,UAAY2H,EAAQ,IACjC5O,KAAK2B,WAAa3B,KAAK2B,WAAaiN,EAEpC4F,EAAcxU,KAAK0R,mBACjB,aAAezK,EACfjH,KAAKsK,oBAKT,IAAI2F,EAAYjQ,KAAK2B,WAAa3B,KAAK+H,MAAS/H,KAAKoB,aACjDqT,EAAQ,EACR7T,EAAOZ,KACP0U,EAAa,GACjB,GAGE,IADAA,EAAa1U,KAAK2U,cAAc3U,KAAKkI,WAAYsM,IAClC3R,OAAS,EAAG,CACzB4R,IACAC,EAAWE,MAAK,SAASC,EAAGC,GAE1B,IAAIC,EAAOnU,EAAKwO,OAAOyF,EAAEG,IACrBC,EAAOrU,EAAKwO,OAAO0F,EAAEE,IACzB,OAAID,EAAOE,EACF,EAELF,EAAOE,GACD,EAEH,KAIT,IAAIC,EAAYR,EAAW,GACvBS,EAAYD,EAAU7B,IAG1BiB,EAAOtU,KAAKuU,SAASY,EAAU1B,GAAI0B,EAAU3B,OAC7C,IAAID,EAAOvT,KAAKoP,OAAO+F,EAAU3B,OAC7BtB,EAAQ,EASC,IAJXA,EAFEjP,KAAKE,IAAImR,GAAQ,IAEVf,EAAO2B,EAAUE,MAElB7B,EAAO2B,EAAUE,SAGzBnO,GAAa,eAAiBiL,EAAQjC,EAAW,OAInD,IAAIoF,EAAOrV,KAAKuU,SAASY,EAAUvB,MAAOuB,EAAUxB,OAChDD,EAAO1T,KAAKoP,OAAO+F,EAAUxB,OAC7BxG,EAAQ,EAaZ,GALa,IAJXA,EAFElK,KAAKE,IAAIkS,GAAQ,GAEX3B,EAAOwB,EAAUI,OAEhB5B,EAAOwB,EAAUI,SAG1BrO,GAAa,eAAiBkG,EAAQ8C,EAAW,OAItC,GAAT9C,GAAuB,GAAT+E,EAChB,IAAKvV,EAAI,EAAGA,EAAI6X,EAAY3R,OAAQlG,IACjC6X,EAAY7X,GAAGmG,EAAI0R,EAAY7X,GAAGmG,EAAIoS,EAAUF,GAAGlS,EACjD0R,EAAY7X,GAAGoG,EAAIyR,EAAY7X,GAAGoG,EAAImS,EAAUF,GAAGjS,SAIrD0R,EAAQ,GAAKC,EAAW7R,OAAS,GAE1C,OAAOoE,GAITnH,EAAWvB,UAAUoW,cAAgB,SAAS7B,EAAOD,GAEnD,IADA,IAAI6B,EAAa,GACR/X,EAAI,EAAGA,EAAImW,EAAMjQ,OAAQlG,IAAK,CACrC,IAAI4Y,EAAKzC,EAAMnW,GACf,IAAKqD,KAAKmT,wBAAwBoC,EAAI1C,GAAQ,CAC5C,IAAIQ,EAAMrT,KAAKsT,4BAA4BiC,EAAI1C,GAC3CmC,EAAK,CACPlS,EAAG,EACHC,EAAG,GAEDwQ,EAAOvT,KAAKoP,OAAOiE,EAAIG,OACvBjT,EAASP,KAAKoP,OAAOiE,EAAII,IAAM,EAC/BC,EAAO1T,KAAKoP,OAAOiE,EAAIM,OACvBtT,EAAQL,KAAKoP,OAAOiE,EAAIO,OAAS,EACjCwB,EAAQ,EACRE,EAAQ,EACR/B,EAAOhT,IACT6U,GAAS7B,EAAOhT,GAAUgT,EAC1ByB,EAAGlS,GAAKuQ,EAAIG,MAAM1Q,EAAIsS,EACtBJ,EAAGjS,GAAKsQ,EAAIG,MAAMzQ,EAAIqS,GAEpB1B,EAAOrT,IACTiV,GAAS5B,EAAOrT,GAASqT,EACzBsB,EAAGlS,GAAKuQ,EAAIM,MAAM7Q,EAAIwS,EACtBN,EAAGjS,GAAKsQ,EAAIM,MAAM5Q,EAAIuS,GAExBZ,EAAW3F,KAAK,CACdjM,EAAGyS,EAAGzS,EACNC,EAAGwS,EAAGxS,EACNiS,GAAIA,EACJI,MAAOA,EACPE,MAAOA,EACPjC,IAAKA,KAIX,OAAOqB,GAIT5U,EAAWvB,UAAUwV,YAAc,SAASyB,EAAMzO,GAC5CA,EAAQ,EACVA,EAAQ,GAAMA,EAAQ,GAEtBA,GAAgB,GAElB,IAAIsI,EAAOtI,EAAQ,IAAO9D,KAAKqM,GAE3BmE,EAAK,CACP3Q,EAAG0S,EAAK,GAAG1S,EAAI0S,EAAK,GAAG1S,EACvBC,EAAGyS,EAAK,GAAGzS,EAAIyS,EAAK,GAAGzS,GAErB6Q,EAAQ,CACV9Q,EAAG0S,EAAK,GAAG1S,EAAI0S,EAAK,GAAG1S,EACvBC,EAAGyS,EAAK,GAAGzS,EAAIyS,EAAK,GAAGzS,GAErB2Q,EAAO1T,KAAKoP,OAAOwE,GACnBL,EAAOvT,KAAKoP,OAAOqE,GAEnBgC,EAAQ,GAiBZ,OAhBAA,EAAM,GAAK,GACXA,EAAM,GAAG3S,EAAI0S,EAAK,GAAG1S,EAAI4Q,EAAOzQ,KAAKwM,IAAIJ,GAAOpM,KAAKwM,IAAIJ,GACzDoG,EAAM,GAAG1S,EAAIyS,EAAK,GAAGzS,EAAI2Q,EAAOzQ,KAAKwM,IAAIJ,GAAOpM,KAAKuM,IAAIH,GAEzDoG,EAAM,GAAK,GACXA,EAAM,GAAG3S,EAAI0S,EAAK,GAAG1S,EAAIyQ,EAAOtQ,KAAKwM,IAAIJ,GAAOpM,KAAKuM,IAAIH,GACzDoG,EAAM,GAAG1S,EAAIyS,EAAK,GAAGzS,EAAIwQ,EAAOtQ,KAAKwM,IAAIJ,GAAOpM,KAAKwM,IAAIJ,GAEzDoG,EAAM,GAAK,GACXA,EAAM,GAAG3S,EAAI0S,EAAK,GAAG1S,EAAI4Q,EAAOzQ,KAAKwM,IAAIJ,GAAOpM,KAAKwM,IAAIJ,GACzDoG,EAAM,GAAG1S,EAAIyS,EAAK,GAAGzS,EAAI2Q,EAAOzQ,KAAKwM,IAAIJ,GAAOpM,KAAKuM,IAAIH,GAEzDoG,EAAM,GAAK,GACXA,EAAM,GAAG3S,EAAI0S,EAAK,GAAG1S,EAAIyQ,EAAOtQ,KAAKwM,IAAIJ,GAAOpM,KAAKuM,IAAIH,GACzDoG,EAAM,GAAG1S,EAAIyS,EAAK,GAAGzS,EAAIwQ,EAAOtQ,KAAKwM,IAAIJ,GAAOpM,KAAKwM,IAAIJ,GAElDoG,GAIT3V,EAAWvB,UAAUmT,mBAAqB,SAASzK,EAAWyO,GAG5D,IAFA,IAAIC,EAAS3V,KAAKwR,mBAAmBvK,GACjC2O,EAAU,GACLjZ,EAAI,EAAGA,EAAI+Y,EAAO7S,OAAQlG,IAAK,CACtC,IAAIkZ,EAAO,CACT/S,EAAG4S,EAAO/Y,GAAGmG,EACbC,EAAG2S,EAAO/Y,GAAGoG,GAEf8S,EAAOhX,EAAqBiX,aAAaH,EAAQE,GACjDD,EAAQ7G,KAAK8G,GAIf,OAFAD,EAAQG,UAEDH,GAIT9V,EAAWvB,UAAU8J,gBAAkB,SAASqN,GAK9C,MAJa,CACX5S,GAAI4S,EAAO,GAAG5S,EAAI4S,EAAO,GAAG5S,GAAK,EACjCC,GAAI2S,EAAO,GAAG3S,EAAI2S,EAAO,GAAG3S,GAAK,IAMrCjD,EAAWvB,UAAU4J,aAAe,SAASqN,GAC3C,IAAIE,EAAS,GAkBb,OAjBAA,EAAO3G,KAAK,CACVjM,IAAK9C,KAAKsH,aAAajH,MAAQ,EAAImV,EAAKhO,MACxCzE,EAAG/C,KAAKsH,aAAa/G,OAAS,EAAIiV,EAAKjO,MAEzCmO,EAAO3G,KAAK,CACVjM,EAAG4S,EAAO,GAAG5S,EAAI0S,EAAKnV,MACtB0C,EAAG2S,EAAO,GAAG3S,IAEf2S,EAAO3G,KAAK,CACVjM,EAAG4S,EAAO,GAAG5S,EACbC,EAAG2S,EAAO,GAAG3S,EAAIyS,EAAKjV,SAExBmV,EAAO3G,KAAK,CACVjM,EAAG4S,EAAO,GAAG5S,EACbC,EAAG2S,EAAO,GAAG3S,IAGR2S,GAIT5V,EAAWvB,UAAUiT,mBAAqB,SAASvK,GAGjD,IAFA,IAAI+O,EAAa/O,EAAU6K,MAAM,KAC7B/R,EAAS,GACJpD,EAAI,EAAGA,EAAIqZ,EAAWnT,OAAQlG,IACrC,GAA4B,IAAxBqZ,EAAWrZ,GAAGkV,OAAc,CAE9B,IACIoE,EADAC,EAAOlW,KAAKmW,yBAAyBH,EAAWrZ,IAGlDsZ,EADe,UAAbC,EAAKhZ,KACE2B,EAAqBqX,EAAKhZ,MACjCgZ,EAAKnW,OAAO,GACZmW,EAAKnW,OAAO,IAGLlB,EAAqBqX,EAAKhZ,MAAMgZ,EAAKnW,OAAO,IAEvDA,EAAOgP,KAAKkH,GAIhB,OAAOpX,EAAqBuX,QAAQrW,IAItCD,EAAWvB,UAAU4X,yBAA2B,SAASlP,GAQvD,IAPA,IAAI2B,EAAQ3B,EAAU8F,QAAQ,KAC1BjE,EAAM7B,EAAU8F,QAAQ,KACxBmJ,EAAO,GAGPnW,EAASkH,EAAU2K,UAAUhJ,EAAQ,EAAGE,GAAKgJ,MAAM,KACnDuE,EAAM,GACD1Z,EAAI,EAAGA,EAAIoD,EAAO8C,OAAQlG,IACjC0Z,EAAItH,KAAKlI,WAAW9G,EAAOpD,KAE7BuZ,EAAKnW,OAASsW,EAGd,IAAInZ,EAAO+J,EAAU2K,UAAU,EAAGhJ,GAAOgE,cACrC0J,EAAY,EAsBhB,OArB8B,GAA1BpZ,EAAK6P,QAAQ,UACfmJ,EAAKhZ,KAAO,QACZoZ,EAAY,IAC2B,GAA9BpZ,EAAK6P,QAAQ,aACtBmJ,EAAKhZ,KAAO,aACsB,GAAzBA,EAAK6P,QAAQ,QACtBmJ,EAAKhZ,KAAO,WACwB,GAA3BA,EAAK6P,QAAQ,YACtBmJ,EAAKhZ,KAAO,cAIY,GAAtBA,EAAK6P,QAAQ,KACfmJ,EAAKnW,OAAOgP,KAAKuH,IACc,GAAtBpZ,EAAK6P,QAAQ,KACtBmJ,EAAKnW,OAAOwW,QAAQD,IACgB,GAA3BpZ,EAAK6P,QAAQ,WAAmBmJ,EAAKnW,OAAO8C,QAAU,GAE/DqT,EAAKnW,OAAOgP,KAAKmH,EAAKnW,OAAO,IAGxBmW,GAITpW,EAAWvB,UAAUiY,oBAAsB,SAASC,EAAMC,GACxD,IAAIzB,EAAOjV,KAAKoP,OAAOsH,GACnBC,EAAKF,EAAK3T,EAAI4T,EAAK5T,EAAI2T,EAAK1T,EAAI2T,EAAK3T,EAOzC,MALW,CACTD,EAAI6T,EAAK1T,KAAK+K,IAAIiH,EAAM,GAAMyB,EAAK5T,EACnCC,EAAI4T,EAAK1T,KAAK+K,IAAIiH,EAAM,GAAMyB,EAAK3T,IAOvCjD,EAAWvB,UAAU+U,4BAA8B,SACjDpH,EACAkH,GAGA,IAAIK,EAAK,CACP3Q,EAAGsQ,EAAW,GAAGtQ,EAAIsQ,EAAW,GAAGtQ,EACnCC,EAAGqQ,EAAW,GAAGrQ,EAAIqQ,EAAW,GAAGrQ,GAEjC6Q,EAAQ,CACV9Q,EAAGsQ,EAAW,GAAGtQ,EAAIsQ,EAAW,GAAGtQ,EACnCC,EAAGqQ,EAAW,GAAGrQ,EAAIqQ,EAAW,GAAGrQ,GAIjC8K,EAAS7N,KAAKqI,gBAAgB+K,GAC9BwD,EAAO,CACT9T,EAAGoJ,EAAMpJ,EAAI+K,EAAO/K,EACpBC,EAAGmJ,EAAMnJ,EAAI8K,EAAO9K,GAMtB,MAAO,CACL0Q,GAAIA,EACJD,MALUxT,KAAKwW,oBAAoBI,EAAMnD,GAMzCG,MAAOA,EACPD,MANU3T,KAAKwW,oBAAoBI,EAAMhD,KAW7C9T,EAAWvB,UAAU4U,wBAA0B,SAASjH,EAAOkH,GAC7D,IAAIC,EAAMrT,KAAKsT,4BAA4BpH,EAAOkH,GAE9CG,EAAOtQ,KAAK4T,MAAM7W,KAAKoP,OAAOiE,EAAIG,OAASxT,KAAKkB,YAChDX,EAAS0C,KAAK4T,MAAO7W,KAAKoP,OAAOiE,EAAII,IAAM,EAAKzT,KAAKkB,YACrDwS,EAAOzQ,KAAK4T,MAAM7W,KAAKoP,OAAOiE,EAAIM,OAAS3T,KAAKkB,YAChDb,EAAQ4C,KAAK4T,MAAO7W,KAAKoP,OAAOiE,EAAIO,OAAS,EAAK5T,KAAKkB,YAE3D,OAAIqS,GAAQhT,GAAUmT,GAAQrT,GAQhCP,EAAWvB,UAAUuY,0BAA4B,SAAS5K,EAAOkH,GAG/D,IADA,IAAI2D,EAAO,GACFpa,EAAI,EAAGA,EAAIyW,EAAWvQ,OAAQlG,IAAK,CAC1C,IAAI8B,EAAI2U,EAAWzW,GACnBoa,EAAKhI,KAAK,CACRjM,EAAGrE,EAAEqE,EAAIoJ,EAAMpJ,EACfC,EAAGtE,EAAEsE,EAAImJ,EAAMnJ,IAKnB,IAAIiU,EAAS,EACTC,EAAO,EACX,IAAKta,EAAI,EAAGA,EAAIoa,EAAKlU,OAAQlG,IAAK,CAChC,IAAIiG,EAAM5C,KAAKoP,OAAO2H,EAAKpa,KAChB,GAAPiG,GAAYA,EAAMqU,KACpBD,EAASra,EACTsa,EAAOrU,GAGXA,EAAMmU,EAAKlU,OACX,IAEIqU,EAFAC,EAAOJ,EAAKK,OAAOJ,EAAQ,GAAG,GAC9BK,EAAOF,EAIPG,EAAS,GACb,IAAK3a,EAAI,EAAGA,EAAIiG,EAAKjG,IAAK,CACxB,IAAI4a,EAAOvX,KAAKwX,YAAYH,EAAMN,GAClCM,EAAOE,EAAKrI,IACZ6H,EAAKK,OAAOG,EAAKE,MAAO,GACxBH,EAAOvI,KAAKwI,EAAKxQ,OAEE,GAAfgQ,EAAKlU,SACPqU,EAAOH,EAAK,IAGhBO,EAAOvI,KAAK/O,KAAKwX,YAAYN,EAAM,CAACC,IAAOpQ,OAE3C,IAAI2Q,EAAM,EACV,IAAK/a,EAAI,EAAGA,EAAI2a,EAAOzU,OAAQlG,IAC7B+a,GAAOJ,EAAO3a,GAKhB,SADA+a,EAAMA,EAAIvI,QAAQnP,KAAKkB,aACb,MAQZpB,EAAWvB,UAAUiZ,YAAc,SAASH,EAAMM,GAGhD,IAFA,IAAIC,EAAW5X,KAAKuU,SAAS8C,EAAMM,EAAK,IACpCE,EAAW,EACNlb,EAAI,EAAGA,EAAIgb,EAAK9U,OAAQlG,IAAK,CACpC,IAAIoK,EAAQ/G,KAAKuU,SAAS8C,EAAMM,EAAKhb,IACjCoK,EAAQ6Q,IACVA,EAAW7Q,EACX8Q,EAAWlb,GAGf,MAAO,CACLoK,MAAO6Q,EACP1I,IAAKyI,EAAKE,GACVJ,MAAOI,IAKX/X,EAAWvB,UAAUgW,SAAW,SAASuD,EAAMC,GAC7C,IAAIC,GACDF,EAAKhV,EAAIiV,EAAKjV,EAAIgV,EAAK/U,EAAIgV,EAAKhV,IAChC/C,KAAKoP,OAAO0I,GAAQ9X,KAAKoP,OAAO2I,IAOnC,OANI9U,KAAKE,IAAI6U,GAAQ,IAEnBA,EAAOA,EAAO,EAAI,GAAK,GAGN,IADT/U,KAAK+U,KAAKA,GACM/U,KAAKqM,IAKjCxP,EAAWvB,UAAU6Q,OAAS,SAASF,GACrC,OAAOjM,KAAK8K,KAAKmB,EAAIpM,EAAIoM,EAAIpM,EAAIoM,EAAInM,EAAImM,EAAInM,IAI/CjD,EAAWvB,UAAUkN,UAAY,SAASwM,EAAMC,GAC9C,IAAIC,EAAS,IAAIC,WACjBD,EAAOrN,OAAS,SAASvC,GACvB2P,EAAS3P,EAAEyD,OAAOiK,SAEpBkC,EAAOE,cAAcJ,IAGhBnY,IA9mE6D,gC,gBCLtE,UAGQ,EAAO,QAAW,0BAAP,EAQjB,WAEE,IAAIL,EAA2B,oBAAZT,SACbA,SAASC,cAAc,KAAKQ,MAC5B,GAEF6Y,EAAW,CAAC,IAAK,KAAM,MAAO,UAC9BC,EAAQ,WACRC,EAAO,GAUX,SAAS5Y,EAAO1B,GAOZ,GALAA,EAAMA,EAAIua,QAAQ,aAAa,SAASC,EAAGC,GACvC,OAAOA,EAAKC,sBAIGpZ,IAAfC,EAAMvB,GAAoB,OAAOA,EAKrC,IAFA,IAAI2a,EAAM3a,EAAI4a,OAAO,GAAGF,cAAgB1a,EAAIsM,MAAM,GAC9C7N,EAAI2b,EAASzV,OACVlG,KAAK,CACR,IAAIO,EAAOob,EAAS3b,GAAKkc,EACzB,QAAoBrZ,IAAhBC,EAAMvC,GAAqB,OAAOA,EAG1C,OAAOgB,EAgCX,MAAO,CACH0B,OAvBJ,SAAwB1B,GACpB,OAAOA,KAAOsa,EACRA,EAAKta,GACLsa,EAAKta,GAAO0B,EAAO1B,IAqBzB6a,KAXJ,SAAsB7a,GAMlB,OALAA,EAAM0B,EAAO1B,GACTqa,EAAMS,KAAK9a,KACXA,EAAMA,EAAIua,QAAQF,EAAO,OACzBA,EAAMU,UAAY,GAEf/a,EAAI0O,kBAxEO,gC,gBCH1B,kBAEI,IAIIhO,EAAO,SAASsa,GAChB,OAAIA,aAAeta,EAAasa,EAC1BlZ,gBAAgBpB,OACtBoB,KAAKmZ,YAAcD,GADiB,IAAIta,EAAKsa,IAKR9c,EAAOD,UACxCA,EAAUC,EAAOD,QAAUyC,GAE/BzC,EAAQyC,KAAOA,EAKnB,IAAIwa,EAAWxa,EAAKya,KAAO,CAGvB,MAAS,cACT,MAAS,kBAGT,MAAS,aAGT,MAAS,kBACT,MAAS,kBACT,MAAS,0BACT,MAAS,yBAGT,MAAS,YACT,MAAS,cAGT,MAAS,mBAGT,MAAS,mBACT,MAAS,oBACT,MAAS,aACT,MAAS,qBACT,MAAS,sBAGT,MAAS,eACT,MAAS,UACT,MAAS,kBACT,MAAS,sBACT,MAAS,kBACT,MAAS,OACT,MAAS,oBACT,MAAS,gBACT,MAAS,kBACT,MAAS,eACT,MAAS,mBACT,MAAS,kBACT,MAAS,eACT,MAAS,cACT,MAAS,QACT,MAAS,cACT,MAAS,cACT,MAAS,cACT,MAAS,2BACT,MAAS,wBACT,MAAS,wBACT,MAAS,2BACT,MAAS,kBACT,MAAS,gBACT,MAAS,gBACT,MAAS,aACT,MAAS,YACT,MAAS,aACT,MAAS,iBACT,MAAS,eACT,MAAS,eACT,MAAS,oBACT,MAAS,wBACT,MAAS,mBACT,MAAS,cACT,MAAS,WACT,MAAS,aACT,MAAS,YACT,MAAS,2BACT,MAAS,uBAGT,MAAS,6BACT,MAAS,iBAGTC,EAAW1a,EAAK0a,SAAW,CAC3B,IAAS,aACT,IAAS,cACT,MAAS,iBACT,MAAS,oBACT,MAAS,6BACT,IAAS,gBACT,IAAS,cACT,IAAS,4BACT,IAAS,cACT,IAAS,kBACT,IAAS,sBACT,IAAS,mBACT,IAAS,mBACT,IAAS,cACT,IAAS,cACT,IAAS,iBACT,IAAS,eACT,IAAS,eACT,IAAS,kBACT,IAAS,wBACT,IAAS,8BACT,IAAS,mBACT,IAAS,aACT,IAAS,wBACT,IAAS,oBACT,IAAS,sBACT,IAAS,WACT,IAAS,mBACT,IAAS,OACT,IAAS,QACT,IAAS,WACT,IAAS,SACT,MAAS,aAGTC,EAAU3a,EAAK2a,QAAU,CACzBC,EAAS,eACT,EAAS,iBACT,EAAS,cACT,EAAS,kBACT,EAAS,eACT,EAAS,iBACT,EAAS,cACT,EAAS,eACT,EAAS,gBACT,EAAS,YACT,GAAS,iBACT,GAAS,SACT,GAAS,cACT,GAAS,WACT,GAAS,cACT,GAAS,WACT,GAAS,qBACT,GAAS,kBACT,GAAS,cACT,GAAS,qBACT,GAAS,kBACT,GAAS,sBACT,GAAS,mBACT,GAAS,oBACT,GAAS,iBACT,GAAS,qBACT,GAAS,kBACT,GAAS,sBACT,GAAS,qBACT,GAAS,eACT,GAAS,mBAITC,EAAW7a,EAAK6a,SAAW,CAC3B,IAAQ,aACR,IAAQ,cACR,IAAQ,gBACR,IAAQ,cACR,IAAQ,4BACR,IAAQ,eACR,IAAQ,cACR,IAAQ,kBACR,IAAQ,eACR,IAAQ,kBACR,IAAQ,cACR,IAAQ,cACR,IAAQ,sBACR,IAAQ,iBACR,IAAQ,eACR,IAAQ,kBACR,IAAQ,oBACR,IAAQ,mBACR,IAAQ,mBACR,IAAQ,uBAGRC,EAAe9a,EAAK8a,aAAe,CACnCC,gBAAkB,CACdH,EAAI,cACJI,EAAI,SACJC,EAAI,iBACJC,EAAI,oBACJC,EAAI,mBACJC,EAAI,mBACJC,EAAI,iBACJC,EAAI,gBACJC,EAAI,kBAERC,aAAe,CACXZ,EAAI,UACJI,EAAI,UACJC,EAAI,wBACJC,EAAI,OACJC,EAAI,YACJC,EAAI,UACJC,EAAI,UACJI,IAAM,SAEVC,YAAc,CACVd,EAAI,UACJI,EAAI,WACJC,EAAI,cACJC,EAAI,gCACJC,EAAI,QACJQ,EAAI,eACJC,GAAK,iBACLC,GAAK,QACLC,GAAK,wCACLC,GAAK,yCACLC,GAAK,0CACLC,GAAK,sCACLC,GAAK,mBACLC,GAAK,mBACLC,GAAK,mBACLC,GAAK,MACLC,GAAK,MACLC,GAAK,MACLC,GAAK,MACLC,GAAK,sBACLhB,IAAM,SAEViB,MAAQ,CACJ9B,EAAS,qBACT,EAAS,cACT,EAAS,mCACT,EAAS,+BACT,EAAS,qCACT,GAAS,gEACT,GAAS,4DACT,GAAS,4CACT,GAAS,gCACT,GAAS,yBACT,GAAS,oDACT,GAAS,gDACT,GAAS,oBACT,GAAS,sCACT,GAAS,iEACT,GAAS,6DACT,GAAS,6DACT,GAAS,wFACT,GAAS,oFACT,GAAS,iDACT,GAAS,4EACT,GAAS,yEAEb+B,cAAgB,CACZ3B,EAAI,cACJC,EAAI,6BACJC,EAAI,6BACJC,EAAI,+BACJC,EAAI,+BACJE,EAAI,mBACJC,EAAI,kCAERqB,iBAAmB,CACfhC,EAAI,WACJI,EAAI,YACJC,EAAI,WACJC,EAAI,eAER2B,UAAY,CACR7B,EAAI,yBAER8B,eAAiB,CACblC,EAAI,iBACJI,EAAI,kBAER+B,aAAe,CACXnC,EAAI,qBACJI,EAAI,wBAERgC,YAAc,CACVpC,EAAI,OACJI,EAAI,cACJC,EAAI,eACJC,EAAI,gBACJC,EAAI,kBAER8B,SAAW,CACPrC,EAAI,SACJI,EAAI,OACJC,EAAI,QAERiC,WAAa,CACTtC,EAAI,SACJI,EAAI,iBACJC,EAAI,mBAERkC,UAAY,CACRvC,EAAI,SACJI,EAAI,OACJC,EAAI,QAERmC,qBAAuB,CACnBxC,EAAI,UACJI,EAAI,QACJC,EAAI,aACJC,EAAI,gBAERmC,WAAa,CACTnC,EAAI,OAGRoC,WAAa,CACT1C,EAAI,GACJI,EAAI,IACJC,EAAI,KACJC,EAAI,KACJC,EAAI,IACJC,EAAI,IACJC,EAAI,MAYZ,SAASkC,EAAaC,GAClB,QAAUA,EAAY,SA6B1B,SAASC,EAAaD,EAAKlE,GACvB,SAASoE,EAAiBC,GACtB,IAAIhF,EAAOiF,EAAeD,GAC1BH,EAAIK,SAAWlF,GAAQ,GACvB,IAAImF,EAyFZ,SAAwBzE,GACpB,IAAI0E,EAAW,IAAIC,SAAS3E,GA3cpB,EA8cR,GAA6B,KAAxB0E,EAASE,SAAS,IAAwC,KAAxBF,EAASE,SAAS,GAErD,OAAO,EAGX,IAAIC,EAAS,EACTja,EAASoV,EAAK8E,WAGdC,EAAsB,SAASL,EAAUG,GACzC,OACkC,KAA9BH,EAASE,SAASC,IACc,KAAhCH,EAASE,SAASC,EAAO,IACO,KAAhCH,EAASE,SAASC,EAAO,IACO,KAAhCH,EAASE,SAASC,EAAO,IACO,IAAhCH,EAASE,SAASC,EAAO,IACO,IAAhCH,EAASE,SAASC,EAAO,IAIjC,KAAOA,EAASja,GAAQ,CAEpB,GAAKma,EAAoBL,EAAUG,GAAS,CAGxC,IAAIG,EAAmBN,EAASE,SAASC,EAAO,GAC7CG,EAAmB,GAAM,IAAGA,GAAoB,GAE3B,IAArBA,IAECA,EAAmB,GAGvB,IAAIC,EAAcJ,EAAS,EAAIG,EAC3BE,EAAgBR,EAASS,UAAUN,EAAS,EAAIG,GAEpD,OAAOI,EAAapF,EAAMiF,EAAaC,GAQ3CL,KAzIeQ,CAAef,GAE9B,GADAH,EAAIM,SAAWA,GAAY,GACvB9d,EAAK2e,aAAc,CACpB,IAAIC,EAmdhB,SAAuBvF,GAElB,KAAM,cAAerX,MAEjB,OAEJ,IAAI+b,EAAW,IAAIC,SAAS3E,GA70BpB,EAg1BR,GAA6B,KAAxB0E,EAASE,SAAS,IAAwC,KAAxBF,EAASE,SAAS,GAEtD,OAAO,EAGV,IAAIC,EAAS,EACTja,EAASoV,EAAK8E,WACdU,EAAM,IAAIC,UAEd,KAAOZ,EAAUja,EAAO,GAAI,CACxB,GAA4C,QAAxC8a,EAAgBhB,EAAUG,EAAQ,GAAc,CAChD,IAAII,EAAcJ,EAAS,EACvBK,EAAgBR,EAASS,UAAUN,EAAS,GAAK,EACjDc,EAAYD,EAAgBhB,EAAUO,EAAaC,GACnDU,EAAcD,EAAU7Q,QAAQ,YAAc,EAG9C+Q,GAFJF,EAAYA,EAAUhM,UAAWgM,EAAU7Q,QAAS,cAAgB8Q,IAEzC9Q,QAAQ,aAAe,GAkBlD,OAfA6Q,EAAYA,EAAUpT,MAAM,EAAGsT,GAAnBF,6nBAYEA,EAAUpT,MAAMsT,GAGvBC,EADWN,EAAIO,gBAAiBJ,EAAW,aAGrDd,KAjgBemB,CAAc1B,GAC3BH,EAAIoB,QAAUA,GAAW,GAExBtF,GACAA,EAASpb,KAAKsf,GAItB,GAAIA,EAAI9Z,IACJ,GAAI,WAAW0W,KAAKoD,EAAI9Z,KAEpBga,EA3CZ,SAA6B4B,EAAQC,GACjCA,EAAcA,GAAeD,EAAOE,MAAM,8BAA8B,IAAM,GAC9EF,EAASA,EAAOzF,QAAQ,8BAA+B,IAKvD,IAJA,IAAI4F,EAASC,KAAKJ,GACdtb,EAAMyb,EAAOxb,OACb0b,EAAS,IAAIC,YAAY5b,GACzB6b,EAAO,IAAIC,WAAWH,GACjB5hB,EAAI,EAAGA,EAAIiG,EAAKjG,IACrB8hB,EAAK9hB,GAAK0hB,EAAOM,WAAWhiB,GAEhC,OAAO4hB,EAgCmBK,CAAoBxC,EAAI9Z,WAGvC,GAAI,WAAW0W,KAAKoD,EAAI9Z,KAAM,EAC7Buc,EAAa,IAAIzG,YACVtN,OAAS,SAASvC,GACzB+T,EAAiB/T,EAAEyD,OAAOiK,SAnC1C,SAAyB6I,EAAK5G,GAC1B,IAAI6G,EAAO,IAAIC,eACfD,EAAKE,KAAK,MAAOH,GAAK,GACtBC,EAAKG,aAAe,OACpBH,EAAKjU,OAAS,SAASvC,GACA,KAAfvI,KAAKmf,QAAiC,IAAhBnf,KAAKmf,QAC3BjH,EAASlY,KAAKof,WAGtBL,EAAKM,OA4BGC,CAAgBlD,EAAI9Z,KAAK,SAAUid,GAC/BV,EAAWW,kBAAkBD,UAE9B,CACH,IAAIR,EAAO,IAAIC,eACfD,EAAKjU,OAAS,WACV,GAAmB,KAAf9K,KAAKmf,QAAiC,IAAhBnf,KAAKmf,OAG3B,KAAM,uBAFN7C,EAAiByC,EAAKK,UAI1BL,EAAO,MAEXA,EAAKE,KAAK,MAAO7C,EAAI9Z,KAAK,GAC1Byc,EAAKG,aAAe,cACpBH,EAAKM,KAAK,WAEX,GAAIze,KAAKwX,aAAegE,aAAexb,KAAK6e,MAAQrD,aAAexb,KAAK8e,MAAO,CAClF,IAAIb,KAAa,IAAIzG,YACVtN,OAAS,SAASvC,GAEzB+T,EAAiB/T,EAAEyD,OAAOiK,SAG9B4I,EAAWW,kBAAkBpD,IAIrC,SAASI,EAAevE,GACpB,IAAI0E,EAAW,IAAIC,SAAS3E,GAG5B,GAA6B,KAAxB0E,EAASE,SAAS,IAAwC,KAAxBF,EAASE,SAAS,GAErD,OAAO,EAOX,IAJA,IAAIC,EAAS,EACTja,EAASoV,EAAK8E,WAGXD,EAASja,GAAQ,CACpB,GAAiC,KAA7B8Z,EAASE,SAASC,GAElB,OAAO,EASX,GAAc,KANLH,EAASE,SAASC,EAAS,GAShC,OAAO6C,EAAahD,EAAUG,EAAS,EAAGH,EAASS,UAAUN,EAAS,IAKtEA,GAAU,EAAIH,EAASS,UAAUN,EAAO,IA4DpD,IAAI8C,EAAe,CACf,IAAO,UACP,IAAO,SACP,GAAO,WACP,GAAO,cACP,GAAO,SACP,GAAO,cACP,IAAO,gBACP,IAAO,WACP,IAAO,YACP,GAAO,YAEX,SAASvC,EAAapF,EAAMiF,EAAaC,GAKrC,IAJA,IAEI0C,EAAYC,EAAWC,EAAUC,EAFjCrD,EAAW,IAAIC,SAAS3E,GACxBV,EAAO,GAEP0I,EAAkB/C,EAChB+C,EAAkB/C,EAAYC,GACU,KAAvCR,EAASE,SAASoD,IAAsE,IAAzCtD,EAASE,SAASoD,EAAgB,KAChFD,EAAcrD,EAASE,SAASoD,EAAgB,MAC9BL,KACdG,EAAWpD,EAASuD,SAASD,EAAgB,IACpB,EACzBH,EAAYF,EAAaI,GACzBH,EAAalC,EAAgBhB,EAAUsD,EAAgB,EAAGF,GAEvDxI,EAAK/Y,eAAeshB,GAEhBvI,EAAKuI,aAAsBtd,MAC1B+U,EAAKuI,GAAW/Q,KAAK8Q,GAGrBtI,EAAKuI,GAAa,CAACvI,EAAKuI,GAAYD,GAIxCtI,EAAKuI,GAAaD,GAK9BI,IAEJ,OAAO1I,EAKX,SAAS4I,EAASlI,EAAMmI,EAAWC,EAAUC,EAASC,GAClD,IAEIC,EACA7jB,EAHA8jB,EAAUxI,EAAKmF,UAAUiD,GAAWE,GACpCG,EAAO,GAIX,IAAK/jB,EAAE,EAAEA,EAAE8jB,EAAQ9jB,IACf6jB,EAAcH,EAAa,GAAF1jB,EAAO,EAGhC+jB,EAFMJ,EAAQrI,EAAKmF,UAAUoD,GAAcD,KAE/BI,EAAa1I,EAAMuI,EAAaJ,EAAWC,EAAUE,GAErE,OAAOG,EAIX,SAASC,EAAa1I,EAAMuI,EAAaJ,EAAWC,EAAUE,GAC1D,IAGIzD,EACA8D,EAAMC,EAAKziB,EACX0iB,EAAWC,EALX1V,EAAO4M,EAAKmF,UAAUoD,EAAY,GAAID,GACtCS,EAAY/I,EAAKgJ,UAAUT,EAAY,GAAID,GAC3CW,EAAcjJ,EAAKgJ,UAAUT,EAAY,GAAID,GAAUH,EAK3D,OAAQ/U,GACJ,KAAK,EACL,KAAK,EACD,GAAiB,GAAb2V,EACA,OAAO/I,EAAK4E,SAAS2D,EAAc,GAAID,GAIvC,IAFAzD,EAASkE,EAAY,EAAIE,EAAeV,EAAc,EACtDI,EAAO,GACFxiB,EAAE,EAAEA,EAAE4iB,EAAU5iB,IACjBwiB,EAAKxiB,GAAK6Z,EAAK4E,SAASC,EAAS1e,GAErC,OAAOwiB,EAGf,KAAK,EAED,OAAOjD,EAAgB1F,EADvB6E,EAASkE,EAAY,EAAIE,EAAeV,EAAc,EACjBQ,EAAU,GAEnD,KAAK,EACD,GAAiB,GAAbA,EACA,OAAO/I,EAAKmF,UAAUoD,EAAc,GAAID,GAIxC,IAFAzD,EAASkE,EAAY,EAAIE,EAAeV,EAAc,EACtDI,EAAO,GACFxiB,EAAE,EAAEA,EAAE4iB,EAAU5iB,IACjBwiB,EAAKxiB,GAAK6Z,EAAKmF,UAAUN,EAAS,EAAE1e,GAAImiB,GAE5C,OAAOK,EAGf,KAAK,EACD,GAAiB,GAAbI,EACA,OAAO/I,EAAKgJ,UAAUT,EAAc,GAAID,GAGxC,IADAK,EAAO,GACFxiB,EAAE,EAAEA,EAAE4iB,EAAU5iB,IACjBwiB,EAAKxiB,GAAK6Z,EAAKgJ,UAAUC,EAAc,EAAE9iB,GAAImiB,GAEjD,OAAOK,EAGf,KAAK,EACD,GAAiB,GAAbI,EAMA,OALAF,EAAY7I,EAAKgJ,UAAUC,GAAcX,GACzCQ,EAAc9I,EAAKgJ,UAAUC,EAAY,GAAIX,IAC7CM,EAAM,IAAIM,OAAOL,EAAYC,IACzBD,UAAYA,EAChBD,EAAIE,YAAcA,EACXF,EAGP,IADAD,EAAO,GACFxiB,EAAE,EAAEA,EAAE4iB,EAAU5iB,IACjB0iB,EAAY7I,EAAKgJ,UAAUC,EAAc,EAAE9iB,GAAImiB,GAC/CQ,EAAc9I,EAAKgJ,UAAUC,EAAY,EAAI,EAAE9iB,GAAImiB,GACnDK,EAAKxiB,GAAK,IAAI+iB,OAAOL,EAAYC,GACjCH,EAAKxiB,GAAG0iB,UAAYA,EACpBF,EAAKxiB,GAAG2iB,YAAcA,EAE1B,OAAOH,EAGf,KAAK,EACD,GAAiB,GAAbI,EACA,OAAO/I,EAAKmJ,SAASZ,EAAc,GAAID,GAGvC,IADAK,EAAO,GACFxiB,EAAE,EAAEA,EAAE4iB,EAAU5iB,IACjBwiB,EAAKxiB,GAAK6Z,EAAKmJ,SAASF,EAAc,EAAE9iB,GAAImiB,GAEhD,OAAOK,EAGf,KAAK,GACD,GAAiB,GAAbI,EACA,OAAO/I,EAAKmJ,SAASF,GAAcX,GAAUtI,EAAKmJ,SAASF,EAAY,GAAIX,GAG3E,IADAK,EAAO,GACFxiB,EAAE,EAAEA,EAAE4iB,EAAU5iB,IACjBwiB,EAAKxiB,GAAK6Z,EAAKmJ,SAASF,EAAc,EAAE9iB,GAAImiB,GAAUtI,EAAKmJ,SAASF,EAAY,EAAI,EAAE9iB,GAAImiB,GAE9F,OAAOK,GAyEvB,SAASjD,EAAgBY,EAAQ3V,EAAO/F,GACpC,IAAIwe,EAAS,GACb,IAAKjjB,EAAIwK,EAAOxK,EAAIwK,EAAM/F,EAAQzE,IAC9BijB,GAAUC,OAAOC,aAAahD,EAAO1B,SAASze,IAElD,OAAOijB,EAGX,SAAS1B,EAAa1H,EAAMrP,GACxB,GAAuC,QAAnC+U,EAAgB1F,EAAMrP,EAAO,GAE7B,OAAO,EAGX,IAAI2X,EACAG,EAAM1T,EACNwU,EAAUC,EACVC,EAAa9Y,EAAQ,EAGzB,GAAkC,OAA9BqP,EAAKmF,UAAUsE,GACfnB,GAAS,MACN,IAAkC,OAA9BtI,EAAKmF,UAAUsE,GAItB,OAAO,EAHPnB,GAAS,EAMb,GAA6C,IAAzCtI,EAAKmF,UAAUsE,EAAW,GAAInB,GAE9B,OAAO,EAGX,IAAIoB,EAAiB1J,EAAKgJ,UAAUS,EAAW,GAAInB,GAEnD,GAAIoB,EAAiB,EAEjB,OAAO,EAKX,IAFAjB,EAAOP,EAASlI,EAAMyJ,EAAYA,EAAaC,EAAgBrI,EAAUiH,IAEhEqB,eAEL,IAAK5U,KADLwU,EAAWrB,EAASlI,EAAMyJ,EAAYA,EAAahB,EAAKkB,eAAgBxI,EAAUmH,GAC5D,CAClB,OAAQvT,GACJ,IAAK,cACL,IAAK,QACL,IAAK,eACL,IAAK,kBACL,IAAK,gBACL,IAAK,mBACL,IAAK,YACL,IAAK,iBACL,IAAK,eACL,IAAK,cACL,IAAK,WACL,IAAK,aACL,IAAK,YACL,IAAK,uBACL,IAAK,aACDwU,EAASxU,GAAO0M,EAAa1M,GAAKwU,EAASxU,IAC3C,MAEJ,IAAK,cACL,IAAK,kBACDwU,EAASxU,GAAOsU,OAAOC,aAAaC,EAASxU,GAAK,GAAIwU,EAASxU,GAAK,GAAIwU,EAASxU,GAAK,GAAIwU,EAASxU,GAAK,IACxG,MAEJ,IAAK,0BACDwU,EAASxU,GACL0M,EAAawC,WAAWsF,EAASxU,GAAK,IACtC0M,EAAawC,WAAWsF,EAASxU,GAAK,IACtC0M,EAAawC,WAAWsF,EAASxU,GAAK,IACtC0M,EAAawC,WAAWsF,EAASxU,GAAK,IAGlD0T,EAAK1T,GAAOwU,EAASxU,GAI7B,GAAI0T,EAAKmB,kBAEL,IAAK7U,KADLyU,EAAUtB,EAASlI,EAAMyJ,EAAYA,EAAahB,EAAKmB,kBAAmBtI,EAASgH,GAC9D,CACjB,OAAQvT,GACJ,IAAK,eACDyU,EAAQzU,GAAOyU,EAAQzU,GAAK,GACxB,IAAMyU,EAAQzU,GAAK,GACnB,IAAMyU,EAAQzU,GAAK,GACnB,IAAMyU,EAAQzU,GAAK,GAG/B0T,EAAK1T,GAAOyU,EAAQzU,GAO5B,OAFA0T,EAAgB,UAvJpB,SAA4B/D,EAAUyD,EAAWuB,EAAgBpB,GAE7D,IAAIuB,EAbR,SAA0BnF,EAAU0D,EAAUE,GAE1C,IAAIE,EAAU9D,EAASS,UAAUiD,GAAWE,GAM5C,OAAO5D,EAASsE,UAAUZ,EAAW,EAAc,GAAVI,GAAeF,GAKhCwB,CAAiBpF,EAAUyD,EAAUuB,EAAgBpB,GAE7E,IAAKuB,EAED,MAAO,GAEN,GAAIA,EAAoBnF,EAASI,WAElC,MAAO,GAIX,IAAIiF,EAAY7B,EAASxD,EAAUyD,EAAWA,EAAY0B,EAAmBrI,EAAU8G,GAUvF,GAAIyB,EAAuB,YAGvB,OAAQA,EAAuB,aAC3B,KAAK,EAED,GAAIA,EAAUC,cAAgBD,EAAUE,gBAAiB,CAErD,IAAIC,EAAU/B,EAAY4B,EAAUC,aAChCG,EAAUJ,EAAUE,gBACxBF,EAAgB,KAAI,IAAIvC,KAAK,CAAC,IAAIf,WAAW/B,EAAS4B,OAAQ4D,EAASC,IAAW,CAC9E/W,KAAM,eAGlB,MAEJ,KAAK,EACDgX,QAAQC,IAAI,6DACZ,MACJ,QACID,QAAQC,IAAI,sCAAuCN,EAAuB,kBAG/B,GAA1CA,EAAqC,2BAC1CK,QAAQC,IAAI,4DAEhB,OAAON,EAqGaO,CAAmBtK,EAAMyJ,EAAYC,EAAgBpB,GAElEG,EAsDX,SAAS8B,EAASC,GACd,IAAIC,EAAO,GAEX,GAAoB,GAAhBD,EAAIE,UACN,GAAIF,EAAIG,WAAW/f,OAAS,EAAG,CAC7B6f,EAAK,eAAiB,GACtB,IAAK,IAAI3R,EAAI,EAAGA,EAAI0R,EAAIG,WAAW/f,OAAQkO,IAAK,CAC9C,IAAI8R,EAAYJ,EAAIG,WAAW/M,KAAK9E,GACpC2R,EAAK,eAAeG,EAAUC,UAAYD,EAAUE,iBAGnD,GAAoB,GAAhBN,EAAIE,SACb,OAAOF,EAAIM,UAIb,GAAIN,EAAIO,gBACN,IAAI,IAAIrmB,EAAI,EAAGA,EAAI8lB,EAAIQ,WAAWpgB,OAAQlG,IAAK,CAC7C,IAAIumB,EAAQT,EAAIQ,WAAWpN,KAAKlZ,GAC5BmmB,EAAWI,EAAMJ,SACrB,GAAsB,MAAlBJ,EAAKI,GACPJ,EAAKI,GAAYN,EAASU,OACrB,CACL,GAA2B,MAAvBR,EAAKI,GAAU/T,KAAc,CAC/B,IAAIoU,EAAMT,EAAKI,GACfJ,EAAKI,GAAY,GACjBJ,EAAKI,GAAU/T,KAAKoU,GAEtBT,EAAKI,GAAU/T,KAAKyT,EAASU,KAKnC,OAAOR,EAGX,SAAS3E,EAAW0E,GAChB,IACI,IAAIvJ,EAAM,GACV,GAAIuJ,EAAIW,SAASvgB,OAAS,EACxB,IAAK,IAAIlG,EAAI,EAAGA,EAAI8lB,EAAIW,SAASvgB,OAAQlG,IAAK,CAC5C,IAAIkZ,EAAO4M,EAAIW,SAASvN,KAAKlZ,GACzBimB,EAAa/M,EAAK+M,WACtB,IAAI,IAAIS,KAAOT,EAAY,CACvB,IAAIU,EAAUV,EAAWS,GACrBE,EAAUD,EAAQR,SAClBU,EAAYF,EAAQP,eAETvjB,IAAZ+jB,IACCrK,EAAIqK,GAAWC,GAGvB,IAAIV,EAAWjN,EAAKiN,SAEpB,QAA8B,IAAlB5J,EAAI4J,GACd5J,EAAI4J,GAAYN,EAAS3M,OACpB,CACL,QAAmC,IAAvBqD,EAAI4J,GAAc,KAAkB,CAC9C,IAAIK,EAAMjK,EAAI4J,GAEd5J,EAAI4J,GAAY,GAChB5J,EAAI4J,GAAU/T,KAAKoU,GAErBjK,EAAI4J,GAAU/T,KAAKyT,EAAS3M,UAIhCqD,EAAMuJ,EAAIgB,YAEZ,OAAOvK,EACP,MAAO3Q,GACL8Z,QAAQC,IAAI/Z,EAAEmb,UAIxB9kB,EAAK+kB,UAAY,WACb/kB,EAAK2e,cAAe,GAGxB3e,EAAKglB,WAAa,WACdhlB,EAAK2e,cAAe,GAGxB3e,EAAKmM,QAAU,SAASqR,EAAKlE,GACzB,SAAMtX,KAAK2K,OAAS6Q,aAAexb,KAAK2K,OAChC3K,KAAKijB,kBAAoBzH,aAAexb,KAAKijB,oBAC7CzH,EAAI0H,YAGP3H,EAAaC,GAGVlE,GACAA,EAASpb,KAAKsf,GAHlBC,EAAaD,EAAKlE,IAMf,IAGXtZ,EAAKqM,OAAS,SAASmR,EAAKpP,GACxB,GAAKmP,EAAaC,GAClB,OAAOA,EAAIK,SAASzP,IAGxBpO,EAAKmlB,WAAa,SAAS3H,EAAKpP,GAC5B,GAAKmP,EAAaC,GAClB,OAAOA,EAAIM,SAAS1P,IAGxBpO,EAAKolB,WAAa,SAAS5H,GACvB,IAAKD,EAAaC,GAAM,MAAO,GAC/B,IAAIvH,EACA0C,EAAO6E,EAAIK,SACXiE,EAAO,GACX,IAAK7L,KAAK0C,EACFA,EAAK/Y,eAAeqW,KACpB6L,EAAK7L,GAAK0C,EAAK1C,IAGvB,OAAO6L,GAGX9hB,EAAKqlB,eAAiB,SAAS7H,GAC3B,IAAKD,EAAaC,GAAM,MAAO,GAC/B,IAAIvH,EACA0C,EAAO6E,EAAIM,SACXgE,EAAO,GACX,IAAK7L,KAAK0C,EACFA,EAAK/Y,eAAeqW,KACpB6L,EAAK7L,GAAK0C,EAAK1C,IAGvB,OAAO6L,GAGX9hB,EAAKslB,OAAS,SAAS9H,GACnB,IAAKD,EAAaC,GAAM,MAAO,GAC/B,IAAIvH,EACA0C,EAAO6E,EAAIK,SACX0H,EAAY,GAChB,IAAKtP,KAAK0C,EACFA,EAAK/Y,eAAeqW,KACE,iBAAX0C,EAAK1C,GACR0C,EAAK1C,aAAcsM,OACnBgD,GAAatP,EAAI,MAAQ0C,EAAK1C,GAAK,KAAO0C,EAAK1C,GAAGiM,UAAY,IAAMvJ,EAAK1C,GAAGkM,YAAc,QAE1FoD,GAAatP,EAAI,OAAS0C,EAAK1C,GAAGhS,OAAS,eAG/CshB,GAAatP,EAAI,MAAQ0C,EAAK1C,GAAK,QAI/C,OAAOsP,GAGXvlB,EAAKwlB,mBAAqB,SAASnM,GAC/B,OAAOuE,EAAevE,SAMrB,KAFqB,EAAF,WAChB,OAAOrZ,GACV,QAFiB,OAEjB,eAEP9B,KAAKkD,O,6BC3hCA,SAAS8V,EAAcH,EAAQzJ,GACpC,OAAO1J,MAAM6hB,QAAQnY,GACjB,CACEyJ,EAAOd,EAAI3I,EAAM,GAAKyJ,EAAO3Y,EAAIkP,EAAM,GAAKyJ,EAAOpN,EACnDoN,EAAOb,EAAI5I,EAAM,GAAKyJ,EAAO1Y,EAAIiP,EAAM,GAAKyJ,EAAOlE,GAErD,CACE3O,EAAG6S,EAAOd,EAAI3I,EAAMpJ,EAAI6S,EAAO3Y,EAAIkP,EAAMnJ,EAAI4S,EAAOpN,EACpDxF,EAAG4S,EAAOb,EAAI5I,EAAMpJ,EAAI6S,EAAO1Y,EAAIiP,EAAMnJ,EAAI4S,EAAOlE,GAUrD,SAAS6S,EAAe3O,EAAQD,GACrC,OAAOA,EAAO6O,IAAIrY,GAAS4J,EAAaH,EAAQzJ,ICnB3C,SAASsY,EAAYnmB,GAC1B,MAAO,CACLwW,EAAGhO,WAAWxI,EAAOwW,GACrBC,EAAGjO,WAAWxI,EAAOyW,GACrB9X,EAAG6J,WAAWxI,EAAOrB,GACrBC,EAAG4J,WAAWxI,EAAOpB,GACrBsL,EAAG1B,WAAWxI,EAAOkK,GACrBkJ,EAAG5K,WAAWxI,EAAOoT,I,o9BCTzB,MAAMgT,EAAc,uIAWb,SAASC,EAAYC,GAC1B,MAAMC,EAASD,EAAOvG,MAAMqG,GAC5B,GAAe,OAAXG,GAAmBA,EAAO/hB,OAAS,EAAG,MAAM,IAAIgiB,MAAM,IAAIF,sBAC9D,MAAO,CACL9P,EAAGhO,WAAW+d,EAAO,IACrB9P,EAAGjO,WAAW+d,EAAO,IACrB5nB,EAAG6J,WAAW+d,EAAO,IACrB3nB,EAAG4J,WAAW+d,EAAO,IACrBrc,EAAG1B,WAAW+d,EAAO,IACrBnT,EAAG5K,WAAW+d,EAAO,KCpBlB,SAASE,IACd,MAAO,CACLjQ,EAAG,EACH7X,EAAG,EACHuL,EAAG,EACHuM,EAAG,EACH7X,EAAG,EACHwU,EAAG,GCNA,SAASsT,EAASpP,GAGvB,MAAM,EAAEd,EAAC,EAAEC,EAAC,EAAE9X,EAAC,EAAEC,EAAC,EAAEsL,EAAC,EAAEkJ,GAAMkE,EAEvBqP,EAAQnQ,EAAI5X,EAAI6X,EAAI9X,EAE1B,MAAO,CACL6X,EAAG5X,EAAI+nB,EACPlQ,EAAGA,GAAKkQ,EACRhoB,EAAGA,GAAKgoB,EACR/nB,EAAG4X,EAAImQ,EACPzc,GAAItL,EAAIsL,EAAIvL,EAAIyU,IAAMuT,EACtBvT,GAAIqD,EAAIvM,EAAIsM,EAAIpD,GAAKuT,GClBlB,SAASC,EAAapE,GAC3B,YAAsB,IAARA,EAGT,SAASqE,EAAW9mB,GACzB,MAAoB,iBAANA,IACX+iB,OAAO/d,MAAMhF,IACd+iB,OAAOgE,SAAS/mB,GCCb,SAASgnB,EAAgB/mB,GAC9B,MDEsB,iBADE6a,ECDR7a,IDGN,OAAR6a,IACC1W,MAAM6hB,QAAQnL,ICHf,MAAO7a,GACP6mB,EAAU7mB,EAAOwW,IACjB,MAAOxW,GACP6mB,EAAU7mB,EAAOyW,IACjB,MAAOzW,GACP6mB,EAAU7mB,EAAOrB,IACjB,MAAOqB,GACP6mB,EAAU7mB,EAAOpB,IACjB,MAAOoB,GACP6mB,EAAU7mB,EAAOkK,IACjB,MAAOlK,GACP6mB,EAAU7mB,EAAOoT,GDXd,IAAmByH,EEJnB,SAAS7L,EAAWgY,EAAIC,EAAK,GAClC,MAAO,CACLzQ,EAAG,EACH7X,EAAG,EACHuL,EAAG8c,EACHvQ,EAAG,EACH7X,EAAG,EACHwU,EAAG6T,GCRA,SAASre,KAAcse,GAG5B,MAAMC,EAAW,CAACC,EAAIC,KACb,CACL7Q,EAAG4Q,EAAG5Q,EAAI6Q,EAAG7Q,EAAI4Q,EAAGzoB,EAAI0oB,EAAG5Q,EAC3B9X,EAAGyoB,EAAG5Q,EAAI6Q,EAAG1oB,EAAIyoB,EAAGzoB,EAAI0oB,EAAGzoB,EAC3BsL,EAAGkd,EAAG5Q,EAAI6Q,EAAGnd,EAAIkd,EAAGzoB,EAAI0oB,EAAGjU,EAAIgU,EAAGld,EAClCuM,EAAG2Q,EAAG3Q,EAAI4Q,EAAG7Q,EAAI4Q,EAAGxoB,EAAIyoB,EAAG5Q,EAC3B7X,EAAGwoB,EAAG3Q,EAAI4Q,EAAG1oB,EAAIyoB,EAAGxoB,EAAIyoB,EAAGzoB,EAC3BwU,EAAGgU,EAAG3Q,EAAI4Q,EAAGnd,EAAIkd,EAAGxoB,EAAIyoB,EAAGjU,EAAIgU,EAAGhU,IAItC,QAbA8T,EAAW/iB,MAAM6hB,QAAQkB,EAAS,IAAMA,EAAS,GAAKA,GAarC1iB,QACf,KAAK,EACH,MAAM,IAAIgiB,MAAM,wBAElB,KAAK,EACH,OAAOU,EAAS,GAElB,KAAK,EACH,OAAOC,EAASD,EAAS,GAAIA,EAAS,IAExC,QAAS,CACP,MAAOE,EAAIC,KAAOC,GAAQJ,EAE1B,OAAOte,EADGue,EAASC,EAAIC,MACAC,KAUtB,SAASvP,KAAYmP,GAC1B,OAAOte,KAAase,GCvCtB,MAAM,IAAE/V,EAAG,IAAEC,EAAG,GAAEH,GAAOrM,KAQlB,SAAS4M,EAAQ9I,EAAO6e,EAAIC,GACjC,MAAMC,EAAWtW,EAAIzI,GACfgf,EAAWtW,EAAI1I,GACfif,EAAiB,CACrBnR,EAAGiR,EACH9oB,GAAI+oB,EACJxd,EAAG,EACHuM,EAAGiR,EACH9oB,EAAG6oB,EACHrU,EAAG,GAEL,OAAIwT,EAAYW,IAAOX,EAAYY,GAC1BG,EAGF/e,EAAU,CACfoG,EAAUuY,EAAIC,GACdG,EACA3Y,GAAWuY,GAAKC,KAWb,SAASI,EAAWlf,EAAO6e,EAAgBC,GAChD,OAAOhW,EAAO9I,EAAQuI,EAAK,IAAKsW,EAAIC,GC9B/B,SAASjX,EAAOsX,EAAIC,EAAgBP,EAAgBC,GACrDZ,EAAYkB,KAAKA,EAAKD,GAE1B,MAAME,EAAc,CAClBvR,EAAGqR,EACHlpB,EAAG,EACHuL,EAAG,EACHuM,EAAG,EACH7X,EAAGkpB,EACH1U,EAAG,GAGL,OAAIwT,EAAYW,IAAOX,EAAYY,GAC1BO,EAGFnf,EAAU,CACfoG,EAAUuY,EAAIC,GACdO,EACA/Y,GAAWuY,GAAKC,KCzBb,SAASQ,EAAOC,EAAKC,GAC1B,MAAO,CACL1R,EAAG,EACH7X,EAAGspB,EACH/d,EAAG,EACHuM,EAAGyR,EACHtpB,EAAG,EACHwU,EAAG,GCZP,MAAM,IAAE+U,GAAQvjB,KAQT,SAASwjB,EAAMC,EAAIC,GACxB,MAAO,CACL9R,EAAG,EACH7X,EAAGwpB,EAAIE,GACPne,EAAG,EACHuM,EAAG0R,EAAIG,GACP1pB,EAAG,EACHwU,EAAG,GAUA,SAASmV,EAASF,EAAIC,GAC3B,OAAOF,EAAKC,EAAKzjB,KAAKqM,GAAK,IAAKqX,EAAK1jB,KAAKqM,GAAK,KCtB1C,SAASuX,EAAOlR,GACrB,OAAO,EAASA,GAQX,SAASmR,EAAOnR,GACrB,OAAO,EAASA,GAQX,SAAS,EAAUA,GACxB,MAAO,UAAUA,EAAOd,KAAKc,EAAOb,KAAKa,EAAO3Y,KAAK2Y,EAAO1Y,KAAK0Y,EAAOpN,KAAKoN,EAAOlE,KClB/E,SAASsV,EAAcpR,EAAQqR,EAAY,MAChD,MAAO,CACLnS,EAAG5R,KAAK4T,MAAMlB,EAAOd,EAAImS,GAAaA,EACtClS,EAAG7R,KAAK4T,MAAMlB,EAAOb,EAAIkS,GAAaA,EACtChqB,EAAGiG,KAAK4T,MAAMlB,EAAO3Y,EAAIgqB,GAAaA,EACtC/pB,EAAGgG,KAAK4T,MAAMlB,EAAO1Y,EAAI+pB,GAAaA,EACtCze,EAAGtF,KAAK4T,MAAMlB,EAAOpN,EAAIye,GAAaA,EACtCvV,EAAGxO,KAAK4T,MAAMlB,EAAOlE,EAAIuV,GAAaA,GCFnC,SAASC,EAAeC,EAAIC,GAEjC,MAAMC,EAAiB,MAAXF,EAAG,GAAGpkB,EAAYokB,EAAG,GAAGpkB,EAAIokB,EAAG,GAAG,GACxCG,EAAiB,MAAXH,EAAG,GAAGnkB,EAAYmkB,EAAG,GAAGnkB,EAAImkB,EAAG,GAAG,GACxCI,EAAiB,MAAXH,EAAG,GAAGrkB,EAAYqkB,EAAG,GAAGrkB,EAAIqkB,EAAG,GAAG,GACxCI,EAAiB,MAAXJ,EAAG,GAAGpkB,EAAYokB,EAAG,GAAGpkB,EAAIokB,EAAG,GAAG,GAGxCK,EAAiB,MAAXN,EAAG,GAAGpkB,EAAYokB,EAAG,GAAGpkB,EAAIokB,EAAG,GAAG,GACxCO,EAAiB,MAAXP,EAAG,GAAGnkB,EAAYmkB,EAAG,GAAGnkB,EAAImkB,EAAG,GAAG,GACxCQ,EAAiB,MAAXP,EAAG,GAAGrkB,EAAYqkB,EAAG,GAAGrkB,EAAIqkB,EAAG,GAAG,GACxCQ,EAAiB,MAAXR,EAAG,GAAGpkB,EAAYokB,EAAG,GAAGpkB,EAAIokB,EAAG,GAAG,GAGxCS,EAAiB,MAAXV,EAAG,GAAGpkB,EAAYokB,EAAG,GAAGpkB,EAAIokB,EAAG,GAAG,GACxCW,EAAiB,MAAXX,EAAG,GAAGnkB,EAAYmkB,EAAG,GAAGnkB,EAAImkB,EAAG,GAAG,GACxCY,EAAiB,MAAXX,EAAG,GAAGrkB,EAAYqkB,EAAG,GAAGrkB,EAAIqkB,EAAG,GAAG,GACxCY,EAAiB,MAAXZ,EAAG,GAAGpkB,EAAYokB,EAAG,GAAGpkB,EAAIokB,EAAG,GAAG,GAuB9C,OAAOJ,EAHc9f,EAAU,CAVpB,CACT4N,EAAGyS,EAAMQ,EACThT,EAAGyS,EAAMQ,EACT/qB,EAAG0qB,EAAMI,EACT7qB,EAAG0qB,EAAMI,EACTxf,EAAGuf,EACHrW,EAAGsW,GAGahD,EAjBP,CACTlQ,EAAGuS,EAAMQ,EACT9S,EAAGuS,EAAMQ,EACT7qB,EAAGwqB,EAAMI,EACT3qB,EAAGwqB,EAAMI,EACTtf,EAAGqf,EACHnW,EAAGoW,OCHA,SAASG,EAAgBC,GAC9B,OAAOzlB,MAAM6hB,QAAQ4D,GACjBA,EAA8B1D,IAAI2D,GAClCA,EAAOD,GAEX,SAASC,EAAQC,GACf,OAAQA,EAAW9c,MACjB,IAAK,SACH,GAAI,MAAO8c,GACT,MAAOA,GACP,MAAOA,GACP,MAAOA,GACP,MAAOA,GACP,MAAOA,EAEP,OAAO3D,EAAW2D,GAElB,MAAM,IAAItD,MAAM,2BAGpB,IAAK,YACH,KAAM,OAAQsD,GAAa,MAAM,IAAItD,MAAM,2BAE3C,MAAI,OAAQsD,EAAmB9a,EAAU8a,EAAW9C,GAAI8C,EAAW7C,IAE5DjY,EAAU8a,EAAW9C,IAE9B,IAAK,QACH,KAAM,OAAQ8C,GAAa,MAAM,IAAItD,MAAM,2BAE3C,MAAI,OAAQsD,EAAmBvZ,EAAMuZ,EAAWjC,GAAIiC,EAAWhC,IAExDvX,EAAMuZ,EAAWjC,IAE1B,IAAK,SACH,KAAM,UAAWiC,GAAa,MAAM,IAAItD,MAAM,2BAE9C,MAAI,OAAQsD,GAAc,OAAQA,EACzBlC,EAAUkC,EAAWphB,MAAOohB,EAAWvC,GAAIuC,EAAWtC,IAExDI,EAAUkC,EAAWphB,OAE9B,IAAK,QACH,KAAM,UAAWohB,GAAa,MAAM,IAAItD,MAAM,2BAC9C,OAAO+B,EAAQuB,EAAWphB,MAAO,GAEnC,IAAK,QACH,KAAM,UAAWohB,GAAa,MAAM,IAAItD,MAAM,2BAC9C,OAAO+B,EAAQ,EAAGuB,EAAWphB,OAE/B,IAAK,QACH,KAAM,QAASohB,MAAc,QAASA,GAAa,MAAM,IAAItD,MAAM,2BACnE,OAAOwB,EAAM8B,EAAW7B,IAAK6B,EAAW5B,KAE1C,QACE,MAAM,IAAI1B,MAAM,4BChFxB,SAASuD,EAAgB1E,EAAS2E,EAAUC,EAAOC,GACjDvoB,KAAK0jB,QAAUA,EACf1jB,KAAKqoB,SAAWA,EAChBroB,KAAKsoB,MAAQA,EACbtoB,KAAKuoB,SAAWA,EAChBvoB,KAAK9C,KAAO,cAG2B,mBAA5B2nB,MAAM2D,mBACf3D,MAAM2D,kBAAkBxoB,KAAMooB,GA8GlC,SAASK,EAAUC,EAAO5nB,GACxBA,OAAsBtB,IAAZsB,EAAwBA,EAAU,GAE5C,IAkFI6nB,EAlFAC,EAAa,GAEbC,EAAyB,CAAEC,cAAeC,GAC1CC,EAAwBD,EAaxBE,EAAS,QACTC,EAAS,SACTC,EAAS,SACTC,EAAS,aAETC,EAASC,EAAuB,UAAU,GAC1CC,EAASD,EAAuB,KAAK,GACrCE,EAASF,EAAuB,KAAK,GACrCG,EAASH,EAAuB,aAAa,GAC7CI,EAASJ,EAAuB,SAAS,GACzCK,EAASL,EAAuB,UAAU,GAC1CM,EAASN,EAAuB,SAAS,GACzCO,EAASP,EAAuB,SAAS,GACzCQ,EAASR,EAAuB,KAAK,GACrCS,EAASC,EAAqB,sBAC9BC,EAAUC,EAAqB,CAAC,IAAK,MAAM,GAAO,GAClDC,EAAUD,EAAqB,CAAC,IAAK,MAAM,GAAO,GAClDE,EAAUF,EAAqB,CAAC,CAAC,IAAK,OAAO,GAAO,GACpDG,EAAUH,EAAqB,CAAC,IAAK,KAAM,KAAM,OAAO,GAAO,GA0C/DI,EAAc,EAEdC,EAAsB,CAAC,CAAE3T,KAAM,EAAG4T,OAAQ,IAC1CC,EAAe,GACfC,EAAkB,EAItB,GAAI,cAAe5pB,EAAS,CAC1B,KAAMA,EAAQ6pB,aAAa9B,GACzB,MAAM,IAAIhE,MAAM,mCAAqC/jB,EAAQ6pB,UAAY,MAG3E3B,EAAwBH,EAAuB/nB,EAAQ6pB,WAuCzD,SAASrB,EAAuBsB,EAAMC,GACpC,MAAO,CAAExf,KAAM,UAAWuf,KAAMA,EAAMC,WAAYA,GAGpD,SAASX,EAAqBY,EAAOC,EAAUF,GAC7C,MAAO,CAAExf,KAAM,QAASyf,MAAOA,EAAOC,SAAUA,EAAUF,WAAYA,GAWxE,SAASb,EAAqBgB,GAC5B,MAAO,CAAE3f,KAAM,QAAS2f,YAAaA,GAGvC,SAASC,EAAsBC,GAC7B,IACIzsB,EADA0sB,EAAUZ,EAAoBW,GAGlC,GAAIC,EACF,OAAOA,EAGP,IADA1sB,EAAIysB,EAAM,GACFX,EAAoB9rB,IAC1BA,IASF,IALA0sB,EAAU,CACRvU,MAFFuU,EAAUZ,EAAoB9rB,IAEdmY,KACd4T,OAAQW,EAAQX,QAGX/rB,EAAIysB,GACmB,KAAxBxC,EAAM/J,WAAWlgB,IACnB0sB,EAAQvU,OACRuU,EAAQX,OAAS,GAEjBW,EAAQX,SAGV/rB,IAKF,OAFA8rB,EAAoBW,GAAOC,EAEpBA,EAIX,IAAIC,EAAgD,iBAArBtqB,EAAQuqB,UAAyBvqB,EAAQuqB,SAASxoB,OAAS,EAC1F,SAASyoB,EAAoB7e,EAAU8e,GACrC,IAAIC,EAAM,GAELJ,IAAoBI,EAAIH,SAAWvqB,EAAQuqB,UAEhD,IAAII,EAAkBR,EAAsBxe,GAC5C+e,EAAI5iB,MAAQ,CACVkU,OAAQrQ,EACRmK,KAAM6U,EAAgB7U,KACtB4T,OAAQiB,EAAgBjB,QAG1B,IAAIkB,EAAgBT,EAAsBM,GAO1C,OANAC,EAAI1iB,IAAM,CACRgU,OAAQyO,EACR3U,KAAM8U,EAAc9U,KACpB4T,OAAQkB,EAAclB,QAGjBgB,EAOT,SAASG,EAAWtD,GAClB,IAAI9gB,EAAMkjB,EAAaA,EAAa5nB,OAAS,GAEzCynB,EAAc/iB,EAAI2jB,MAElBZ,EAAc/iB,EAAI2jB,MACpB3jB,EAAI2jB,IAAMZ,EACV/iB,EAAIqkB,SAAW,IAGjBrkB,EAAIqkB,SAAS7c,KAAKsZ,IAuBpB,SAASwD,EAAyBxD,EAAUC,EAAOC,GACjD,OAAO,IAAIH,EACTA,EAAgB0D,aAAazD,EAAUC,EAAOC,GAC9CF,EACAC,EACAC,GAiBJ,SAASQ,IACP,IAAIgD,EAAIC,EAAIC,EAAIC,EAAIC,EASpB,IAHAJ,EAAKzB,EACL0B,EAAK,GACLC,EAAKG,IACEH,IAAOrD,GACZoD,EAAGjd,KAAKkd,GACRA,EAAKG,IAQP,KANAH,EAgBF,SAASI,IACP,IAAIN,EAAIC,EAAIC,EAAIC,EAQhB,GAFAH,EAAKzB,GACL0B,EAAKM,OACM1D,EAAY,CAGrB,GAFAqD,EAAK,IACLC,EAAKK,OACM3D,EACT,KAAOsD,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKK,SAGPN,EAAKrD,EAEHqD,IAAOrD,IACTsD,EAAKG,OACMzD,GACMmD,EAzRES,EA0RDN,EAAhBH,EAAYC,EA1RoBS,OAAOD,KAgSzClC,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,EArSI,IAAY4D,EAuSnBT,IAAOnD,IACTmD,EAAKO,KAGP,OAAOP,EAzDFM,MACMzD,IACTqD,EAAK,MAEPC,EAAK,GACLC,EAAKC,IACED,IAAOvD,GACZsD,EAAGnd,KAAKod,GACRA,EAAKC,IAKP,OAHeL,EACfA,EAAYE,EAiDd,SAASK,IACP,IAAIP,EAuBJ,OAjBAA,EAoBF,WACE,IAAIA,EAAIC,EAAIC,EAAIC,EAAIC,EAAIO,EAAQC,EAAQC,EAASC,EAAUC,EAAUC,EAAKC,EAAKC,EAE3EC,EAAe,SAAU7E,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC0D,EAAKzB,EACL4C,EAAa7D,GAjXF,WAkXPX,EAAMyE,OAAO7C,EAAa,IAC5B0B,EAnXS,SAoXT1B,GAAe,GAEf0B,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IASP,GAPAc,EAAa3D,GACyB,KAAlCb,EAAM/J,WAAW2L,IACnB4B,EAhYO,IAiYP5B,KAEA4B,EAAKtD,EAEHsD,IAAOtD,EAAY,CAGrB,IAFAuD,EAAK,GACLO,EAAKN,IACEM,IAAO9D,GACZuD,EAAGpd,KAAK2d,GACRA,EAAKN,IAGP,IADAM,EAAKU,OACMxE,EAET,GADK2D,MACM3D,EAET,IADA+D,EAAKS,OACMxE,EAET,GADK2D,MACM3D,EAET,IADAgE,EAAKQ,OACMxE,EAET,GADM2D,MACM3D,EAEV,IADAiE,EAAMO,OACMxE,EAEV,GADM2D,MACM3D,EAEV,IADAkE,EAAMM,OACMxE,EAEV,GADM2D,MACM3D,EAEV,IADAmE,EAAMK,OACMxE,EAAY,CAGtB,IAFAoE,EAAM,GACNC,EAAMb,IACCa,IAAQrE,GACboE,EAAIje,KAAKke,GACTA,EAAMb,IAERc,EAAa1D,GACyB,KAAlCd,EAAM/J,WAAW2L,IACnB2C,EAzajB,IA0aiB3C,KAEA2C,EAAMrE,EAEJqE,IAAQrE,GACKmD,EACfA,EAhZjB,CAAC,CAAC1gB,KAAM,SAAUwJ,EAgZW6X,EAhZL5X,EAgZS6X,EAhZH3vB,EAgZO4vB,EAhZD3vB,EAgZK4vB,EAhZCtkB,EAgZIukB,EAhZErb,EAgZGsb,MAElCzC,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,EAGP,OAAOmD,EAvJFsB,MACMzE,IACTmD,EAwJJ,WACE,IAAIA,EAAIC,EAAIC,EAAIC,EAAIC,EAAIO,EAAIY,EAAIX,EAAIY,EAEhCL,EAAe,SAAU7E,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC0D,EAAKzB,EACL4C,EAAazD,GApfF,cAqfPf,EAAMyE,OAAO7C,EAAa,IAC5B0B,EAtfS,YAufT1B,GAAe,GAEf0B,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IASP,GAPAc,EAAa3D,GACyB,KAAlCb,EAAM/J,WAAW2L,IACnB4B,EAtgBO,IAugBP5B,KAEA4B,EAAKtD,EAEHsD,IAAOtD,EAAY,CAGrB,IAFAuD,EAAK,GACLO,EAAKN,IACEM,IAAO9D,GACZuD,EAAGpd,KAAK2d,GACRA,EAAKN,IAGP,IADAM,EAAKU,OACMxE,EAAY,CAOrB,KANA0E,EAAKE,OACM5E,IACT0E,EAAK,MAEPX,EAAK,GACLY,EAAKnB,IACEmB,IAAO3E,GACZ+D,EAAG5d,KAAKwe,GACRA,EAAKnB,IAEPc,EAAa1D,GACyB,KAAlCd,EAAM/J,WAAW2L,IACnBiD,EA/hBG,IAgiBHjD,KAEAiD,EAAK3E,EAEH2E,IAAO3E,GACMmD,EAlgBfluB,EAAI,CAACwN,KAAM,YAAaga,GAmgBZqH,IApgBIpH,EAogBAgI,KAlgBZzvB,EAAEynB,GAAKA,GAkgBXyG,EAjgBG,CAACluB,KAmgBJysB,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,EAnhBI,IAAatD,EAChBznB,EAqhBR,OAAOkuB,EAnOA0B,MACM7E,IACTmD,EAoON,WACE,IAAIA,EAAIC,EAAIC,EAAIC,EAAIC,EAAIO,EAAIY,EAAIX,EAAIY,EAEhCL,EAAe,SAAU7E,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC0D,EAAKzB,EACL4C,EAAaxD,GAjkBF,UAkkBPhB,EAAMyE,OAAO7C,EAAa,IAC5B0B,EAnkBS,QAokBT1B,GAAe,GAEf0B,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IASP,GAPAc,EAAa3D,GACyB,KAAlCb,EAAM/J,WAAW2L,IACnB4B,EAplBO,IAqlBP5B,KAEA4B,EAAKtD,EAEHsD,IAAOtD,EAAY,CAGrB,IAFAuD,EAAK,GACLO,EAAKN,IACEM,IAAO9D,GACZuD,EAAGpd,KAAK2d,GACRA,EAAKN,IAGP,IADAM,EAAKU,OACMxE,EAAY,CAOrB,KANA0E,EAAKE,OACM5E,IACT0E,EAAK,MAEPX,EAAK,GACLY,EAAKnB,IACEmB,IAAO3E,GACZ+D,EAAG5d,KAAKwe,GACRA,EAAKnB,IAEPc,EAAa1D,GACyB,KAAlCd,EAAM/J,WAAW2L,IACnBiD,EA7mBG,IA8mBHjD,KAEAiD,EAAK3E,EAEH2E,IAAO3E,GACMmD,EA3kBfrtB,EAAI,CAAC2M,KAAK,QAAS6a,GA4kBPwG,IA7kBIvG,EA6kBAmH,KA3kBZ5uB,EAAEynB,GAAKA,GA2kBX4F,EA1kBG,CAACrtB,KA4kBJ4rB,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,EA5lBI,IAAazC,EAChBznB,EA8lBR,OAAOqtB,EA/SE2B,MACM9E,IACTmD,EAgTR,WACE,IAAIA,EAAIC,EAAIC,EAAIC,EAAIC,EAAIO,EAAIY,EAAIX,EAAIY,EAEhCL,EAAe,SAAU7E,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC0D,EAAKzB,EACL4C,EAAavD,GA9oBF,WA+oBPjB,EAAMyE,OAAO7C,EAAa,IAC5B0B,EAhpBS,SAipBT1B,GAAe,GAEf0B,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IASP,GAPAc,EAAa3D,GACyB,KAAlCb,EAAM/J,WAAW2L,IACnB4B,EAlqBO,IAmqBP5B,KAEA4B,EAAKtD,EAEHsD,IAAOtD,EAAY,CAGrB,IAFAuD,EAAK,GACLO,EAAKN,IACEM,IAAO9D,GACZuD,EAAGpd,KAAK2d,GACRA,EAAKN,IAGP,IADAM,EAAKU,OACMxE,EAAY,CAOrB,KANA0E,EAyQR,WACE,IAAIvB,EAAQE,EAAQE,EAMpBJ,EAAKzB,EACAiC,MACM3D,IACTqD,EAAKmB,OACMxE,GACJ2D,MACM3D,IACTuD,EAAKiB,OACMxE,GACMmD,EACfA,EA54B8B,CA44BjBE,EAAIE,KAcvB7B,EAAcyB,EACdA,EAAKnD,GAGP,OAAOmD,EA5SI4B,MACM/E,IACT0E,EAAK,MAEPX,EAAK,GACLY,EAAKnB,IACEmB,IAAO3E,GACZ+D,EAAG5d,KAAKwe,GACRA,EAAKnB,IAEPc,EAAa1D,GACyB,KAAlCd,EAAM/J,WAAW2L,IACnBiD,EA3rBG,IA4rBHjD,KAEAiD,EAAK3E,EAEH2E,IAAO3E,GACMmD,EAppBftuB,EAAI,CAAC4N,KAAK,SAAUtE,MAqpBR2lB,IAtpBO1vB,EAspBHswB,KAnpBlB7vB,EAAEmoB,GAAK5oB,EAAE,GACTS,EAAEooB,GAAK7oB,EAAE,IAkpBP+uB,EAhpBG,CAACtuB,KAkpBJ6sB,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,EArqBI,IAAgB5rB,EACnBS,EAuqBR,OAAOsuB,EA3XI6B,MACMhF,IACTmD,EA4XV,WACE,IAAIA,EAAIC,EAAIC,EAAIC,EAAIC,EAAIO,EAAIY,EAAIX,EAE5BO,EAAe,SAAU7E,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC0D,EAAKzB,EACL4C,EAAatD,GA3tBF,UA4tBPlB,EAAMyE,OAAO7C,EAAa,IAC5B0B,EA7tBS,QA8tBT1B,GAAe,GAEf0B,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IASP,GAPAc,EAAa3D,GACyB,KAAlCb,EAAM/J,WAAW2L,IACnB4B,EAhvBO,IAivBP5B,KAEA4B,EAAKtD,EAEHsD,IAAOtD,EAAY,CAGrB,IAFAuD,EAAK,GACLO,EAAKN,IACEM,IAAO9D,GACZuD,EAAGpd,KAAK2d,GACRA,EAAKN,IAGP,IADAM,EAAKU,OACMxE,EAAY,CAGrB,IAFA0E,EAAK,GACLX,EAAKP,IACEO,IAAO/D,GACZ0E,EAAGve,KAAK4d,GACRA,EAAKP,IAEPc,EAAa1D,GACyB,KAAlCd,EAAM/J,WAAW2L,IACnBqC,EArwBG,IAswBHrC,KAEAqC,EAAK/D,EAEH+D,IAAO/D,GACMmD,EACfA,EAvtBG,CAAC,CAAC1gB,KAAM,QAAStE,MAutBR2lB,MAEZpC,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,EAGP,OAAOmD,EAncM8B,MACMjF,IACTmD,EAocZ,WACE,IAAIA,EAAIC,EAAIC,EAAIC,EAAIC,EAAIO,EAAIY,EAAIX,EAE5BO,EAAe,SAAU7E,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC0D,EAAKzB,EACL4C,EAAarD,GApyBF,UAqyBPnB,EAAMyE,OAAO7C,EAAa,IAC5B0B,EAtyBS,QAuyBT1B,GAAe,GAEf0B,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IASP,GAPAc,EAAa3D,GACyB,KAAlCb,EAAM/J,WAAW2L,IACnB4B,EA1zBO,IA2zBP5B,KAEA4B,EAAKtD,EAEHsD,IAAOtD,EAAY,CAGrB,IAFAuD,EAAK,GACLO,EAAKN,IACEM,IAAO9D,GACZuD,EAAGpd,KAAK2d,GACRA,EAAKN,IAGP,IADAM,EAAKU,OACMxE,EAAY,CAGrB,IAFA0E,EAAK,GACLX,EAAKP,IACEO,IAAO/D,GACZ0E,EAAGve,KAAK4d,GACRA,EAAKP,IAEPc,EAAa1D,GACyB,KAAlCd,EAAM/J,WAAW2L,IACnBqC,EA/0BG,IAg1BHrC,KAEAqC,EAAK/D,EAEH+D,IAAO/D,GACMmD,EACfA,EA9xBG,CAAC,CAAC1gB,KAAM,QAAStE,MA8xBR2lB,MAEZpC,EAAcyB,EACdA,EAAKnD,QAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,OAGP0B,EAAcyB,EACdA,EAAKnD,EAGP,OAAOmD,EA3gBQ+B,IAOR/B,EAugBT,SAASqB,IACP,IAAIrB,EAAIC,EAAIC,EAAIC,EA+ChB,OAzCAH,EAAKzB,EACL0B,EAAK1B,GACL2B,EAAK8B,OACMnF,IACTqD,EAAK,OAEPC,EAkMF,WACE,IAAIH,EAAIC,EAAIC,EAMZF,EAAKzB,GACL0B,EAiCF,WACE,IAAID,EAAIC,EAAIC,EAAIC,GAEG,SAAU7D,GACH,IAApBqC,GAAuBiB,EAAWtD,IAGxC6E,CAAanD,GACbW,IACAqB,EAAKzB,GACL0B,EAAKgC,OACMpF,IACToD,EAAK,MAE+B,KAAlCtD,EAAM/J,WAAW2L,IACnB2B,EA3mCS,IA4mCT3B,KAEA2B,EAAKrD,EAEHqD,IAAOrD,IACTsD,EAAK8B,OACMpF,GACMmD,EAzjCMkC,EA0jCJ/B,EAAjBH,EA1jCkC,EAAjBmC,EA0jCJlC,GA1jC2BkC,EAAGC,KAAK,IAAM,KAAM,IAAKF,EAAGE,KAAK,KAAKA,KAAK,MAgkCrF7D,EAAcyB,EACdA,EAAKnD,GAjkCK,IAASsF,EAAID,EAmkCrBlC,IAAOnD,IACTmD,EAAKzB,GACL0B,EAAKgC,OACMpF,GAC6B,KAAlCF,EAAM/J,WAAW2L,IACnB2B,EAloCK,IAmoCL3B,KAEA2B,EAAKrD,EAEHqD,IAAOrD,GACMmD,EACfA,EAAaC,EA9kCgBmC,KAAK,MAglClC7D,EAAcyB,EACdA,EAAKnD,KAGP0B,EAAcyB,EACdA,EAAKnD,IAKT,OAFA8B,IAEOqB,EA1FFqC,MACMxF,IACTqD,EAAKoC,OACMzF,IACTqD,EAAK,MAEQF,EACfA,EA1gCkC,CA0gCrBC,EAAIC,GA1gC0B,MAAMkC,KAAK,MA4gCtD7D,EAAcyB,EACdA,EAAKnD,GAEHmD,IAAOnD,IACTmD,EAAKzB,GACL0B,EAAKgC,OACMpF,IACTqD,EAAKoC,OACMzF,GACMmD,EACfA,EArhCM,SAAS9uB,EAAGsL,GAAK,MAAO,CAACtL,EAAGsL,GAAG4lB,KAAK,IAqhCrCG,CAAQtC,EAAIC,KAMnB3B,EAAcyB,EACdA,EAAKnD,IAIT,OAAOmD,EAxOFwC,MACM3F,EAEToD,EADAC,EAAK,CAACA,EAAIC,IAGV5B,EAAc0B,EACdA,EAAKpD,GAEHoD,IAAOpD,IACMmD,EACfC,EAx0B8BnlB,WAw0BlBmlB,EAx0B+BmC,KAAK,OA00BlDpC,EAAKC,KACMpD,IACTmD,EAAKzB,EACL0B,EAAK1B,GACL2B,EAAK8B,OACMnF,IACTqD,EAAK,OAEPC,EA4JJ,WACE,IAAIH,EAAIC,EAMRD,EAAKzB,GACL0B,EAAKgC,OACMpF,IACMmD,EACfC,EAAaA,EAr/BsBmC,KAAK,KAy/B1C,OAFApC,EAAKC,EAzKEwC,MACM5F,EAEToD,EADAC,EAAK,CAACA,EAAIC,IAGV5B,EAAc0B,EACdA,EAAKpD,GAEHoD,IAAOpD,IACMmD,EACfC,EA31B4B5lB,SA21BhB4lB,EA31B2BmC,KAAK,MA61B9CpC,EAAKC,GAGAD,EAGT,SAASyB,IACP,IAAIzB,EAAQE,EAsBZ,OAhBAF,EAAKzB,EACAiC,MACM3D,IACTqD,EAAKmB,OACMxE,GACMmD,EACfA,EAAaE,IAMf3B,EAAcyB,EACdA,EAAKnD,GAGAmD,EAyCT,SAASQ,IACP,IAAIR,EAAIC,EAAIC,EAAIC,EAAIC,EASpB,GAHAJ,EAAKzB,EACL0B,EAAK,IACLC,EAAKG,OACMxD,EACT,KAAOqD,IAAOrD,GACZoD,EAAGjd,KAAKkd,GACRA,EAAKG,SAGPJ,EAAKpD,EAEP,GAAIoD,IAAOpD,EAAY,CAOrB,KANAqD,EAAKwC,OACM7F,IACTqD,EAAK,MAEPC,EAAK,GACLC,EAAKC,IACED,IAAOvD,GACZsD,EAAGnd,KAAKod,GACRA,EAAKC,IAGPL,EADAC,EAAK,CAACA,EAAIC,EAAIC,QAGd5B,EAAcyB,EACdA,EAAKnD,EAEP,GAAImD,IAAOnD,EAGT,GAFAmD,EAAKzB,GACL0B,EAAKyC,OACM7F,EAAY,CAGrB,IAFAqD,EAAK,GACLC,EAAKE,IACEF,IAAOtD,GACZqD,EAAGld,KAAKmd,GACRA,EAAKE,IAGPL,EADAC,EAAK,CAACA,EAAIC,QAGV3B,EAAcyB,EACdA,EAAKnD,EAIT,OAAOmD,EAGT,SAAS0C,IACP,IAAI1C,EAcJ,OAZmB,SAAU1D,GACH,IAApBqC,GAAuBiB,EAAWtD,GAGxC6E,CAAapD,GACyB,KAAlCpB,EAAM/J,WAAW2L,IACnByB,EAzhCS,IA0hCTzB,KAEAyB,EAAKnD,EAGAmD,EA0HT,SAASsC,IACP,IAAItC,EAAIC,EAAIC,EAAIC,EAgChB,OA1BAH,EAAKzB,EAJc,SAAUjC,GACH,IAApBqC,GAAuBiB,EAAWtD,GAIxC6E,CAAajD,GACThB,EAAOjQ,KAAK0P,EAAM5P,OAAOwR,KAC3B0B,EAAKtD,EAAM5P,OAAOwR,GAClBA,KAEA0B,EAAKpD,EAEHoD,IAAOpD,IACTqD,EAAK8B,OACMnF,IACTqD,EAAK,OAEPC,EAAK8B,OACMpF,GACMmD,EACfA,EAnnCgC,CAAC,IAmnCpBE,EAAIC,EAnnC0BiC,KAAK,KAAKA,KAAK,MAqnC1D7D,EAAcyB,EACdA,EAAKnD,KAGP0B,EAAcyB,EACdA,EAAKnD,GAGAmD,EAGT,SAASgC,IACP,IAAIhC,EAcJ,OAZmB,SAAU1D,GACH,IAApBqC,GAAuBiB,EAAWtD,GAGxC6E,CAAa/C,GACTjB,EAAOlQ,KAAK0P,EAAM5P,OAAOwR,KAC3ByB,EAAKrD,EAAM5P,OAAOwR,GAClBA,KAEAyB,EAAKnD,EAGAmD,EAGT,SAASiC,IACP,IAAIjC,EAAIC,EAQR,GAFAD,EAAK,IACLC,EAAK0C,OACM9F,EACT,KAAOoD,IAAOpD,GACZmD,EAAGhd,KAAKid,GACRA,EAAK0C,SAGP3C,EAAKnD,EAGP,OAAOmD,EAGT,SAAS2C,IACP,IAAI3C,EAcJ,OAZmB,SAAU1D,GACH,IAApBqC,GAAuBiB,EAAWtD,GAGxC6E,CAAa9C,GACTjB,EAAOnQ,KAAK0P,EAAM5P,OAAOwR,KAC3ByB,EAAKrD,EAAM5P,OAAOwR,GAClBA,KAEAyB,EAAKnD,EAGAmD,EAGT,SAASK,IACP,IAAIL,EAcJ,OAZmB,SAAU1D,GACH,IAApBqC,GAAuBiB,EAAWtD,GAGxC6E,CAAa7C,GACTjB,EAAOpQ,KAAK0P,EAAM5P,OAAOwR,KAC3ByB,EAAKrD,EAAM5P,OAAOwR,GAClBA,KAEAyB,EAAKnD,EAGAmD,EAMT,GAzkCEtB,EAAa1b,KAAK,CAAEmc,IAAKZ,EAAasB,SAAU,MAukClDjD,EAAaK,OAEMJ,GAAc0B,IAAgB5B,EAAM7lB,OACrD,OAAO8lB,EAMP,MAJIA,IAAeC,GAAc0B,EAAc5B,EAAM7lB,QACnD8oB,EA/oCK,CAAEtgB,KAAM,QA+GjB,WACE,IAAIgd,EAAWoC,EAAa,GACxBkE,EAAUtG,EAAS6C,IAEvB,OAAOW,EACLxD,EAASuD,SACT+C,EAAUjG,EAAM7lB,OAAS6lB,EAAM5P,OAAO6V,GAAW,KACjDA,EAAUjG,EAAM7lB,OACZyoB,EAAoBqD,EAASA,EAAU,GACvCrD,EAAoBqD,EAASA,IA0hC7BC,IA/5CV,SAAsB1L,EAAO2L,GAC3B,SAASC,IAAM9uB,KAAK+uB,YAAc7L,EAClC4L,EAAEvwB,UAAYswB,EAAOtwB,UACrB2kB,EAAM3kB,UAAY,IAAIuwB,EAgBxBE,CAAa5G,EAAiBvD,OAE9BuD,EAAgB0D,aAAe,SAASzD,EAAUC,EAAOC,GACvD,IAAI0G,EAA2B,CAC7BC,QAAS,SAASC,GAChB,MAAO,IAAOC,EAAcD,EAAYvE,MAAQ,KAGlDyE,MAAO,SAASF,GACd,IAAIG,EAAeH,EAAYrE,MAAMvG,KAAI,SAASgL,GAChD,OAAO/sB,MAAM6hB,QAAQkL,GACjBC,EAAYD,EAAK,IAAM,IAAMC,EAAYD,EAAK,IAC9CC,EAAYD,MAGlB,MAAO,KAAOJ,EAAYpE,SAAW,IAAM,IAAMuE,EAAe,KAGlEG,IAAK,WACH,MAAO,iBAGT3mB,IAAK,WACH,MAAO,gBAGT4mB,MAAO,SAASP,GACd,OAAOA,EAAYnE,aAGrB2E,IAAK,SAASR,GACZ,MAAO,OAASS,EAAoBT,EAAY9G,YAIpD,SAASwH,EAAIC,GACX,OAAOA,EAAGnR,WAAW,GAAGrT,SAAS,IAAIsN,cAGvC,SAASwW,EAAc1wB,GACrB,OAAOA,EACJ+Z,QAAQ,MAAO,QACfA,QAAQ,KAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,gBAAyB,SAASqX,GAAM,MAAO,OAASD,EAAIC,MACpErX,QAAQ,yBAAyB,SAASqX,GAAM,MAAO,MAASD,EAAIC,MAGzE,SAASN,EAAY9wB,GACnB,OAAOA,EACJ+Z,QAAQ,MAAO,QACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,KAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,MAAO,OACfA,QAAQ,gBAAyB,SAASqX,GAAM,MAAO,OAASD,EAAIC,MACpErX,QAAQ,yBAAyB,SAASqX,GAAM,MAAO,MAASD,EAAIC,MAGzE,SAASF,EAAoBT,GAC3B,OAAOF,EAAyBE,EAAY9jB,MAAM8jB,GAqCpD,MAAO,YAlCP,SAA0B9G,GACxB,IACI1rB,EAAGoU,EADHgf,EAAe1H,EAAS9D,IAAIqL,GAKhC,GAFAG,EAAanb,OAETmb,EAAaltB,OAAS,EAAG,CAC3B,IAAKlG,EAAI,EAAGoU,EAAI,EAAGpU,EAAIozB,EAAaltB,OAAQlG,IACtCozB,EAAapzB,EAAI,KAAOozB,EAAapzB,KACvCozB,EAAahf,GAAKgf,EAAapzB,GAC/BoU,KAGJgf,EAAaltB,OAASkO,EAGxB,OAAQgf,EAAaltB,QACnB,KAAK,EACH,OAAOktB,EAAa,GAEtB,KAAK,EACH,OAAOA,EAAa,GAAK,OAASA,EAAa,GAEjD,QACE,OAAOA,EAAavlB,MAAM,GAAI,GAAG2jB,KAAK,MAClC,QACA4B,EAAaA,EAAaltB,OAAS,IAQxBmtB,CAAiB3H,GAAY,QAJlD,SAAuBC,GACrB,OAAOA,EAAQ,IAAO8G,EAAc9G,GAAS,IAAO,eAGM2H,CAAc3H,GAAS,WCzG9E,SAAS4H,EAAwBC,GACtC,OAAO,EAAMA","file":"index.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"simplecrop\"] = factory();\n\telse\n\t\troot[\"SimpleCrop\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/* global define */\n/// <reference path=\"./index.d.ts\" />\n(function(factory) {\n  if (typeof define === \"function\" && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([\"prefix-umd\", \"exif-js\", \"transformation-matrix\"], factory);\n  } else if (typeof module === \"object\" && module.exports) {\n    // Node/CommonJS\n    module.exports = factory(\n      require(\"prefix-umd\"),\n      require(\"exif-js\"),\n      require(\"transformation-matrix\")\n    );\n  } else {\n    // Browser globals\n    window.SimpleCrop = factory(\n      window.Prefix,\n      window.EXIF,\n      window.TransformationMatrix\n    );\n  }\n})(function(Prefix, EXIF, TransformationMatrix) {\n  //兼容性处理\n  function whichTransitionEvent() {\n    var t;\n    var el = document.createElement(\"div\");\n    var transitions = {\n      transition: \"transitionend\",\n      OTransition: \"oTransitionEnd\",\n      MozTransition: \"transitionend\",\n      WebkitTransition: \"webkitTransitionEnd\",\n      MsTransition: \"msTransitionEnd\",\n    };\n    for (t in transitions) {\n      if (el.style[t] !== undefined) {\n        return transitions[t];\n      }\n    }\n  }\n  var transitionEndEvent = whichTransitionEvent();\n  var transformProperty = Prefix.prefix(\"transform\");\n  var transitionProperty = Prefix.prefix(\"transition\");\n\n  //includes方法兼容\n  if (!Array.prototype.includes) {\n    Object.defineProperty(Array.prototype, \"includes\", {\n      value: function(valueToFind, fromIndex) {\n        var o = Object(this);\n        var len = o.length >>> 0;\n        if (len === 0) {\n          return false;\n        }\n\n        var n = fromIndex | 0;\n        var k = Math.max(n >= 0 ? n : len - Math.abs(n), 0);\n\n        function sameValueZero(x, y) {\n          return (\n            x === y ||\n            (typeof x === \"number\" &&\n              typeof y === \"number\" &&\n              isNaN(x) &&\n              isNaN(y))\n          );\n        }\n        while (k < len) {\n          if (sameValueZero(o[k], valueToFind)) {\n            return true;\n          }\n          k++;\n        }\n        return false;\n      },\n    });\n  }\n\n  /**\n   * ------------------------------------\n   * 配置\n   * @param title 标题\n   * @param visible 组件是否可见\n   * @param debug 是否开启调试模式（pc、mobile）\n   * @param $container 容器（pc、mobile）\n   * ------------------------------------\n   * 裁剪图片\n   * @param src   图片地址\n   * @param size 裁剪图片目标尺寸\n   * initSize 裁剪图片初始尺寸\n   * originImage 初始图片\n   * _orientation 图片方向\n   * ------------------------------------\n   * 裁剪框样式\n   * @param positionOffset 裁剪框屏幕偏移\n   * @param boldCornerLen 裁剪框边角加粗长度\n   * @param boldCornerWidth 裁剪框边角加粗宽度\n   * @param coverColor 遮罩背景颜色\n   * @param cropSizePercent 裁剪框占裁剪显示区域的比例\n   * @param borderWidth 裁剪框边框宽度\n   * @param borderColor 裁剪框边框颜色\n   * @param coverDraw 裁剪框辅助线绘制函数\n   * @param borderDraw 裁剪框边框绘制函数\n   * ------------------------------------\n   * 裁剪框拖拽\n   * @param cursorHoverWidth 裁剪框拖动触发范围\n   * @param isFixedAspectRatio 是否固定宽高比\n   * ------------------------------------\n   * 功能按钮\n   * @param funcBtns 功能按钮配置数组\n   * @param cropCallback 图片裁剪完成回调函数\n   * @param uploadCallback 重新上传裁剪图片回调函数\n   * @param closeCallback 关闭裁剪组件回调函数\n   * ------------------------------------\n   * 旋转刻度盘\n   * @param rotateSlider 是否开启旋转刻度盘\n   * @param startAngle 旋转刻度盘开始角度\n   * @param endAngle 旋转刻度盘结束角度\n   * @param gapAngle 旋转刻度盘间隔角度\n   * @param lineationItemWidth 旋转刻度盘间隔宽度\n   * lineationWidth 根据上述参数计算出的旋转刻度盘总宽度\n   * rotateWidth 旋转刻度盘显示宽度\n   * ------------------------------------\n   * 尺寸（为了减少计算的复杂性，所有坐标都统一为屏幕坐标及尺寸）\n   * maskViewSize 容器屏幕尺寸\n   * initCropRect 初始裁剪框屏幕尺寸\n   * cropRect 裁剪框屏幕尺寸\n   * cropPoints 裁剪框顶点坐标\n   * cropCenter 裁剪框中心点坐标\n   * contentWidth 图片显示宽度\n   * contentHeight 图片显示高度\n   * contentPoints 图片顶点坐标\n   * initContentPoints 图片初始顶点坐标\n   * _contentCurMoveX 图片 X 轴方向上的总位移\n   * _contentCurMoveY 图片 Y 轴方向上的总位移\n   * ------------------------------------\n   * 鼠标滚轮缩放\n   * _wheelTimeout 定时器\n   * ------------------------------------\n   * 拖动裁剪框\n   * _moveCursor 拖拽状态\n   * _moveCursorAction 裁剪框拖动进行时\n   *\n   * move 图片拖拽\n   * crop_leftTop 裁剪框左上拖拽\n   * crop_leftBottom 裁剪框左下拖拽\n   * crop_rightTop 裁剪框右上拖拽\n   * crop_rightBottom 裁剪框右下拖拽\n   * crop_left 裁剪框左拖拽\n   * crop_right 裁剪框右拖拽\n   * crop_top 裁剪框上拖拽\n   * crop_bottom 裁剪框下拖拽\n   * ------------------------------------\n   * 双指缩放\n   * _multiPoint 是否开始多点触控\n   * fingerLen 双指距离\n   * fingerScale 双指缩放倍数\n   * fingerCenter 双指操作中心\n   * ------------------------------------\n   * 其它\n   * times 实际尺寸/显示尺寸\n   * initScale 初始缩放倍数\n   * $resultCanvas 裁切结果（pc、mobile）\n   * resultSrc 裁剪结果（wechat）\n   * isSupportTouch 是否支持 touch 事件（pc、mobile）\n   * passiveSupported 事件是否支持 passive（pc、mobile）\n   * _precision 计算精度\n   */\n  function SimpleCrop(params) {\n    //配置\n    this.id = \"crop-\" + new Date().getTime();\n    this.initSize = {\n      width: params.size.width,\n      height: params.size.height,\n    }; // 初始尺寸\n    this.visible = params.visible != null ? params.visible : true; //默认显示\n    this.debug = params.debug != null ? params.debug : false;\n    this.$container =\n      params.$container != null ? params.$container : document.body; //容器\n\n    //其它\n    var self = this;\n    self.passiveSupported = false; //判断是否支持 passive\n    try {\n      var options = Object.defineProperty({}, \"passive\", {\n        get: function() {\n          self.passiveSupported = true;\n        },\n      });\n      window.addEventListener(\"test\", null, options);\n    } catch (err) {\n      //nothing\n    }\n    this.isSupportTouch = \"ontouchend\" in document ? true : false; //判断是否支持 touch 事件\n    this._precision = 5; // 计算精度\n\n    //操作状态\n    this._multiPoint = false; //是否开始多点触控\n    this._rotateScale = 1; //旋转缩放倍数\n    this._baseMoveX = 0; //旋转刻度盘位置初始化偏移量\n    this._curMoveX = 0; //旋转刻度盘位置当前总偏移量\n    this._changedX = 0; //旋转刻度盘当前偏移量\n    this._downPoints = []; //操作点坐标数组\n    this._isControl = false; //是否正在操作\n    /**\n     * 旋转交互分为两种：\n     * 一种是整角旋转（90度）；\n     * 另一种是基于整角旋转的基础上正负45度旋转。\n     */\n    this._baseAngle = 0;\n    this.scaleTimes = 1; //缩放倍数\n    this.rotateAngle = 0; //旋转角度\n\n    this.construct();\n    //注意 construct 和 bindEvent 中间函数的先后顺序\n    this.initFuncBtns(params); //初始化功能按钮\n    this.initRotateSlider(params); //初始化旋转刻度盘\n    this.initChilds();\n    this.initTitle(params);\n    this.initBox(params);\n    this.initBoxBorder(params, true);\n    this.initBoxCursor(params);\n    this.setImage(params.src != null ? params.src : this.src);\n    this.bindEvent();\n  }\n\n  //初始化标题\n  SimpleCrop.prototype.initTitle = function(params) {\n    this.title = params.title != null ? params.title : \"\";\n    this.$title = document.querySelector(\"#\" + this.id + \" .crop-title\");\n    this.$title.innerText = this.title;\n  };\n\n  //初始化裁剪框边框以及辅助线\n  SimpleCrop.prototype.initBoxBorder = function(params, onlyInit) {\n    this.borderWidth = params.borderWidth != null ? params.borderWidth : 2;\n    this.borderColor = params.borderColor != null ? params.borderColor : \"#fff\";\n    this.boldCornerLen =\n      params.boldCornerLen != null ? params.boldCornerLen : 32;\n    this.boldCornerWidth = params.boldCornerWidth ? params.boldCornerWidth : 4;\n    this.coverColor =\n      params.coverColor != null ? params.coverColor : \"rgba(0,0,0,.3)\";\n    this.coverDraw =\n      params.coverDraw != null ? params.coverDraw : function() {};\n    this.borderDraw =\n      params.borderDraw != null ? params.borderDraw : this.defaultBorderDraw;\n\n    if (!onlyInit) {\n      this.borderDraw(this.$cropCover);\n      this.coverDraw(this.$cropCover);\n    }\n  };\n\n  // 初始化裁剪框拖拽相关参数\n  SimpleCrop.prototype.initBoxCursor = function(params) {\n    const defaultCursorWidth = this.isSupportTouch\n      ? this.borderWidth * 10\n      : this.borderWidth * 2;\n    this.cursorHoverWidth =\n      params.cursorHoverWidth != null\n        ? params.cursorHoverWidth\n        : defaultCursorWidth;\n\n    this.isFixedAspectRatio =\n      params.isFixedAspectRatio != null ? params.isFixedAspectRatio : false;\n  };\n\n  //初始化功能按钮\n  SimpleCrop.prototype.initFuncBtns = function(params) {\n    /**\n     * 默认功能按钮为取消、裁剪、90度旋转、重置\n     * upload 重新上传\n     * crop 裁剪\n     * close 取消\n     * around 90度旋转\n     * reset 重置\n     */\n    this.funcBtns =\n      params.funcBtns != null\n        ? params.funcBtns\n        : [\"close\", \"crop\", \"around\", \"reset\"];\n    this.cropCallback =\n      params.cropCallback != null ? params.cropCallback : function() {};\n    this.closeCallback =\n      params.closeCallback != null ? params.closeCallback : function() {};\n    this.uploadCallback =\n      params.uploadCallback != null ? params.uploadCallback : function() {};\n\n    this.$cropBtns = document.querySelector(\"#\" + this.id + \" .crop-btns\");\n    var html = \"\";\n    if (this.funcBtns.includes(\"upload\")) {\n      html += '<div class=\"upload-btn-container\">';\n      html += '<button class=\"upload-btn\"></button>';\n      html += '<input type=\"file\" accept=\"image/png,image/jpeg\">';\n      html += \"</div>\";\n    }\n    if (this.funcBtns.includes(\"close\")) {\n      html += '<button class=\"crop-close\"></button>';\n    }\n    if (this.funcBtns.includes(\"around\")) {\n      html += '<button class=\"crop-around\"></button>';\n    }\n    if (this.funcBtns.includes(\"reset\")) {\n      html += '<button class=\"crop-reset\"></button>';\n    }\n    if (this.funcBtns.includes(\"crop\")) {\n      html += '<button class=\"crop-btn\"></button>';\n    }\n    this.$cropBtns.innerHTML = html;\n\n    //重新上传\n    if (this.funcBtns.includes(\"upload\")) {\n      if (this.$uploadBtn) {\n        this.$uploadBtn.removeEventListener(\"change\", this.__uploadInput);\n      } else {\n        this.__uploadInput = this.uploadInput.bind(this);\n      }\n      this.$uploadBtn = document.querySelector(\n        \"#\" + this.id + \" .upload-btn-container\"\n      );\n      this.$uploadInput = document.querySelector(\n        \"#\" + this.id + \" .upload-btn-container input\"\n      );\n      this.$uploadBtn.addEventListener(\"change\", this.__uploadInput);\n    }\n\n    //裁剪\n    if (this.funcBtns.includes(\"crop\")) {\n      if (this.$cropBtn) {\n        this.$cropBtn.removeEventListener(\"click\", this.__crop);\n      } else {\n        this.__crop = this.crop.bind(this);\n      }\n      this.$cropBtn = document.querySelector(\"#\" + this.id + \" .crop-btn\");\n      this.$cropBtn.addEventListener(\"click\", this.__crop);\n    }\n\n    //整角旋转\n    if (this.funcBtns.includes(\"around\")) {\n      if (this.$aroundBtn) {\n        this.$aroundBtn.removeEventListener(\"click\", this.__around);\n      } else {\n        this.__around = this.around.bind(this);\n      }\n      this.$aroundBtn = document.querySelector(\"#\" + this.id + \" .crop-around\");\n      this.$aroundBtn.addEventListener(\"click\", this.__around);\n    }\n\n    //还原\n    if (this.funcBtns.includes(\"reset\")) {\n      if (this.$resetBtn) {\n        this.$resetBtn.removeEventListener(\"click\", this.reset);\n      } else {\n        this.__reset = this.reset.bind(this);\n      }\n      this.$resetBtn = document.querySelector(\"#\" + this.id + \" .crop-reset\");\n      this.$resetBtn.addEventListener(\"click\", this.__reset);\n    }\n\n    //关闭\n    if (this.funcBtns.includes(\"close\")) {\n      if (this.$closeBtn) {\n        this.$closeBtn.removeEventListener(\"click\", this.close);\n      } else {\n        this.__close = this.close.bind(this);\n      }\n      this.$closeBtn = document.querySelector(\"#\" + this.id + \" .crop-close\");\n      this.$closeBtn.addEventListener(\"click\", this.__close);\n    }\n\n    if (this.funcBtns.length > 0) {\n      this.$cropBtns.style.visibility = \"\";\n    } else {\n      this.$cropBtns.style.visibility = \"hidden\";\n    }\n  };\n\n  //初始化旋转刻度盘\n  SimpleCrop.prototype.initRotateSlider = function(params) {\n    this.rotateSlider =\n      params.rotateSlider != null ? params.rotateSlider : true; //默认开启\n    this.startAngle = params.startAngle != null ? params.startAngle : -90;\n    this.endAngle = params.endAngle != null ? params.endAngle : 90;\n    this.gapAngle = params.gapAngle != null ? params.gapAngle : 10;\n    this.lineationItemWidth =\n      params.lineationItemWidth != null ? params.lineationItemWidth : 40.5;\n    this.lineationItemWidth =\n      this.lineationItemWidth >= 40.5 ? this.lineationItemWidth : 40.5; // 最小宽度限制\n\n    //开始角度需要小于0，结束角度需要大于0，且开始角度和结束角度之间存在大于0的整数个间隔\n    this.startAngle = this.startAngle < 0 ? parseInt(this.startAngle) : 0;\n    this.endAngle = this.endAngle > 0 ? parseInt(this.endAngle) : 0;\n    this.gapAngle = this.gapAngle > 0 ? parseInt(this.gapAngle) : 3;\n    if ((this.endAngle - this.startAngle) % this.gapAngle != 0) {\n      this.endAngle =\n        Math.ceil((this.endAngle - this.startAngle) / this.gapAngle) *\n          this.gapAngle +\n        this.startAngle;\n    }\n    this.lineationWidth =\n      this.lineationItemWidth *\n      ((this.endAngle - this.startAngle) / this.gapAngle + 1);\n\n    this.$cropRotate = document.querySelector(\"#\" + this.id + \" .crop-rotate\");\n    this.$lineation = document.querySelector(\"#\" + this.id + \" .lineation\");\n    this.$rotateCurrent = document.querySelector(\"#\" + this.id + \" .current\");\n    var rotateStyle = window.getComputedStyle(this.$cropRotate);\n    this.rotateWidth = parseFloat(rotateStyle.getPropertyValue(\"width\")); // 旋转刻度盘显示宽度\n    this._baseMoveX = -(\n      (this.lineationWidth * (0 - this.startAngle + this.gapAngle / 2)) /\n        (this.endAngle - this.startAngle + this.gapAngle) -\n      this.rotateWidth / 2\n    ); //开始角度大于 0 且结束角度小于 0，以 0 度为起点\n    var angle = this.rotateAngle - this._baseAngle;\n    this._curMoveX =\n      (angle * this.lineationWidth) /\n        (this.endAngle - this.startAngle + this.gapAngle) +\n      this._baseMoveX;\n\n    //超出滚动边界，旋转刻度盘重置\n    if (\n      this._curMoveX > 0 ||\n      this._curMoveX < this.rotateWidth - this.lineationWidth\n    ) {\n      this.startControl();\n      this._curMoveX = this._baseMoveX;\n      this._baseAngle = 0;\n      this.rotateAngle = 0;\n      this._changedX = 0;\n      this._rotateScale = 1;\n      this.transform(true);\n      this.endControl();\n    }\n\n    //setData\n    var html = \"\";\n    for (var i = this.startAngle; i <= this.endAngle; i += this.gapAngle) {\n      html +=\n        '<li><div class=\"number\">' + i + '</div><div class=\"bg\"></div></li>';\n    }\n    this.$lineation.innerHTML = html;\n    this.$lineation.style.width = this.lineationWidth + \"px\";\n    this.$lineation.style[transformProperty] =\n      \"translateX(\" + this._curMoveX + \"px)\";\n    if (this.rotateSlider) {\n      this.$cropRotate.style.visibility = \"\";\n    } else {\n      this.$cropRotate.style.visibility = \"hidden\";\n    }\n  };\n\n  //初始化相关子元素\n  SimpleCrop.prototype.initChilds = function() {\n    this.$cropMask = document.querySelector(\"#\" + this.id + \" .crop-mask\");\n    var maskRect = this.$cropMask.getBoundingClientRect();\n    this.maskViewSize = {\n      top: maskRect.top,\n      left: maskRect.left,\n      width: maskRect.width,\n      height: maskRect.height,\n    };\n    this.$cropCover = document.querySelector(\"#\" + this.id + \" .crop-cover\");\n    this.cropCoverContext = this.$cropCover.getContext(\"2d\");\n    this.$cropCover.width = this.maskViewSize.width * window.devicePixelRatio;\n    this.$cropCover.height = this.maskViewSize.height * window.devicePixelRatio;\n  };\n\n  // 初始化裁剪图片目标尺寸、裁剪框显示比例、偏移等参数\n  SimpleCrop.prototype.initBox = function(params) {\n    this.size = params.size;\n    this.positionOffset =\n      params.positionOffset != null\n        ? params.positionOffset\n        : {\n            top: 0,\n            left: 0,\n          };\n    this.cropSizePercent =\n      params.cropSizePercent != null ? params.cropSizePercent : 0.5; //默认0.5则表示高度或者宽度最多占50%\n  };\n\n  // 根据裁剪图片目标尺寸、裁剪框显示比例、偏移等参数重现绘制裁剪框\n  SimpleCrop.prototype.updateBox = function(params) {\n    this.initBox(params);\n\n    this.times =\n      this.size.width / this.maskViewSize.width >\n      this.size.height / this.maskViewSize.height\n        ? this.size.width / this.maskViewSize.width / this.cropSizePercent\n        : this.size.height / this.maskViewSize.height / this.cropSizePercent;\n\n    //裁剪框位置相关\n    this.cropRect = {\n      width: this.size.width / this.times,\n      height: this.size.height / this.times,\n    };\n    this.cropRect.left =\n      (this.maskViewSize.width - this.cropRect.width) / 2 -\n      this.positionOffset.left;\n    this.cropRect.top =\n      (this.maskViewSize.height - this.cropRect.height) / 2 -\n      this.positionOffset.top;\n    this.initCropRect = {\n      left: this.cropRect.left,\n      top: this.cropRect.top,\n      width: this.cropRect.width,\n      height: this.cropRect.height,\n    };\n    this.cropPoints = this.rectToPoints(this.cropRect);\n    this.cropCenter = this.getPointsCenter(this.cropPoints);\n\n    this.borderDraw(this.$cropCover);\n    this.coverDraw(this.$cropCover);\n    this.transform(false, true);\n  };\n\n  //获取操作点\n  SimpleCrop.prototype.getControlPoints = function(e) {\n    if (e.touches) {\n      return e.touches;\n    } else {\n      return [\n        {\n          clientX: e.clientX,\n          clientY: e.clientY,\n        },\n      ];\n    }\n  };\n\n  //获取操作事件名称\n  SimpleCrop.prototype.getControlEvents = function() {\n    if (this.isSupportTouch) {\n      return {\n        start: \"touchstart\",\n        move: \"touchmove\",\n        end: \"touchend\",\n        cancel: \"touchcancel\",\n      };\n    } else {\n      return {\n        start: \"mousedown\",\n        move: \"mousemove\",\n        end: \"mouseup\",\n        cancel: \"mouseleave\",\n      };\n    }\n  };\n\n  //html结构\n  SimpleCrop.prototype.construct = function() {\n    var html = \"\";\n    html += '<div class=\"crop-component\">';\n    html += '<p class=\"crop-title\"></p>'; // 标题\n    html += '<div class=\"crop-mask\">';\n    html += '<canvas class=\"crop-cover\"></canvas>';\n    html += \"</div>\";\n\n    //旋转刻度盘\n    if (this.rotateSlider) {\n      html += '<div class=\"crop-rotate\">';\n    } else {\n      html += '<div class=\"crop-rotate\" style=\"visibility:hidden;\">';\n    }\n    html += '<ul class=\"lineation\">';\n    html += \"</ul>\";\n    html += '<div class=\"current\"></div>';\n    html += \"</div>\";\n\n    //功能按钮\n    html += '<div class=\"crop-btns\" style=\"visibility:hidden;\"></div>';\n    html += \"</div>\";\n\n    this.$target = document.createElement(\"div\");\n    this.$target.id = this.id;\n    this.$target.classList.add(\"crop-whole-cover\");\n    if (this.visible) {\n      this.$target.style.visibility = \"\";\n    } else {\n      this.$target.style.visibility = \"hidden\";\n    }\n    this.$target.innerHTML = html;\n    this.$container.appendChild(this.$target);\n  };\n\n  //默认绘制裁剪框\n  SimpleCrop.prototype.defaultBorderDraw = function($cropCover) {\n    var borderWidth = this.borderWidth;\n    var boldCornerWidth = this.boldCornerWidth;\n    var boldCornerLen = this.boldCornerLen;\n    boldCornerLen =\n      boldCornerLen >= borderWidth * 2 ? boldCornerLen : borderWidth * 2; // 边角加粗长度至少是边框的两倍\n\n    var coverWidth = $cropCover.width;\n    var coverHeight = $cropCover.height;\n    this.cropCoverContext.clearRect(0, 0, coverWidth, coverHeight);\n    this.cropCoverContext.fillStyle = this.coverColor;\n    this.cropCoverContext.fillRect(0, 0, coverWidth, coverHeight);\n\n    //绘制边框（边框内嵌）\n    var borderRect = {\n      left: this.cropRect.left * window.devicePixelRatio,\n      top: this.cropRect.top * window.devicePixelRatio,\n      width: this.cropRect.width * window.devicePixelRatio,\n      height: this.cropRect.height * window.devicePixelRatio,\n    };\n    this.cropCoverContext.fillStyle = this.borderColor;\n    this.cropCoverContext.fillRect(\n      borderRect.left,\n      borderRect.top,\n      borderRect.width,\n      borderRect.height\n    );\n\n    if (this.boldCornerLen > 0) {\n      //边框四个角加粗\n      this.cropCoverContext.fillRect(\n        borderRect.left - boldCornerWidth,\n        borderRect.top - boldCornerWidth,\n        boldCornerLen,\n        boldCornerLen\n      ); //左上角\n      this.cropCoverContext.fillRect(\n        borderRect.left + borderRect.width - boldCornerLen + boldCornerWidth,\n        borderRect.top - boldCornerWidth,\n        boldCornerLen,\n        boldCornerLen\n      ); //右上角\n      this.cropCoverContext.fillRect(\n        borderRect.left - boldCornerWidth,\n        borderRect.top + borderRect.height - boldCornerLen + boldCornerWidth,\n        boldCornerLen,\n        boldCornerLen\n      ); //左下角\n      this.cropCoverContext.fillRect(\n        borderRect.left + borderRect.width - boldCornerLen + boldCornerWidth,\n        borderRect.top + borderRect.height - boldCornerLen + boldCornerWidth,\n        boldCornerLen,\n        boldCornerLen\n      ); //右下角\n    }\n\n    // 文字\n    var txtCanvas = document.createElement(\"canvas\");\n    txtCanvas.width = borderRect.width;\n    txtCanvas.height = 24;\n    var ctx = txtCanvas.getContext(\"2d\");\n    ctx.font = \"24px Calibri\";\n    ctx.fillStyle = this.borderColor;\n    ctx.textBaseline = \"middle\";\n    ctx.textAlign = \"center\";\n    var curSizeWidth = parseInt(\n      (this.size.width * this.cropRect.width) / this.initCropRect.width\n    );\n    var curSizeHeight = parseInt(\n      (this.size.height * this.cropRect.height) / this.initCropRect.height\n    );\n    ctx.fillText(\n      curSizeWidth + \" x \" + curSizeHeight,\n      txtCanvas.width / 2,\n      txtCanvas.height / 2\n    );\n    this.cropCoverContext.drawImage(\n      txtCanvas,\n      0,\n      0,\n      txtCanvas.width,\n      txtCanvas.height,\n      borderRect.left,\n      borderRect.top - 24 - 2 * this.boldCornerWidth,\n      txtCanvas.width,\n      txtCanvas.height\n    );\n\n    //清空内容区域\n    this.cropCoverContext.clearRect(\n      borderRect.left + borderWidth,\n      borderRect.top + borderWidth,\n      borderRect.width - 2 * borderWidth,\n      borderRect.height - 2 * borderWidth\n    );\n  };\n\n  //初始化\n  SimpleCrop.prototype.init = function() {\n    var width = this.contentWidth / 2;\n    var height = this.contentHeight / 2;\n    this.initContentPoints = [\n      {\n        x: -width,\n        y: height,\n      },\n      {\n        x: width,\n        y: height,\n      },\n      {\n        x: width,\n        y: -height,\n      },\n      {\n        x: -width,\n        y: -height,\n      },\n    ];\n    this.contentPoints = this.initContentPoints.slice();\n\n    //计算初始缩放倍数\n    if (\n      this.size.width / this.size.height >\n      this.contentWidth / this.contentHeight\n    ) {\n      this.initScale = this.size.width / this.contentWidth;\n    } else {\n      this.initScale = this.size.height / this.contentHeight;\n    }\n\n    this.reset();\n  };\n\n  //重置\n  SimpleCrop.prototype.reset = function() {\n    this.startControl();\n    this._contentCurMoveX = -this.positionOffset.left;\n    this._contentCurMoveY = -this.positionOffset.top;\n\n    this._rotateScale = 1;\n    this._baseAngle = 0;\n    this.rotateAngle = 0;\n    this._curMoveX = this._baseMoveX;\n    this._changedX = 0;\n    this.$lineation.style[transformProperty] =\n      \"translateX(\" + this._baseMoveX + \"px)\";\n    this.scaleTimes = this.initScale;\n\n    this.updateBox({\n      positionOffset: this.positionOffset,\n      cropSizePercent: this.cropSizePercent,\n      size: {\n        width: this.initSize.width,\n        height: this.initSize.height,\n      },\n    });\n    this.endControl();\n  };\n\n  //加载图片\n  SimpleCrop.prototype.load = function() {\n    var self = this;\n    self.originImage.onload = function() {\n      EXIF.getData(self.originImage, function() {\n        self._orientation = EXIF.getTag(this, \"Orientation\");\n        self.getRealCotentSize();\n        self.transformCoordinates();\n        self.init();\n      });\n    };\n  };\n\n  //设置裁剪图片\n  SimpleCrop.prototype.setImage = function(image) {\n    if (image != null && image != \"\") {\n      var self = this;\n      var type = Object.prototype.toString.call(image);\n      if (type === \"[object String]\") {\n        //字符串\n        self.src = image;\n        self.originImage = new Image();\n        self.originImage.crossOrigin = \"Anonymous\";\n        self.originImage.src = self.src;\n        self.load();\n        self.uploadCallback(self.src);\n      } else if (type === \"[object File]\") {\n        //文件\n        self.fileToSrc(image, function(src) {\n          self.src = src;\n          self.originImage = new Image();\n          self.originImage.crossOrigin = \"Anonymous\";\n          self.originImage.src = self.src;\n          self.load();\n          self.uploadCallback(self.src);\n        });\n      }\n    }\n  };\n\n  //显示\n  SimpleCrop.prototype.show = function(image) {\n    if (image) {\n      this.setImage(image);\n    }\n    this.visible = true;\n    this.$target.style.visibility = \"\";\n  };\n\n  //隐藏\n  SimpleCrop.prototype.hide = function() {\n    this.visible = false;\n    this.$target.style.visibility = \"hidden\";\n  };\n\n  //关闭\n  SimpleCrop.prototype.close = function() {\n    this.hide();\n    this.closeCallback();\n  };\n\n  //裁剪\n  SimpleCrop.prototype.crop = function() {\n    this.getCropImage();\n    this.cropCallback(this.$resultCanvas);\n    this.hide();\n  };\n\n  //上传\n  SimpleCrop.prototype.uploadInput = function(evt) {\n    var files = evt.target.files;\n    if (files.length > 0) {\n      this.show(files[0]);\n    }\n    this.$uploadInput.value = \"\"; //清空value属性，从而保证用户修改文件内容但是没有修改文件名时依然能上传成功\n  };\n\n  //整角旋转\n  SimpleCrop.prototype.around = function() {\n    this.startControl();\n    this.rotateAngle = (this._baseAngle - 90) % 360;\n    this._baseAngle = this.rotateAngle;\n    this._curMoveX = this._baseMoveX;\n    this._changedX = 0;\n    this._rotateScale = 1;\n    this.$lineation.style[transformProperty] =\n      \"translateX(\" + this._baseMoveX + \"px)\";\n    this.transform(false, true);\n    this.endControl();\n  };\n\n  // 裁剪框拖拽鼠标样式\n  SimpleCrop.prototype.moveCursor = function(touches) {\n    var point = {\n      x: touches[0].clientX - this.maskViewSize.left,\n      y: touches[0].clientY - this.maskViewSize.top,\n    };\n    var innerRect = {\n      left: this.cropRect.left + this.cursorHoverWidth,\n      top: this.cropRect.top + this.cursorHoverWidth,\n      width: this.cropRect.width - 2 * this.cursorHoverWidth,\n      height: this.cropRect.height - 2 * this.cursorHoverWidth,\n    };\n    var outerRect = {\n      left: this.cropRect.left - this.cursorHoverWidth,\n      top: this.cropRect.top - this.cursorHoverWidth,\n      width: this.cropRect.width + 2 * this.cursorHoverWidth,\n      height: this.cropRect.height + 2 * this.cursorHoverWidth,\n    };\n    if (\n      point.x >= outerRect.left &&\n      point.x <= outerRect.left + outerRect.width &&\n      point.y >= outerRect.top &&\n      point.y <= outerRect.height + outerRect.top &&\n      !(\n        point.x >= innerRect.left &&\n        point.x <= innerRect.left + innerRect.width &&\n        point.y >= innerRect.top &&\n        point.y <= innerRect.height + innerRect.top\n      )\n    ) {\n      if (\n        point.x <= outerRect.left + this.boldCornerLen &&\n        point.y <= outerRect.top + this.boldCornerLen\n      ) {\n        this.$cropCover.style.cursor = \"nwse-resize\"; // 左上角\n        this._moveCursor = \"crop_leftTop\";\n      } else if (\n        point.x <= outerRect.left + this.boldCornerLen &&\n        point.y >= outerRect.height + outerRect.top - this.boldCornerLen\n      ) {\n        this.$cropCover.style.cursor = \"nesw-resize\"; // 左下角\n        this._moveCursor = \"crop_leftBottom\";\n      } else if (\n        point.x >= outerRect.width + outerRect.left - this.boldCornerLen &&\n        point.y <= outerRect.top + this.boldCornerLen\n      ) {\n        this.$cropCover.style.cursor = \"nesw-resize\"; // 右上角\n        this._moveCursor = \"crop_rightTop\";\n      } else if (\n        point.x >= outerRect.width + outerRect.left - this.boldCornerLen &&\n        point.y >= outerRect.height + outerRect.top - this.boldCornerLen\n      ) {\n        this.$cropCover.style.cursor = \"nwse-resize\"; // 右下角\n        this._moveCursor = \"crop_rightBottom\";\n      } else if (\n        point.y <= outerRect.top + this.boldCornerLen &&\n        !this.isFixedAspectRatio\n      ) {\n        this.$cropCover.style.cursor = \"ns-resize\"; // 水平上\n        this._moveCursor = \"crop_top\";\n      } else if (\n        point.y >= outerRect.height + outerRect.top - this.boldCornerLen &&\n        !this.isFixedAspectRatio\n      ) {\n        this.$cropCover.style.cursor = \"ns-resize\"; // 水平下\n        this._moveCursor = \"crop_bottom\";\n      } else if (\n        point.x <= outerRect.left + this.boldCornerLen &&\n        !this.isFixedAspectRatio\n      ) {\n        this.$cropCover.style.cursor = \"ew-resize\"; // 竖直左\n        this._moveCursor = \"crop_left\";\n      } else if (\n        point.x >= outerRect.width + outerRect.left - this.boldCornerLen &&\n        !this.isFixedAspectRatio\n      ) {\n        this.$cropCover.style.cursor = \"ew-resize\"; // 竖直右\n        this._moveCursor = \"crop_right\";\n      }\n    } else {\n      this.$cropCover.style.cursor = \"move\";\n      this._moveCursor = \"move\";\n    }\n  };\n\n  //裁剪框移动\n  SimpleCrop.prototype.cropMove = function(touches) {\n    var movePos = touches[0];\n    var startPos = this._downPoints[0];\n    var moveCursorAction = this._moveCursorAction.toLowerCase();\n    var changeX = movePos.clientX - startPos.clientX;\n    var finalMovePos = {\n      clientX: movePos.clientX,\n      clientY: movePos.clientY,\n    };\n    if (\n      (moveCursorAction.indexOf(\"left\") != -1 ||\n        moveCursorAction.indexOf(\"right\") != -1) &&\n      (moveCursorAction.indexOf(\"top\") != -1 ||\n        moveCursorAction.indexOf(\"bottom\") != -1)\n    ) {\n      var tag = 0;\n      if ([\"crop_lefttop\", \"crop_rightbottom\"].includes(moveCursorAction)) {\n        tag = 1;\n      } else {\n        tag = -1;\n      }\n      var fixedChangeY =\n        (changeX * this.initCropRect.height) / this.initCropRect.width;\n      finalMovePos.clientY = startPos.clientY + fixedChangeY * tag; // 以宽度变化为基准\n    }\n\n    if (moveCursorAction.indexOf(\"left\") != -1) {\n      this.cropRect.left =\n        this.initCropRect.left + (finalMovePos.clientX - startPos.clientX);\n      this.cropRect.width =\n        this.initCropRect.width - (finalMovePos.clientX - startPos.clientX);\n    }\n    if (moveCursorAction.indexOf(\"right\") != -1) {\n      this.cropRect.width =\n        this.initCropRect.width + (finalMovePos.clientX - startPos.clientX);\n    }\n    if (moveCursorAction.indexOf(\"top\") != -1) {\n      this.cropRect.top =\n        this.initCropRect.top + (finalMovePos.clientY - startPos.clientY);\n      this.cropRect.height =\n        this.initCropRect.height - (finalMovePos.clientY - startPos.clientY);\n    }\n    if (moveCursorAction.indexOf(\"bottom\") != -1) {\n      this.cropRect.height =\n        this.initCropRect.height + (finalMovePos.clientY - startPos.clientY);\n    }\n\n    if (this.cropRect.width <= this.boldCornerLen) {\n      this.cropRect.width = this.boldCornerLen;\n    }\n    if (this.cropRect.height <= this.boldCornerLen) {\n      this.cropRect.height = this.boldCornerLen;\n    }\n\n    this.borderDraw(this.$cropCover);\n    this.coverDraw(this.$cropCover);\n  };\n\n  //事件监听\n  SimpleCrop.prototype.bindEvent = function() {\n    var self = this;\n    var controlEvents = this.getControlEvents();\n\n    //旋转刻度盘\n    // ------------------ //\n    self.$cropRotate.addEventListener(controlEvents.start, function(e) {\n      var touches = self.getControlPoints(e);\n      self.startControl(touches);\n    });\n    self.$cropRotate.addEventListener(controlEvents.move, function(e) {\n      var touches = self.getControlPoints(e);\n      if (\n        self._downPoints &&\n        self._downPoints.length > 0 &&\n        !self._multiPoint\n      ) {\n        var point = touches[0];\n        var moveX = point.clientX - self._downPoints[0].clientX;\n        var lastMoveX = self._curMoveX;\n        var curMoveX = lastMoveX + moveX;\n        if (\n          curMoveX <= 0 &&\n          curMoveX >= self.rotateWidth - self.lineationWidth\n        ) {\n          //滚动边界\n          var angle =\n            ((curMoveX - self._baseMoveX) / self.lineationWidth) *\n            (self.endAngle - self.startAngle + self.gapAngle);\n          self._curMoveX = curMoveX;\n          self._changedX = moveX;\n          self.$lineation.style[transformProperty] =\n            \"translateX(\" + curMoveX + \"px)\";\n          var translate = self.getRotateTranslate(\n            self._baseAngle + angle - self.rotateAngle,\n            self.cropCenter\n          );\n          self._contentCurMoveX -= translate.translateX;\n          self._contentCurMoveY += translate.translateY;\n          self.rotateAngle = self._baseAngle + angle;\n          self.transform(true);\n          self._downPoints = touches;\n        }\n      }\n      e.stopPropagation(); //阻止事件冒泡\n      e.preventDefault();\n    });\n    self.$cropRotate.addEventListener(\n      controlEvents.end,\n      self.endControl.bind(self)\n    ); //结束\n    self.$cropRotate.addEventListener(\n      controlEvents.cancel,\n      self.endControl.bind(self)\n    );\n    // ------------------ //\n\n    //裁剪图片移动、双指缩放操作\n    // ------------------ //\n    var $imageListenerEle = self.isSupportTouch\n      ? self.$container\n      : self.$cropMask;\n    $imageListenerEle.addEventListener(controlEvents.start, function(ev) {\n      var touches = self.getControlPoints(ev);\n      self.startControl(touches);\n      self._multiPoint = false;\n      self.moveCursor(touches);\n      if (self._downPoints && self._downPoints.length >= 2) {\n        self._multiPoint = true;\n        var center = {\n          clientX:\n            (self._downPoints[0].clientX + self._downPoints[1].clientX) / 2,\n          clientY:\n            (self._downPoints[0].clientY + self._downPoints[1].clientY) / 2,\n        };\n        self.fingerLen = Math.sqrt(\n          Math.pow(\n            self._downPoints[0].clientX - self._downPoints[1].clientX,\n            2\n          ) +\n            Math.pow(\n              self._downPoints[0].clientY - self._downPoints[1].clientY,\n              2\n            )\n        );\n        self.fingerScale = 1;\n        self.fingerCenter = {\n          //双指操作中心\n          x: center.clientX - self.maskViewSize.width / 2,\n          y: self.maskViewSize.height / 2 - center.clientY,\n        };\n      } else if (self._moveCursor && self._moveCursor.indexOf(\"crop_\") != -1) {\n        self._moveCursorAction = self._moveCursor;\n      }\n    });\n    var options = self.passiveSupported\n      ? {\n          // 如果浏览器支持 passive event listener 为了保证截图操作时页面不滚动需要设置为 false\n          passive: false,\n          capture: false,\n        }\n      : false;\n    $imageListenerEle.addEventListener(\n      controlEvents.move,\n      function(ev) {\n        var touches = self.getControlPoints(ev);\n        if (self._downPoints && self._downPoints.length > 0) {\n          if (!self._multiPoint) {\n            if (!self._moveCursorAction) {\n              self.contentMove(touches); // 单指移动\n            } else {\n              self.cropMove(touches); // 裁剪框移动\n            }\n          } else {\n            // 双指缩放\n            var newFingerLen = Math.sqrt(\n              Math.pow(touches[0].clientX - touches[1].clientX, 2) +\n                Math.pow(touches[0].clientY - touches[1].clientY, 2)\n            );\n            var newScale = newFingerLen / self.fingerLen;\n            self.scaleTimes = (self.scaleTimes / self.fingerScale) * newScale;\n            var translate = self.getScaleTranslate(\n              newScale / self.fingerScale,\n              self.fingerCenter\n            );\n            self._contentCurMoveX -= translate.translateX;\n            self._contentCurMoveY += translate.translateY;\n            self.fingerScale = newScale;\n            self.transform(false, true);\n          }\n        } else {\n          self.moveCursor(touches);\n        }\n        if (self.visible) {\n          //组件显示状态才屏蔽掉一些事件的默认行为，防止组件关闭后继续影响页面\n          ev.preventDefault();\n        }\n      },\n      options\n    );\n    $imageListenerEle.addEventListener(\n      controlEvents.end,\n      self.endControl.bind(self)\n    ); //结束\n    $imageListenerEle.addEventListener(\n      controlEvents.cancel,\n      self.endControl.bind(self)\n    );\n    // ------------------ //\n\n    //鼠标滚轮缩放\n    // ------------------ //\n    $imageListenerEle.addEventListener(\"wheel\", function(e) {\n      if (!self._wheelTimeout) {\n        self.startControl();\n      }\n      e.preventDefault();\n      if (e.wheelDelta > 0) {\n        self.scaleTimes = self.scaleTimes * (e.wheelDelta / 12000 + 1);\n      } else {\n        self.scaleTimes = self.scaleTimes / (1 - e.wheelDelta / 12000);\n      }\n      self.transform(false, true);\n      if (self._wheelTimeout) {\n        clearTimeout(self._wheelTimeout);\n      }\n      self._wheelTimeout = setTimeout(function() {\n        self.endControl();\n        self._wheelTimeout = null;\n      }, 100);\n    });\n    // ------------------ //\n  };\n\n  // 裁剪图片默认以图片中心为基准点，但是实际缩放操作时，操作中心并不一定是图片中心，因此需要计算两者的偏移\n  SimpleCrop.prototype.getScaleTranslate = function(scale, scaleCenter) {\n    var fingerPoints = []; //以双指中心缩放的新坐标\n    var center = this.getPointsCenter(this.contentPoints); //中心点不变\n    for (var i = 0; i < this.contentPoints.length; i++) {\n      var point = this.contentPoints[i];\n      fingerPoints.push({\n        x: point.x * scale - scaleCenter.x * (scale - 1),\n        y: point.y * scale - scaleCenter.y * (scale - 1),\n      });\n    }\n    var newCenter = this.getPointsCenter(fingerPoints);\n    return {\n      translateX: center.x - newCenter.x,\n      translateY: center.y - newCenter.y,\n    };\n  };\n\n  // 裁剪图片默认以图片中心为基准点，但是实际旋转时，操作中心并不一定是图片中心，因此需要计算两者的偏移\n  SimpleCrop.prototype.getRotateTranslate = function(angle, rotateCenter) {\n    var center = this.getPointsCenter(this.contentPoints);\n    var vec = {\n      x: (center.x - rotateCenter.x).toFixed(this._precision),\n      y: (center.y - rotateCenter.y).toFixed(this._precision),\n    };\n    var vLen = this.vecLen(vec);\n    if (vLen > 0 && angle != 0) {\n      var rad = (angle / 180) * Math.PI;\n      var newVec = {\n        x: Math.cos(-rad) * vec.x - Math.sin(-rad) * vec.y,\n        y: Math.sin(-rad) * vec.x + Math.cos(-rad) * vec.y,\n      };\n      return {\n        translateX: vec.x - newVec.x,\n        translateY: vec.y - newVec.y,\n      };\n    } else {\n      return {\n        translateX: 0,\n        translateY: 0,\n      };\n    }\n  };\n\n  //根据图片方向计算源图片实际宽高\n  SimpleCrop.prototype.getRealCotentSize = function() {\n    this.contentWidth = this.originImage.width;\n    this.contentHeight = this.originImage.height;\n    //图片方向大于 4 时宽高互换\n    if (this._orientation > 4) {\n      this.contentWidth = this.originImage.height;\n      this.contentHeight = this.originImage.width;\n    }\n  };\n\n  //处理图片方向\n  SimpleCrop.prototype.transformCoordinates = function() {\n    if (this.$cropContent) {\n      this.$cropMask.removeChild(this.$cropContent);\n    }\n\n    this.$cropContent = document.createElement(\"canvas\");\n    this.$cropContent.width = this.contentWidth;\n    this.$cropContent.height = this.contentHeight;\n    var imageCtx = this.$cropContent.getContext(\"2d\");\n\n    var width = this.originImage.width;\n    var height = this.originImage.height;\n\n    switch (this._orientation) {\n      case 2:\n        // horizontal flip\n        imageCtx.translate(width, 0);\n        imageCtx.scale(-1, 1);\n        break;\n      case 3:\n        // 180° rotate left\n        imageCtx.translate(width, height);\n        imageCtx.rotate(Math.PI);\n        break;\n      case 4:\n        // vertical flip\n        imageCtx.translate(0, height);\n        imageCtx.scale(1, -1);\n        break;\n      case 5:\n        // vertical flip + 90 rotate right\n        imageCtx.rotate(0.5 * Math.PI);\n        imageCtx.scale(1, -1);\n        break;\n      case 6:\n        // 90° rotate right\n        imageCtx.rotate(0.5 * Math.PI);\n        imageCtx.translate(0, -height);\n        break;\n      case 7:\n        // horizontal flip + 90 rotate right\n        imageCtx.rotate(0.5 * Math.PI);\n        imageCtx.translate(width, -height);\n        imageCtx.scale(-1, 1);\n        break;\n      case 8:\n        // 90° rotate left\n        imageCtx.rotate(-0.5 * Math.PI);\n        imageCtx.translate(-width, 0);\n        break;\n    }\n    imageCtx.drawImage(this.originImage, 0, 0, width, height);\n\n    //初始位置垂直水平居中\n    this._initTransform = \"translate3d(-50%,-50%,0)\";\n    this.$cropContent.classList.add(\"crop-content\");\n    this.$cropContent.style.position = \"absolute\";\n    this.$cropContent.style.left = \"50%\";\n    this.$cropContent.style.top = \"50%\";\n    this.$cropContent.style[transformProperty] = this._initTransform;\n    this.$cropMask.insertBefore(this.$cropContent, this.$cropCover);\n  };\n\n  //获取裁剪图片\n  SimpleCrop.prototype.getCropImage = function() {\n    var scaleNum = (this.scaleTimes / this.times) * this._rotateScale;\n    var contentWidth = this.contentWidth;\n    var contentHeight = this.contentHeight;\n    var cropWidth = this.size.width;\n    var cropHeight = this.size.height;\n\n    //需要考虑裁剪图片实际尺寸比裁剪尺寸小的情况\n    var ratio = 1;\n    if (contentWidth < cropWidth || contentHeight < cropHeight) {\n      // 裁剪中间画布尺寸必须大于实际裁剪尺寸\n      if (cropWidth / contentWidth > cropHeight / contentHeight) {\n        ratio = cropWidth / contentWidth;\n        contentHeight = contentHeight * ratio;\n        contentWidth = cropWidth;\n      } else {\n        ratio = cropHeight / contentHeight;\n        contentWidth = contentWidth * ratio;\n        contentHeight = cropHeight;\n      }\n    }\n    var center = {\n      x: contentWidth / 2,\n      y: contentHeight / 2,\n    };\n\n    var $contentCanvas = document.createElement(\"canvas\");\n    $contentCanvas.width = contentWidth;\n    $contentCanvas.height = contentHeight;\n    var contentCtx = $contentCanvas.getContext(\"2d\");\n    contentCtx.translate(center.x, center.y);\n    contentCtx.scale(\n      (scaleNum * this.times) / ratio,\n      (scaleNum * this.times) / ratio\n    ); // 缩放 this.times\n    contentCtx.translate(\n      ((this._contentCurMoveX + this.positionOffset.left) / scaleNum) * ratio,\n      ((this._contentCurMoveY + this.positionOffset.top) / scaleNum) * ratio\n    );\n    contentCtx.rotate((this.rotateAngle / 180) * Math.PI);\n    contentCtx.translate(-center.x, -center.y);\n    contentCtx.drawImage(this.$cropContent, 0, 0, contentWidth, contentHeight);\n\n    var $cropCanvas = document.createElement(\"canvas\");\n    $cropCanvas.width = cropWidth;\n    $cropCanvas.height = cropHeight;\n    var cropCtx = $cropCanvas.getContext(\"2d\");\n    cropCtx.drawImage(\n      $contentCanvas,\n      (contentWidth - cropWidth) / 2,\n      (contentHeight - cropHeight) / 2,\n      cropWidth,\n      cropHeight,\n      0,\n      0,\n      cropWidth,\n      cropHeight\n    );\n    this.$resultCanvas = $cropCanvas;\n  };\n\n  //操作结束\n  SimpleCrop.prototype.endControl = function() {\n    if (this._isControl) {\n      var self = this;\n      this._downPoints = [];\n\n      // 拖动裁剪框\n      if (this._moveCursorAction) {\n        const newSize = {\n          width:\n            (this.cropRect.width / this.initCropRect.width) * this.size.width,\n          height:\n            (this.cropRect.height / this.initCropRect.height) *\n            this.size.height,\n        };\n        const newTimes =\n          newSize.width / this.maskViewSize.width >\n          newSize.height / this.maskViewSize.height\n            ? newSize.width / this.maskViewSize.width / this.cropSizePercent\n            : newSize.height / this.maskViewSize.height / this.cropSizePercent;\n\n        // 求新裁剪框四个顶点与原有裁剪框相应顶点距离最近的顶点\n        var newRectPoints = this.rectToPoints(this.cropRect);\n        var newRectCenter = this.getPointsCenter(newRectPoints);\n        var pLens = [];\n        for (var i = 0; i < newRectPoints.length; i++) {\n          pLens.push(\n            this.vecLen({\n              x: newRectPoints[i].x - this.cropPoints[i].x,\n              y: newRectPoints[i].y - this.cropPoints[i].y,\n            })\n          );\n        }\n        var minIndexs = [0];\n        var minLen = pLens[0];\n        for (var j = 1; j < pLens.length; j++) {\n          if (pLens[j] < minLen) {\n            minLen = pLens[j];\n            minIndexs = [j];\n          } else if (pLens[j] == minLen) {\n            minIndexs.push(j);\n          }\n        }\n\n        // 拖动缩放中心点\n        var cropScaleCenter = {\n          x: this.cropPoints[minIndexs[0]].x,\n          y: this.cropPoints[minIndexs[0]].y,\n        };\n        if (minIndexs.length == 2) {\n          cropScaleCenter.x =\n            (this.cropPoints[minIndexs[0]].x +\n              this.cropPoints[minIndexs[1]].x) /\n            2;\n          cropScaleCenter.y =\n            (this.cropPoints[minIndexs[0]].y +\n              this.cropPoints[minIndexs[1]].y) /\n            2;\n        }\n\n        // 判断裁剪框拖动方向\n        var moveCursorAction = this._moveCursorAction.toLowerCase();\n        this._moveCursorAction = null;\n        var horizontal =\n          moveCursorAction.indexOf(\"left\") != -1 ||\n          moveCursorAction.indexOf(\"right\") != -1; // 裁剪框水平移动\n        var vertical =\n          moveCursorAction.indexOf(\"top\") != -1 ||\n          moveCursorAction.indexOf(\"bottom\") != -1; // 裁剪框竖直移动\n\n        // 拖动缩放系数\n        var cropScale = horizontal\n          ? this.initCropRect.width / this.cropRect.width\n          : this.initCropRect.height / this.cropRect.height;\n        var translate = self.getScaleTranslate(cropScale, {\n          x: cropScaleCenter.x,\n          y: cropScaleCenter.y,\n        });\n\n        // 拖动缩放位移\n        if (horizontal && vertical) {\n          this._contentCurMoveX -= translate.translateX;\n          this._contentCurMoveY += translate.translateY;\n        } else if (horizontal) {\n          if (\n            Math.abs(this.times / newTimes - cropScale).toFixed(\n              this._precision\n            ) == 0\n          ) {\n            this._contentCurMoveX -=\n              ((translate.translateX * cropScale) / this.times) * newTimes;\n          } else {\n            this._contentCurMoveX -= newRectCenter.x - this.positionOffset.left;\n            this._contentCurMoveX *= this.times / newTimes;\n          }\n        } else if (vertical) {\n          if (\n            Math.abs(this.times / newTimes - cropScale).toFixed(\n              this._precision\n            ) == 0\n          ) {\n            this._contentCurMoveY +=\n              ((translate.translateY * cropScale) / this.times) * newTimes;\n          } else {\n            this._contentCurMoveY += newRectCenter.y - this.positionOffset.top;\n            this._contentCurMoveY *= this.times / newTimes;\n          }\n        }\n\n        // 更新裁剪框\n        this.updateBox({\n          positionOffset: this.positionOffset,\n          cropSizePercent: this.cropSizePercent,\n          size: {\n            width: newSize.width,\n            height: newSize.height,\n          },\n        });\n      }\n\n      if (\n        this.$cropContent &&\n        !this.isWholeCover(this.contentPoints, this.cropPoints)\n      ) {\n        //如果没有完全包含则需要进行适配变换\n        var scaleNum = (this.scaleTimes / this.times) * this._rotateScale;\n        var transform = \"\";\n        transform += \" scale(\" + scaleNum + \")\"; //缩放\n        transform +=\n          \" translateX(\" +\n          this._contentCurMoveX / scaleNum +\n          \"px) translateY(\" +\n          this._contentCurMoveY / scaleNum +\n          \"px)\"; //移动\n        transform += \" rotate(\" + this.rotateAngle + \"deg) \";\n\n        //适配变换\n        var coverTr = this.getCoverTransform(transform);\n        var coverMat = this.getTransformMatrix(coverTr);\n        this._contentCurMoveX = coverMat.e;\n        this._contentCurMoveY = coverMat.f;\n        this.contentPoints = this.getTransformPoints(\n          \"scaleY(-1)\" + coverTr,\n          this.initContentPoints\n        );\n\n        if (!this.debug) {\n          this.$cropContent.style[transformProperty] =\n            this._initTransform + coverTr;\n        } else {\n          this.$cropContent.style[transitionProperty] = \"transform .5s linear\";\n          var start = coverTr.indexOf(transform) + transform.length;\n          var coverTrAr = coverTr\n            .substring(start, coverTr.length)\n            .trim()\n            .split(\" \");\n          var no = 0;\n          var tr = this._initTransform + transform + coverTrAr[no];\n          this.$cropContent.style[transformProperty] = tr;\n          this.$cropContent.addEventListener(transitionEndEvent, function() {\n            no++;\n            if (no < coverTr.length) {\n              tr += coverTrAr[no];\n              self.$cropContent.style[transformProperty] = tr;\n            }\n          });\n        }\n      }\n\n      this._isControl = false;\n    }\n  };\n\n  //操作开始\n  SimpleCrop.prototype.startControl = function(touches) {\n    touches = touches ? touches : [];\n    if (!this._isControl || this.isTwoFingerEvent(touches)) {\n      this._isControl = true;\n      if (this.$cropContent) {\n        this.$cropContent.style[transitionProperty] = \"none\";\n      }\n      this._downPoints = touches;\n    }\n  };\n\n  //双指操作事件\n  SimpleCrop.prototype.isTwoFingerEvent = function(touches) {\n    /**\n     * 微信小程序双指操作时，会触发两次 touchstart 事件且前后两次事件触摸点坐标有一个坐标相同\n     */\n    if (\n      this._isControl &&\n      this._downPoints &&\n      this._downPoints.length == 1 &&\n      touches.length >= 2 &&\n      ((touches[0].clientX == this._downPoints[0].clientX &&\n        touches[0].clientY == this._downPoints[0].clientY) ||\n        (touches[1].clientX == this._downPoints[0].clientX &&\n          touches[1].clientY == this._downPoints[0].clientY))\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  //内容图片移动\n  SimpleCrop.prototype.contentMove = function(touches) {\n    var point = touches[0];\n    var moveX = point.clientX - this._downPoints[0].clientX;\n    var moveY = point.clientY - this._downPoints[0].clientY;\n\n    this._contentCurMoveX += moveX;\n    this._contentCurMoveY += moveY;\n    this._downPoints = touches;\n\n    this.transform();\n  };\n\n  //旋转、缩放、移动\n  SimpleCrop.prototype.transform = function(rotateCover, scaleKeepCover) {\n    if (this.$cropContent) {\n      var scaleNum = (this.scaleTimes / this.times) * this._rotateScale;\n      var transform = \"\";\n      transform += \" scale(\" + scaleNum + \")\"; //缩放\n      transform +=\n        \" translateX(\" +\n        this._contentCurMoveX / scaleNum +\n        \"px) translateY(\" +\n        this._contentCurMoveY / scaleNum +\n        \"px)\"; //移动\n      transform += \" rotate(\" + this.rotateAngle + \"deg)\";\n\n      if (scaleKeepCover) {\n        //缩放时为了保证裁剪框不出现空白，需要在原有变换的基础上再进行一定的位移变换\n        transform = this.getCoverTransform(transform, true);\n        var scMat = this.getTransformMatrix(transform);\n        this._contentCurMoveX = scMat.e;\n        this._contentCurMoveY = scMat.f;\n      }\n\n      if (rotateCover) {\n        //旋转时需要保证裁剪框不出现空白，需要在原有变换的基础上再进行一定的适配变换\n        var rotatePoints = this.getTransformPoints(\n          \"scaleY(-1)\" + transform,\n          this.initContentPoints\n        );\n        var coverScale = this.getCoverRectScale(rotatePoints, this.cropPoints);\n        var changedX = this._changedX;\n        var curMoveX = this._curMoveX;\n        var totalMoveX = curMoveX - changedX - this._baseMoveX;\n        var rotateCenter = this.getPointsCenter(rotatePoints);\n        var centerVec = {\n          x: rotateCenter.x - this.cropCenter.x,\n          y: rotateCenter.y - this.cropCenter.y,\n        };\n        var percent = Math.abs(changedX) / Math.abs(totalMoveX);\n        if (coverScale > 1) {\n          this._rotateScale = this._rotateScale * coverScale;\n          scaleNum = scaleNum * coverScale;\n        } else if (this.vecLen(centerVec) < 1 && percent > 0) {\n          //中心点接近重合时，旋转支持自适应缩小\n          if (coverScale < 1 - percent) {\n            //不能突变\n            coverScale = 1 - percent;\n          }\n          if (this._rotateScale * coverScale > 1) {\n            this._rotateScale = this._rotateScale * coverScale;\n          } else {\n            //不能影响 scaleTimes\n            this._rotateScale = 1;\n            coverScale = 1;\n          }\n          scaleNum = scaleNum * coverScale;\n        }\n      }\n\n      //操作变换\n      transform = \"\";\n      transform += \" scale(\" + scaleNum + \")\"; //缩放\n      transform +=\n        \" translateX(\" +\n        this._contentCurMoveX / scaleNum +\n        \"px) translateY(\" +\n        this._contentCurMoveY / scaleNum +\n        \"px)\"; //移动\n      transform += \" rotate(\" + this.rotateAngle + \"deg)\";\n      this.$cropContent.style[transformProperty] =\n        this._initTransform + transform;\n      this.contentPoints = this.getTransformPoints(\n        \"scaleY(-1)\" + transform,\n        this.initContentPoints\n      );\n    }\n  };\n\n  //计算一个矩形刚好包含另一个矩形需要的缩放倍数\n  SimpleCrop.prototype.getCoverRectScale = function(outer, inner) {\n    var scale = 0;\n    for (var i = 0; i < inner.length; i++) {\n      var num = this.getCoverPointScale(inner[i], outer);\n      if (num > scale) {\n        scale = num;\n      }\n    }\n    return scale;\n  };\n\n  //判断 矩形A 是否完全包含 矩形B\n  SimpleCrop.prototype.isWholeCover = function(rectA, rectB) {\n    for (var i = 0; i < rectB.length; i++) {\n      if (!this.isPointInRectCheckByLen(rectB[i], rectA)) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n  //计算一个矩形刚好包含矩形外一点需要的缩放倍数\n  SimpleCrop.prototype.getCoverPointScale = function(point, rectPoints) {\n    var pcv = this.getPCVectorProjOnUpAndRight(point, rectPoints);\n\n    //计算矩形外一点到矩形中心向量在矩形边框向量上的投影距离\n    var uLen = this.vecLen(pcv.uproj);\n    var height = this.vecLen(pcv.up) / 2;\n    var rLen = this.vecLen(pcv.rproj);\n    var width = this.vecLen(pcv.right) / 2;\n\n    //根据投影距离计算缩放倍数\n    if (uLen / height > rLen / width) {\n      return 1 + (uLen - height) / height;\n    } else {\n      return 1 + (rLen - width) / width;\n    }\n  };\n\n  //计算图片内容刚好包含裁剪框的transform变换\n  SimpleCrop.prototype.getCoverTransform = function(transform, onlyTranslate) {\n    var cRect = this.getCoveRect(this.cropPoints, this.rotateAngle);\n    onlyTranslate = onlyTranslate ? onlyTranslate : false;\n\n    //计算放大倍数\n    var uScale = 1; //水平缩放倍数和垂直缩放倍数\n    var rScale = 1;\n    var cup = {\n      x: this.contentPoints[1].x - this.contentPoints[2].x,\n      y: this.contentPoints[1].y - this.contentPoints[2].y,\n    };\n    var cright = {\n      x: this.contentPoints[1].x - this.contentPoints[0].x,\n      y: this.contentPoints[1].y - this.contentPoints[0].y,\n    };\n    var tup = {\n      x: cRect[1].x - cRect[2].x,\n      y: cRect[1].y - cRect[2].y,\n    };\n    var tright = {\n      x: cRect[1].x - cRect[0].x,\n      y: cRect[1].y - cRect[0].y,\n    };\n    var uAng = this.vecAngle(cup, tup);\n    if (\n      Math.abs(180 - uAng) < Math.abs(90 - uAng) ||\n      Math.abs(0 - uAng) < Math.abs(90 - uAng)\n    ) {\n      //更接近180或者0\n      uScale = this.vecLen(tup) / this.vecLen(cup);\n      rScale = this.vecLen(tright) / this.vecLen(cright);\n    } else {\n      uScale = this.vecLen(tup) / this.vecLen(cright);\n      rScale = this.vecLen(tright) / this.vecLen(cup);\n    }\n    uScale = uScale < 1 ? 1 : uScale;\n    rScale = rScale < 1 ? 1 : rScale;\n\n    var scale = uScale > rScale ? uScale : rScale;\n\n    if (onlyTranslate && scale > 1) {\n      return transform;\n    }\n\n    //复制坐标\n    var scalePoints = [];\n    for (var i = 0; i < this.contentPoints.length; i++) {\n      scalePoints.push({\n        x: this.contentPoints[i].x,\n        y: this.contentPoints[i].y,\n      });\n    }\n\n    //计算放大后的新坐标\n    if (scale > 1) {\n      transform += \" scale(\" + scale + \")\";\n      this.scaleTimes = this.scaleTimes * scale;\n      //this._rotateScale = this._rotateScale * scale; // this._rotateScale 只能受旋转角度影响\n      scalePoints = this.getTransformPoints(\n        \"scaleY(-1)\" + transform,\n        this.initContentPoints\n      );\n    }\n\n    //位移变换\n    var scaleNum = (this.scaleTimes / this.times) * this._rotateScale;\n    var count = 0;\n    var self = this;\n    var outDetails = [];\n    do {\n      //找出裁剪框超出的顶点\n      outDetails = this.getOutDetails(this.cropPoints, scalePoints);\n      if (outDetails.length > 0) {\n        count++;\n        outDetails.sort(function(a, b) {\n          //找出距离最远的点\n          var aLen = self.vecLen(a.iv);\n          var bLen = self.vecLen(b.iv);\n          if (aLen < bLen) {\n            return 1;\n          }\n          if (aLen > bLen) {\n            return -1;\n          }\n          return 0;\n        });\n\n        //开始移动\n        var maxFarOut = outDetails[0];\n        var maxFarPcv = maxFarOut.pcv;\n\n        //计算X轴位移\n        uAng = this.vecAngle(maxFarPcv.up, maxFarPcv.uproj);\n        var uLen = this.vecLen(maxFarPcv.uproj);\n        var moveY = 0;\n\n        //if(uAng == 0){ //同方向\n        if (Math.abs(uAng) < 90) {\n          //浮点数精度问题，接近0时小于90 ，接近180时大于90\n          moveY = -uLen * maxFarOut.uOver;\n        } else {\n          moveY = uLen * maxFarOut.uOver;\n        }\n        if (moveY != 0) {\n          transform += \" translateY(\" + moveY / scaleNum + \"px)\";\n        }\n\n        //计算Y轴位移\n        var rAng = this.vecAngle(maxFarPcv.right, maxFarPcv.rproj);\n        var rLen = this.vecLen(maxFarPcv.rproj);\n        var moveX = 0;\n\n        if (Math.abs(rAng) < 90) {\n          //同方向\n          moveX = rLen * maxFarOut.rOver;\n        } else {\n          moveX = -rLen * maxFarOut.rOver;\n        }\n        if (moveX != 0) {\n          transform += \" translateX(\" + moveX / scaleNum + \"px)\";\n        }\n\n        //计算位移后的新坐标\n        if (moveX != 0 || moveY != 0) {\n          for (i = 0; i < scalePoints.length; i++) {\n            (scalePoints[i].x = scalePoints[i].x + maxFarOut.iv.x),\n              (scalePoints[i].y = scalePoints[i].y + maxFarOut.iv.y);\n          }\n        }\n      }\n    } while (count < 2 && outDetails.length > 0);\n\n    return transform;\n  };\n\n  //找出一个矩形在另一个矩形外的顶点数据\n  SimpleCrop.prototype.getOutDetails = function(inner, outer) {\n    var outDetails = [];\n    for (var i = 0; i < inner.length; i++) {\n      var pt = inner[i];\n      if (!this.isPointInRectCheckByLen(pt, outer)) {\n        var pcv = this.getPCVectorProjOnUpAndRight(pt, outer);\n        var iv = {\n          x: 0,\n          y: 0,\n        };\n        var uLen = this.vecLen(pcv.uproj);\n        var height = this.vecLen(pcv.up) / 2;\n        var rLen = this.vecLen(pcv.rproj);\n        var width = this.vecLen(pcv.right) / 2;\n        var uOver = 0;\n        var rOver = 0;\n        if (uLen > height) {\n          uOver = (uLen - height) / uLen;\n          iv.x += pcv.uproj.x * uOver;\n          iv.y += pcv.uproj.y * uOver;\n        }\n        if (rLen > width) {\n          rOver = (rLen - width) / rLen;\n          iv.x += pcv.rproj.x * rOver;\n          iv.y += pcv.rproj.y * rOver;\n        }\n        outDetails.push({\n          x: pt.x,\n          y: pt.y,\n          iv: iv,\n          uOver: uOver,\n          rOver: rOver,\n          pcv: pcv,\n        });\n      }\n    }\n    return outDetails;\n  };\n\n  //获取刚好包含某个矩形的新矩形\n  SimpleCrop.prototype.getCoveRect = function(rect, angle) {\n    if (angle < 0) {\n      angle = 90 + (angle % 90);\n    } else {\n      angle = angle % 90;\n    }\n    var rad = (angle / 180) * Math.PI;\n\n    var up = {\n      x: rect[1].x - rect[2].x,\n      y: rect[1].y - rect[2].y,\n    };\n    var right = {\n      x: rect[1].x - rect[0].x,\n      y: rect[1].y - rect[0].y,\n    };\n    var rLen = this.vecLen(right);\n    var uLen = this.vecLen(up);\n\n    var nRect = [];\n    nRect[0] = {};\n    nRect[0].x = rect[0].x + rLen * Math.sin(rad) * Math.sin(rad);\n    nRect[0].y = rect[0].y + rLen * Math.sin(rad) * Math.cos(rad);\n\n    nRect[1] = {};\n    nRect[1].x = rect[1].x + uLen * Math.sin(rad) * Math.cos(rad);\n    nRect[1].y = rect[1].y - uLen * Math.sin(rad) * Math.sin(rad);\n\n    nRect[2] = {};\n    nRect[2].x = rect[2].x - rLen * Math.sin(rad) * Math.sin(rad);\n    nRect[2].y = rect[2].y - rLen * Math.sin(rad) * Math.cos(rad);\n\n    nRect[3] = {};\n    nRect[3].x = rect[3].x - uLen * Math.sin(rad) * Math.cos(rad);\n    nRect[3].y = rect[3].y + uLen * Math.sin(rad) * Math.sin(rad);\n\n    return nRect;\n  };\n\n  //计算新的变换坐标\n  SimpleCrop.prototype.getTransformPoints = function(transform, points) {\n    var matrix = this.getTransformMatrix(transform);\n    var nPoints = [];\n    for (var i = 0; i < points.length; i++) {\n      var item = {\n        x: points[i].x,\n        y: points[i].y,\n      };\n      item = TransformationMatrix.applyToPoint(matrix, item);\n      nPoints.push(item);\n    }\n    nPoints.reverse(); //顶点顺序发生了变化，需要颠倒\n\n    return nPoints;\n  };\n\n  //获得矩形点坐标中心\n  SimpleCrop.prototype.getPointsCenter = function(points) {\n    var center = {\n      x: (points[0].x + points[2].x) / 2,\n      y: (points[0].y + points[2].y) / 2,\n    };\n    return center;\n  };\n\n  //矩形位置形式转换为顶点坐标形式\n  SimpleCrop.prototype.rectToPoints = function(rect) {\n    var points = [];\n    points.push({\n      x: -(this.maskViewSize.width / 2 - rect.left),\n      y: this.maskViewSize.height / 2 - rect.top,\n    });\n    points.push({\n      x: points[0].x + rect.width,\n      y: points[0].y,\n    });\n    points.push({\n      x: points[1].x,\n      y: points[1].y - rect.height,\n    });\n    points.push({\n      x: points[0].x,\n      y: points[2].y,\n    });\n\n    return points;\n  };\n\n  //获取 css transform 属性对应的矩形形式\n  SimpleCrop.prototype.getTransformMatrix = function(transform) {\n    var transforms = transform.split(\" \");\n    var params = [];\n    for (var i = 0; i < transforms.length; i++) {\n      if (transforms[i].trim() != \"\") {\n        // 不能为空\n        var func = this.getTransformFunctionName(transforms[i]);\n        var result;\n        if (func.name != \"rotate\") {\n          result = TransformationMatrix[func.name](\n            func.params[0],\n            func.params[1]\n          );\n        } else {\n          result = TransformationMatrix[func.name](func.params[0]);\n        }\n        params.push(result);\n      }\n    }\n\n    return TransformationMatrix.compose(params);\n  };\n\n  //根据 css transform 属性获取 transformation-matrix 对应的函数名称以及参数\n  SimpleCrop.prototype.getTransformFunctionName = function(transform) {\n    var start = transform.indexOf(\"(\");\n    var end = transform.indexOf(\")\");\n    var func = {};\n\n    //参数\n    var params = transform.substring(start + 1, end).split(\",\");\n    var arr = [];\n    for (var i = 0; i < params.length; i++) {\n      arr.push(parseFloat(params[i]));\n    }\n    func.params = arr;\n\n    //名称\n    var name = transform.substring(0, start).toLowerCase();\n    var defParams = 0; //默认参数\n    if (name.indexOf(\"scale\") != -1) {\n      func.name = \"scale\";\n      defParams = 1;\n    } else if (name.indexOf(\"translate\") != -1) {\n      func.name = \"translate\";\n    } else if (name.indexOf(\"skew\") != -1) {\n      func.name = \"skewDEG\";\n    } else if (name.indexOf(\"rotate\") != -1) {\n      func.name = \"rotateDEG\"; // 角度\n    }\n\n    //加入默认参数\n    if (name.indexOf(\"x\") != -1) {\n      func.params.push(defParams);\n    } else if (name.indexOf(\"y\") != -1) {\n      func.params.unshift(defParams);\n    } else if (name.indexOf(\"rotate\") == -1 && func.params.length <= 1) {\n      // 除了 rotate 其它函数支持 x、y 两个参数，如果 css transform 属性参数只有一个则另一个参数也是如此。\n      func.params.push(func.params[0]);\n    }\n\n    return func;\n  };\n\n  //计算向量 a 在向量 b 上的投影向量\n  SimpleCrop.prototype.getProjectionVector = function(vecA, vecB) {\n    var bLen = this.vecLen(vecB);\n    var ab = vecA.x * vecB.x + vecA.y * vecB.y;\n\n    var proj = {\n      x: (ab / Math.pow(bLen, 2)) * vecB.x,\n      y: (ab / Math.pow(bLen, 2)) * vecB.y,\n    };\n\n    return proj;\n  };\n\n  //计算矩形中心到某点的向量在矩形自身坐标系上方向和右方向上的投影向量\n  SimpleCrop.prototype.getPCVectorProjOnUpAndRight = function(\n    point,\n    rectPoints\n  ) {\n    //计算矩形自身坐标系的上方向向量和右方向向量\n    var up = {\n      x: rectPoints[1].x - rectPoints[2].x,\n      y: rectPoints[1].y - rectPoints[2].y,\n    };\n    var right = {\n      x: rectPoints[1].x - rectPoints[0].x,\n      y: rectPoints[1].y - rectPoints[0].y,\n    };\n\n    //计算矩形中心点\n    var center = this.getPointsCenter(rectPoints);\n    var line = {\n      x: point.x - center.x,\n      y: point.y - center.y,\n    };\n\n    var uproj = this.getProjectionVector(line, up);\n    var rproj = this.getProjectionVector(line, right);\n\n    return {\n      up: up,\n      uproj: uproj,\n      right: right,\n      rproj: rproj,\n    };\n  };\n\n  //根据矩形中心到某一点向量在矩形边框向量的投影长度判断该点是否在矩形内\n  SimpleCrop.prototype.isPointInRectCheckByLen = function(point, rectPoints) {\n    var pcv = this.getPCVectorProjOnUpAndRight(point, rectPoints);\n\n    var uLen = Math.round(this.vecLen(pcv.uproj) * this._precision);\n    var height = Math.round((this.vecLen(pcv.up) / 2) * this._precision);\n    var rLen = Math.round(this.vecLen(pcv.rproj) * this._precision);\n    var width = Math.round((this.vecLen(pcv.right) / 2) * this._precision);\n\n    if (uLen <= height && rLen <= width) {\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  //根据角度和判断点是否在矩形内\n  SimpleCrop.prototype.isPointInRectCheckByAngle = function(point, rectPoints) {\n    //先计算四个向量\n    var vecs = [];\n    for (var i = 0; i < rectPoints.length; i++) {\n      var p = rectPoints[i];\n      vecs.push({\n        x: p.x - point.x,\n        y: p.y - point.y,\n      });\n    }\n\n    //计算模最小向量\n    var sIndex = 0;\n    var sLen = 0;\n    for (i = 0; i < vecs.length; i++) {\n      var len = this.vecLen(vecs[i]);\n      if (len == 0 || len < sLen) {\n        sIndex = i;\n        sLen = len;\n      }\n    }\n    len = vecs.length;\n    var sVec = vecs.splice(sIndex, 1)[0];\n    var tVec = sVec;\n    var eVec;\n\n    //依次计算四个向量的夹角\n    var angles = [];\n    for (i = 1; i < len; i++) {\n      var data = this.getMinAngle(tVec, vecs);\n      tVec = data.vec;\n      vecs.splice(data.index, 1);\n      angles.push(data.angle);\n\n      if (vecs.length == 1) {\n        eVec = vecs[0];\n      }\n    }\n    angles.push(this.getMinAngle(eVec, [sVec]).angle);\n\n    var sum = 0;\n    for (i = 0; i < angles.length; i++) {\n      sum += angles[i];\n    }\n\n    // 向量之间的夹角等于360度则表示点在矩形内\n    sum = sum.toFixed(this._precision);\n    if (sum < 360) {\n      return false;\n    } else {\n      return true;\n    }\n  };\n\n  //计算向量数组的中向量和目标向量的最小夹角\n  SimpleCrop.prototype.getMinAngle = function(tVec, aVec) {\n    var minAngle = this.vecAngle(tVec, aVec[0]);\n    var minIndex = 0;\n    for (var i = 1; i < aVec.length; i++) {\n      var angle = this.vecAngle(tVec, aVec[i]);\n      if (angle < minAngle) {\n        minAngle = angle;\n        minIndex = i;\n      }\n    }\n    return {\n      angle: minAngle,\n      vec: aVec[minIndex],\n      index: minIndex,\n    };\n  };\n\n  //计算向量夹角\n  SimpleCrop.prototype.vecAngle = function(vec1, vec2) {\n    var acos =\n      (vec1.x * vec2.x + vec1.y * vec2.y) /\n      (this.vecLen(vec1) * this.vecLen(vec2));\n    if (Math.abs(acos) > 1) {\n      //因为浮点数精度结果有可能超过1，Math.acos(1.0000001) = NaN\n      acos = acos > 0 ? 1 : -1;\n    }\n    var rad = Math.acos(acos);\n    var angle = (rad * 180) / Math.PI;\n    return angle;\n  };\n\n  //计算向量的模\n  SimpleCrop.prototype.vecLen = function(vec) {\n    return Math.sqrt(vec.x * vec.x + vec.y * vec.y);\n  };\n\n  //file转image\n  SimpleCrop.prototype.fileToSrc = function(file, callback) {\n    var reader = new FileReader();\n    reader.onload = function(e) {\n      callback(e.target.result);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  return SimpleCrop;\n});\n","(function (factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node/CommonJS\n        module.exports = factory(require());\n    } else {\n        // Browser globals\n        window.Prefix = factory();\n    }\n}(function () {\n\n    var style = typeof document != 'undefined'\n        ? document.createElement('p').style\n        : {}\n\n    var prefixes = ['O', 'ms', 'Moz', 'Webkit']\n    var upper = /([A-Z])/g\n    var memo = {}\n\n    /**\n     * prefix `key`\n     * prefix('transform') // => WebkitTransform\n     *\n     * @param {String} key\n     * @return {String}\n     * @api public\n     */\n    function prefix(key){\n        // Camel case\n        key = key.replace(/-([a-z])/g, function(_, char){\n            return char.toUpperCase()\n        })\n\n        // Without prefix\n        if (style[key] !== undefined) return key\n\n        // With prefix\n        var Key = key.charAt(0).toUpperCase() + key.slice(1)\n        var i = prefixes.length\n        while (i--) {\n            var name = prefixes[i] + Key\n            if (style[name] !== undefined) return name\n        }\n\n        return key\n    }\n\n    /**\n     * Memoized version of `prefix`\n     *\n     * @param {String} key\n     * @return {String}\n     * @api public\n     */\n    function prefixMemozied(key){\n        return key in memo\n            ? memo[key]\n            : memo[key] = prefix(key)\n    }\n\n    /**\n     * Create a dashed prefix\n     *\n     * @param {String} key\n     * @return {String}\n     * @api public\n     */\n    function prefixDashed(key){\n        key = prefix(key)\n        if (upper.test(key)) {\n            key = key.replace(upper, '-$1')\n            upper.lastIndex = 0\n        }\n        return key.toLowerCase()\n    }\n\n    return {\n        prefix : prefixMemozied,\n        dash : prefixDashed\n    }\n}));","(function() {\n\n    var debug = false;\n\n    var root = this;\n\n    var EXIF = function(obj) {\n        if (obj instanceof EXIF) return obj;\n        if (!(this instanceof EXIF)) return new EXIF(obj);\n        this.EXIFwrapped = obj;\n    };\n\n    if (typeof exports !== 'undefined') {\n        if (typeof module !== 'undefined' && module.exports) {\n            exports = module.exports = EXIF;\n        }\n        exports.EXIF = EXIF;\n    } else {\n        root.EXIF = EXIF;\n    }\n\n    var ExifTags = EXIF.Tags = {\n\n        // version tags\n        0x9000 : \"ExifVersion\",             // EXIF version\n        0xA000 : \"FlashpixVersion\",         // Flashpix format version\n\n        // colorspace tags\n        0xA001 : \"ColorSpace\",              // Color space information tag\n\n        // image configuration\n        0xA002 : \"PixelXDimension\",         // Valid width of meaningful image\n        0xA003 : \"PixelYDimension\",         // Valid height of meaningful image\n        0x9101 : \"ComponentsConfiguration\", // Information about channels\n        0x9102 : \"CompressedBitsPerPixel\",  // Compressed bits per pixel\n\n        // user information\n        0x927C : \"MakerNote\",               // Any desired information written by the manufacturer\n        0x9286 : \"UserComment\",             // Comments by user\n\n        // related file\n        0xA004 : \"RelatedSoundFile\",        // Name of related sound file\n\n        // date and time\n        0x9003 : \"DateTimeOriginal\",        // Date and time when the original image was generated\n        0x9004 : \"DateTimeDigitized\",       // Date and time when the image was stored digitally\n        0x9290 : \"SubsecTime\",              // Fractions of seconds for DateTime\n        0x9291 : \"SubsecTimeOriginal\",      // Fractions of seconds for DateTimeOriginal\n        0x9292 : \"SubsecTimeDigitized\",     // Fractions of seconds for DateTimeDigitized\n\n        // picture-taking conditions\n        0x829A : \"ExposureTime\",            // Exposure time (in seconds)\n        0x829D : \"FNumber\",                 // F number\n        0x8822 : \"ExposureProgram\",         // Exposure program\n        0x8824 : \"SpectralSensitivity\",     // Spectral sensitivity\n        0x8827 : \"ISOSpeedRatings\",         // ISO speed rating\n        0x8828 : \"OECF\",                    // Optoelectric conversion factor\n        0x9201 : \"ShutterSpeedValue\",       // Shutter speed\n        0x9202 : \"ApertureValue\",           // Lens aperture\n        0x9203 : \"BrightnessValue\",         // Value of brightness\n        0x9204 : \"ExposureBias\",            // Exposure bias\n        0x9205 : \"MaxApertureValue\",        // Smallest F number of lens\n        0x9206 : \"SubjectDistance\",         // Distance to subject in meters\n        0x9207 : \"MeteringMode\",            // Metering mode\n        0x9208 : \"LightSource\",             // Kind of light source\n        0x9209 : \"Flash\",                   // Flash status\n        0x9214 : \"SubjectArea\",             // Location and area of main subject\n        0x920A : \"FocalLength\",             // Focal length of the lens in mm\n        0xA20B : \"FlashEnergy\",             // Strobe energy in BCPS\n        0xA20C : \"SpatialFrequencyResponse\",    //\n        0xA20E : \"FocalPlaneXResolution\",   // Number of pixels in width direction per FocalPlaneResolutionUnit\n        0xA20F : \"FocalPlaneYResolution\",   // Number of pixels in height direction per FocalPlaneResolutionUnit\n        0xA210 : \"FocalPlaneResolutionUnit\",    // Unit for measuring FocalPlaneXResolution and FocalPlaneYResolution\n        0xA214 : \"SubjectLocation\",         // Location of subject in image\n        0xA215 : \"ExposureIndex\",           // Exposure index selected on camera\n        0xA217 : \"SensingMethod\",           // Image sensor type\n        0xA300 : \"FileSource\",              // Image source (3 == DSC)\n        0xA301 : \"SceneType\",               // Scene type (1 == directly photographed)\n        0xA302 : \"CFAPattern\",              // Color filter array geometric pattern\n        0xA401 : \"CustomRendered\",          // Special processing\n        0xA402 : \"ExposureMode\",            // Exposure mode\n        0xA403 : \"WhiteBalance\",            // 1 = auto white balance, 2 = manual\n        0xA404 : \"DigitalZoomRation\",       // Digital zoom ratio\n        0xA405 : \"FocalLengthIn35mmFilm\",   // Equivalent foacl length assuming 35mm film camera (in mm)\n        0xA406 : \"SceneCaptureType\",        // Type of scene\n        0xA407 : \"GainControl\",             // Degree of overall image gain adjustment\n        0xA408 : \"Contrast\",                // Direction of contrast processing applied by camera\n        0xA409 : \"Saturation\",              // Direction of saturation processing applied by camera\n        0xA40A : \"Sharpness\",               // Direction of sharpness processing applied by camera\n        0xA40B : \"DeviceSettingDescription\",    //\n        0xA40C : \"SubjectDistanceRange\",    // Distance to subject\n\n        // other tags\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0xA420 : \"ImageUniqueID\"            // Identifier assigned uniquely to each image\n    };\n\n    var TiffTags = EXIF.TiffTags = {\n        0x0100 : \"ImageWidth\",\n        0x0101 : \"ImageHeight\",\n        0x8769 : \"ExifIFDPointer\",\n        0x8825 : \"GPSInfoIFDPointer\",\n        0xA005 : \"InteroperabilityIFDPointer\",\n        0x0102 : \"BitsPerSample\",\n        0x0103 : \"Compression\",\n        0x0106 : \"PhotometricInterpretation\",\n        0x0112 : \"Orientation\",\n        0x0115 : \"SamplesPerPixel\",\n        0x011C : \"PlanarConfiguration\",\n        0x0212 : \"YCbCrSubSampling\",\n        0x0213 : \"YCbCrPositioning\",\n        0x011A : \"XResolution\",\n        0x011B : \"YResolution\",\n        0x0128 : \"ResolutionUnit\",\n        0x0111 : \"StripOffsets\",\n        0x0116 : \"RowsPerStrip\",\n        0x0117 : \"StripByteCounts\",\n        0x0201 : \"JPEGInterchangeFormat\",\n        0x0202 : \"JPEGInterchangeFormatLength\",\n        0x012D : \"TransferFunction\",\n        0x013E : \"WhitePoint\",\n        0x013F : \"PrimaryChromaticities\",\n        0x0211 : \"YCbCrCoefficients\",\n        0x0214 : \"ReferenceBlackWhite\",\n        0x0132 : \"DateTime\",\n        0x010E : \"ImageDescription\",\n        0x010F : \"Make\",\n        0x0110 : \"Model\",\n        0x0131 : \"Software\",\n        0x013B : \"Artist\",\n        0x8298 : \"Copyright\"\n    };\n\n    var GPSTags = EXIF.GPSTags = {\n        0x0000 : \"GPSVersionID\",\n        0x0001 : \"GPSLatitudeRef\",\n        0x0002 : \"GPSLatitude\",\n        0x0003 : \"GPSLongitudeRef\",\n        0x0004 : \"GPSLongitude\",\n        0x0005 : \"GPSAltitudeRef\",\n        0x0006 : \"GPSAltitude\",\n        0x0007 : \"GPSTimeStamp\",\n        0x0008 : \"GPSSatellites\",\n        0x0009 : \"GPSStatus\",\n        0x000A : \"GPSMeasureMode\",\n        0x000B : \"GPSDOP\",\n        0x000C : \"GPSSpeedRef\",\n        0x000D : \"GPSSpeed\",\n        0x000E : \"GPSTrackRef\",\n        0x000F : \"GPSTrack\",\n        0x0010 : \"GPSImgDirectionRef\",\n        0x0011 : \"GPSImgDirection\",\n        0x0012 : \"GPSMapDatum\",\n        0x0013 : \"GPSDestLatitudeRef\",\n        0x0014 : \"GPSDestLatitude\",\n        0x0015 : \"GPSDestLongitudeRef\",\n        0x0016 : \"GPSDestLongitude\",\n        0x0017 : \"GPSDestBearingRef\",\n        0x0018 : \"GPSDestBearing\",\n        0x0019 : \"GPSDestDistanceRef\",\n        0x001A : \"GPSDestDistance\",\n        0x001B : \"GPSProcessingMethod\",\n        0x001C : \"GPSAreaInformation\",\n        0x001D : \"GPSDateStamp\",\n        0x001E : \"GPSDifferential\"\n    };\n\n     // EXIF 2.3 Spec\n    var IFD1Tags = EXIF.IFD1Tags = {\n        0x0100: \"ImageWidth\",\n        0x0101: \"ImageHeight\",\n        0x0102: \"BitsPerSample\",\n        0x0103: \"Compression\",\n        0x0106: \"PhotometricInterpretation\",\n        0x0111: \"StripOffsets\",\n        0x0112: \"Orientation\",\n        0x0115: \"SamplesPerPixel\",\n        0x0116: \"RowsPerStrip\",\n        0x0117: \"StripByteCounts\",\n        0x011A: \"XResolution\",\n        0x011B: \"YResolution\",\n        0x011C: \"PlanarConfiguration\",\n        0x0128: \"ResolutionUnit\",\n        0x0201: \"JpegIFOffset\",    // When image format is JPEG, this value show offset to JPEG data stored.(aka \"ThumbnailOffset\" or \"JPEGInterchangeFormat\")\n        0x0202: \"JpegIFByteCount\", // When image format is JPEG, this value shows data size of JPEG image (aka \"ThumbnailLength\" or \"JPEGInterchangeFormatLength\")\n        0x0211: \"YCbCrCoefficients\",\n        0x0212: \"YCbCrSubSampling\",\n        0x0213: \"YCbCrPositioning\",\n        0x0214: \"ReferenceBlackWhite\"\n    };\n\n    var StringValues = EXIF.StringValues = {\n        ExposureProgram : {\n            0 : \"Not defined\",\n            1 : \"Manual\",\n            2 : \"Normal program\",\n            3 : \"Aperture priority\",\n            4 : \"Shutter priority\",\n            5 : \"Creative program\",\n            6 : \"Action program\",\n            7 : \"Portrait mode\",\n            8 : \"Landscape mode\"\n        },\n        MeteringMode : {\n            0 : \"Unknown\",\n            1 : \"Average\",\n            2 : \"CenterWeightedAverage\",\n            3 : \"Spot\",\n            4 : \"MultiSpot\",\n            5 : \"Pattern\",\n            6 : \"Partial\",\n            255 : \"Other\"\n        },\n        LightSource : {\n            0 : \"Unknown\",\n            1 : \"Daylight\",\n            2 : \"Fluorescent\",\n            3 : \"Tungsten (incandescent light)\",\n            4 : \"Flash\",\n            9 : \"Fine weather\",\n            10 : \"Cloudy weather\",\n            11 : \"Shade\",\n            12 : \"Daylight fluorescent (D 5700 - 7100K)\",\n            13 : \"Day white fluorescent (N 4600 - 5400K)\",\n            14 : \"Cool white fluorescent (W 3900 - 4500K)\",\n            15 : \"White fluorescent (WW 3200 - 3700K)\",\n            17 : \"Standard light A\",\n            18 : \"Standard light B\",\n            19 : \"Standard light C\",\n            20 : \"D55\",\n            21 : \"D65\",\n            22 : \"D75\",\n            23 : \"D50\",\n            24 : \"ISO studio tungsten\",\n            255 : \"Other\"\n        },\n        Flash : {\n            0x0000 : \"Flash did not fire\",\n            0x0001 : \"Flash fired\",\n            0x0005 : \"Strobe return light not detected\",\n            0x0007 : \"Strobe return light detected\",\n            0x0009 : \"Flash fired, compulsory flash mode\",\n            0x000D : \"Flash fired, compulsory flash mode, return light not detected\",\n            0x000F : \"Flash fired, compulsory flash mode, return light detected\",\n            0x0010 : \"Flash did not fire, compulsory flash mode\",\n            0x0018 : \"Flash did not fire, auto mode\",\n            0x0019 : \"Flash fired, auto mode\",\n            0x001D : \"Flash fired, auto mode, return light not detected\",\n            0x001F : \"Flash fired, auto mode, return light detected\",\n            0x0020 : \"No flash function\",\n            0x0041 : \"Flash fired, red-eye reduction mode\",\n            0x0045 : \"Flash fired, red-eye reduction mode, return light not detected\",\n            0x0047 : \"Flash fired, red-eye reduction mode, return light detected\",\n            0x0049 : \"Flash fired, compulsory flash mode, red-eye reduction mode\",\n            0x004D : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected\",\n            0x004F : \"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected\",\n            0x0059 : \"Flash fired, auto mode, red-eye reduction mode\",\n            0x005D : \"Flash fired, auto mode, return light not detected, red-eye reduction mode\",\n            0x005F : \"Flash fired, auto mode, return light detected, red-eye reduction mode\"\n        },\n        SensingMethod : {\n            1 : \"Not defined\",\n            2 : \"One-chip color area sensor\",\n            3 : \"Two-chip color area sensor\",\n            4 : \"Three-chip color area sensor\",\n            5 : \"Color sequential area sensor\",\n            7 : \"Trilinear sensor\",\n            8 : \"Color sequential linear sensor\"\n        },\n        SceneCaptureType : {\n            0 : \"Standard\",\n            1 : \"Landscape\",\n            2 : \"Portrait\",\n            3 : \"Night scene\"\n        },\n        SceneType : {\n            1 : \"Directly photographed\"\n        },\n        CustomRendered : {\n            0 : \"Normal process\",\n            1 : \"Custom process\"\n        },\n        WhiteBalance : {\n            0 : \"Auto white balance\",\n            1 : \"Manual white balance\"\n        },\n        GainControl : {\n            0 : \"None\",\n            1 : \"Low gain up\",\n            2 : \"High gain up\",\n            3 : \"Low gain down\",\n            4 : \"High gain down\"\n        },\n        Contrast : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        Saturation : {\n            0 : \"Normal\",\n            1 : \"Low saturation\",\n            2 : \"High saturation\"\n        },\n        Sharpness : {\n            0 : \"Normal\",\n            1 : \"Soft\",\n            2 : \"Hard\"\n        },\n        SubjectDistanceRange : {\n            0 : \"Unknown\",\n            1 : \"Macro\",\n            2 : \"Close view\",\n            3 : \"Distant view\"\n        },\n        FileSource : {\n            3 : \"DSC\"\n        },\n\n        Components : {\n            0 : \"\",\n            1 : \"Y\",\n            2 : \"Cb\",\n            3 : \"Cr\",\n            4 : \"R\",\n            5 : \"G\",\n            6 : \"B\"\n        }\n    };\n\n    function addEvent(element, event, handler) {\n        if (element.addEventListener) {\n            element.addEventListener(event, handler, false);\n        } else if (element.attachEvent) {\n            element.attachEvent(\"on\" + event, handler);\n        }\n    }\n\n    function imageHasData(img) {\n        return !!(img.exifdata);\n    }\n\n\n    function base64ToArrayBuffer(base64, contentType) {\n        contentType = contentType || base64.match(/^data\\:([^\\;]+)\\;base64,/mi)[1] || ''; // e.g. 'data:image/jpeg;base64,...' => 'image/jpeg'\n        base64 = base64.replace(/^data\\:([^\\;]+)\\;base64,/gmi, '');\n        var binary = atob(base64);\n        var len = binary.length;\n        var buffer = new ArrayBuffer(len);\n        var view = new Uint8Array(buffer);\n        for (var i = 0; i < len; i++) {\n            view[i] = binary.charCodeAt(i);\n        }\n        return buffer;\n    }\n\n    function objectURLToBlob(url, callback) {\n        var http = new XMLHttpRequest();\n        http.open(\"GET\", url, true);\n        http.responseType = \"blob\";\n        http.onload = function(e) {\n            if (this.status == 200 || this.status === 0) {\n                callback(this.response);\n            }\n        };\n        http.send();\n    }\n\n    function getImageData(img, callback) {\n        function handleBinaryFile(binFile) {\n            var data = findEXIFinJPEG(binFile);\n            img.exifdata = data || {};\n            var iptcdata = findIPTCinJPEG(binFile);\n            img.iptcdata = iptcdata || {};\n            if (EXIF.isXmpEnabled) {\n               var xmpdata= findXMPinJPEG(binFile);\n               img.xmpdata = xmpdata || {};               \n            }\n            if (callback) {\n                callback.call(img);\n            }\n        }\n\n        if (img.src) {\n            if (/^data\\:/i.test(img.src)) { // Data URI\n                var arrayBuffer = base64ToArrayBuffer(img.src);\n                handleBinaryFile(arrayBuffer);\n\n            } else if (/^blob\\:/i.test(img.src)) { // Object URL\n                var fileReader = new FileReader();\n                fileReader.onload = function(e) {\n                    handleBinaryFile(e.target.result);\n                };\n                objectURLToBlob(img.src, function (blob) {\n                    fileReader.readAsArrayBuffer(blob);\n                });\n            } else {\n                var http = new XMLHttpRequest();\n                http.onload = function() {\n                    if (this.status == 200 || this.status === 0) {\n                        handleBinaryFile(http.response);\n                    } else {\n                        throw \"Could not load image\";\n                    }\n                    http = null;\n                };\n                http.open(\"GET\", img.src, true);\n                http.responseType = \"arraybuffer\";\n                http.send(null);\n            }\n        } else if (self.FileReader && (img instanceof self.Blob || img instanceof self.File)) {\n            var fileReader = new FileReader();\n            fileReader.onload = function(e) {\n                if (debug) console.log(\"Got file of length \" + e.target.result.byteLength);\n                handleBinaryFile(e.target.result);\n            };\n\n            fileReader.readAsArrayBuffer(img);\n        }\n    }\n\n    function findEXIFinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            marker;\n\n        while (offset < length) {\n            if (dataView.getUint8(offset) != 0xFF) {\n                if (debug) console.log(\"Not a valid marker at offset \" + offset + \", found: \" + dataView.getUint8(offset));\n                return false; // not a valid marker, something is wrong\n            }\n\n            marker = dataView.getUint8(offset + 1);\n            if (debug) console.log(marker);\n\n            // we could implement handling for other markers here,\n            // but we're only looking for 0xFFE1 for EXIF data\n\n            if (marker == 225) {\n                if (debug) console.log(\"Found 0xFFE1 marker\");\n\n                return readEXIFData(dataView, offset + 4, dataView.getUint16(offset + 2) - 2);\n\n                // offset += 2 + file.getShortAt(offset+2, true);\n\n            } else {\n                offset += 2 + dataView.getUint16(offset+2);\n            }\n\n        }\n\n    }\n\n    function findIPTCinJPEG(file) {\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n            if (debug) console.log(\"Not a valid JPEG\");\n            return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength;\n\n\n        var isFieldSegmentStart = function(dataView, offset){\n            return (\n                dataView.getUint8(offset) === 0x38 &&\n                dataView.getUint8(offset+1) === 0x42 &&\n                dataView.getUint8(offset+2) === 0x49 &&\n                dataView.getUint8(offset+3) === 0x4D &&\n                dataView.getUint8(offset+4) === 0x04 &&\n                dataView.getUint8(offset+5) === 0x04\n            );\n        };\n\n        while (offset < length) {\n\n            if ( isFieldSegmentStart(dataView, offset )){\n\n                // Get the length of the name header (which is padded to an even number of bytes)\n                var nameHeaderLength = dataView.getUint8(offset+7);\n                if(nameHeaderLength % 2 !== 0) nameHeaderLength += 1;\n                // Check for pre photoshop 6 format\n                if(nameHeaderLength === 0) {\n                    // Always 4\n                    nameHeaderLength = 4;\n                }\n\n                var startOffset = offset + 8 + nameHeaderLength;\n                var sectionLength = dataView.getUint16(offset + 6 + nameHeaderLength);\n\n                return readIPTCData(file, startOffset, sectionLength);\n\n                break;\n\n            }\n\n\n            // Not the marker, continue searching\n            offset++;\n\n        }\n\n    }\n    var IptcFieldMap = {\n        0x78 : 'caption',\n        0x6E : 'credit',\n        0x19 : 'keywords',\n        0x37 : 'dateCreated',\n        0x50 : 'byline',\n        0x55 : 'bylineTitle',\n        0x7A : 'captionWriter',\n        0x69 : 'headline',\n        0x74 : 'copyright',\n        0x0F : 'category'\n    };\n    function readIPTCData(file, startOffset, sectionLength){\n        var dataView = new DataView(file);\n        var data = {};\n        var fieldValue, fieldName, dataSize, segmentType, segmentSize;\n        var segmentStartPos = startOffset;\n        while(segmentStartPos < startOffset+sectionLength) {\n            if(dataView.getUint8(segmentStartPos) === 0x1C && dataView.getUint8(segmentStartPos+1) === 0x02){\n                segmentType = dataView.getUint8(segmentStartPos+2);\n                if(segmentType in IptcFieldMap) {\n                    dataSize = dataView.getInt16(segmentStartPos+3);\n                    segmentSize = dataSize + 5;\n                    fieldName = IptcFieldMap[segmentType];\n                    fieldValue = getStringFromDB(dataView, segmentStartPos+5, dataSize);\n                    // Check if we already stored a value with this name\n                    if(data.hasOwnProperty(fieldName)) {\n                        // Value already stored with this name, create multivalue field\n                        if(data[fieldName] instanceof Array) {\n                            data[fieldName].push(fieldValue);\n                        }\n                        else {\n                            data[fieldName] = [data[fieldName], fieldValue];\n                        }\n                    }\n                    else {\n                        data[fieldName] = fieldValue;\n                    }\n                }\n\n            }\n            segmentStartPos++;\n        }\n        return data;\n    }\n\n\n\n    function readTags(file, tiffStart, dirStart, strings, bigEnd) {\n        var entries = file.getUint16(dirStart, !bigEnd),\n            tags = {},\n            entryOffset, tag,\n            i;\n\n        for (i=0;i<entries;i++) {\n            entryOffset = dirStart + i*12 + 2;\n            tag = strings[file.getUint16(entryOffset, !bigEnd)];\n            if (!tag && debug) console.log(\"Unknown tag: \" + file.getUint16(entryOffset, !bigEnd));\n            tags[tag] = readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd);\n        }\n        return tags;\n    }\n\n\n    function readTagValue(file, entryOffset, tiffStart, dirStart, bigEnd) {\n        var type = file.getUint16(entryOffset+2, !bigEnd),\n            numValues = file.getUint32(entryOffset+4, !bigEnd),\n            valueOffset = file.getUint32(entryOffset+8, !bigEnd) + tiffStart,\n            offset,\n            vals, val, n,\n            numerator, denominator;\n\n        switch (type) {\n            case 1: // byte, 8-bit unsigned int\n            case 7: // undefined, 8-bit byte, value depending on field\n                if (numValues == 1) {\n                    return file.getUint8(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint8(offset + n);\n                    }\n                    return vals;\n                }\n\n            case 2: // ascii, 8-bit byte\n                offset = numValues > 4 ? valueOffset : (entryOffset + 8);\n                return getStringFromDB(file, offset, numValues-1);\n\n            case 3: // short, 16 bit int\n                if (numValues == 1) {\n                    return file.getUint16(entryOffset + 8, !bigEnd);\n                } else {\n                    offset = numValues > 2 ? valueOffset : (entryOffset + 8);\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint16(offset + 2*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 4: // long, 32 bit int\n                if (numValues == 1) {\n                    return file.getUint32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getUint32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 5:    // rational = two long values, first is numerator, second is denominator\n                if (numValues == 1) {\n                    numerator = file.getUint32(valueOffset, !bigEnd);\n                    denominator = file.getUint32(valueOffset+4, !bigEnd);\n                    val = new Number(numerator / denominator);\n                    val.numerator = numerator;\n                    val.denominator = denominator;\n                    return val;\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        numerator = file.getUint32(valueOffset + 8*n, !bigEnd);\n                        denominator = file.getUint32(valueOffset+4 + 8*n, !bigEnd);\n                        vals[n] = new Number(numerator / denominator);\n                        vals[n].numerator = numerator;\n                        vals[n].denominator = denominator;\n                    }\n                    return vals;\n                }\n\n            case 9: // slong, 32 bit signed int\n                if (numValues == 1) {\n                    return file.getInt32(entryOffset + 8, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 4*n, !bigEnd);\n                    }\n                    return vals;\n                }\n\n            case 10: // signed rational, two slongs, first is numerator, second is denominator\n                if (numValues == 1) {\n                    return file.getInt32(valueOffset, !bigEnd) / file.getInt32(valueOffset+4, !bigEnd);\n                } else {\n                    vals = [];\n                    for (n=0;n<numValues;n++) {\n                        vals[n] = file.getInt32(valueOffset + 8*n, !bigEnd) / file.getInt32(valueOffset+4 + 8*n, !bigEnd);\n                    }\n                    return vals;\n                }\n        }\n    }\n\n    /**\n    * Given an IFD (Image File Directory) start offset\n    * returns an offset to next IFD or 0 if it's the last IFD.\n    */\n    function getNextIFDOffset(dataView, dirStart, bigEnd){\n        //the first 2bytes means the number of directory entries contains in this IFD\n        var entries = dataView.getUint16(dirStart, !bigEnd);\n\n        // After last directory entry, there is a 4bytes of data,\n        // it means an offset to next IFD.\n        // If its value is '0x00000000', it means this is the last IFD and there is no linked IFD.\n\n        return dataView.getUint32(dirStart + 2 + entries * 12, !bigEnd); // each entry is 12 bytes long\n    }\n\n    function readThumbnailImage(dataView, tiffStart, firstIFDOffset, bigEnd){\n        // get the IFD1 offset\n        var IFD1OffsetPointer = getNextIFDOffset(dataView, tiffStart+firstIFDOffset, bigEnd);\n\n        if (!IFD1OffsetPointer) {\n            // console.log('******** IFD1Offset is empty, image thumb not found ********');\n            return {};\n        }\n        else if (IFD1OffsetPointer > dataView.byteLength) { // this should not happen\n            // console.log('******** IFD1Offset is outside the bounds of the DataView ********');\n            return {};\n        }\n        // console.log('*******  thumbnail IFD offset (IFD1) is: %s', IFD1OffsetPointer);\n\n        var thumbTags = readTags(dataView, tiffStart, tiffStart + IFD1OffsetPointer, IFD1Tags, bigEnd)\n\n        // EXIF 2.3 specification for JPEG format thumbnail\n\n        // If the value of Compression(0x0103) Tag in IFD1 is '6', thumbnail image format is JPEG.\n        // Most of Exif image uses JPEG format for thumbnail. In that case, you can get offset of thumbnail\n        // by JpegIFOffset(0x0201) Tag in IFD1, size of thumbnail by JpegIFByteCount(0x0202) Tag.\n        // Data format is ordinary JPEG format, starts from 0xFFD8 and ends by 0xFFD9. It seems that\n        // JPEG format and 160x120pixels of size are recommended thumbnail format for Exif2.1 or later.\n\n        if (thumbTags['Compression']) {\n            // console.log('Thumbnail image found!');\n\n            switch (thumbTags['Compression']) {\n                case 6:\n                    // console.log('Thumbnail image format is JPEG');\n                    if (thumbTags.JpegIFOffset && thumbTags.JpegIFByteCount) {\n                    // extract the thumbnail\n                        var tOffset = tiffStart + thumbTags.JpegIFOffset;\n                        var tLength = thumbTags.JpegIFByteCount;\n                        thumbTags['blob'] = new Blob([new Uint8Array(dataView.buffer, tOffset, tLength)], {\n                            type: 'image/jpeg'\n                        });\n                    }\n                break;\n\n            case 1:\n                console.log(\"Thumbnail image format is TIFF, which is not implemented.\");\n                break;\n            default:\n                console.log(\"Unknown thumbnail image format '%s'\", thumbTags['Compression']);\n            }\n        }\n        else if (thumbTags['PhotometricInterpretation'] == 2) {\n            console.log(\"Thumbnail image format is RGB, which is not implemented.\");\n        }\n        return thumbTags;\n    }\n\n    function getStringFromDB(buffer, start, length) {\n        var outstr = \"\";\n        for (n = start; n < start+length; n++) {\n            outstr += String.fromCharCode(buffer.getUint8(n));\n        }\n        return outstr;\n    }\n\n    function readEXIFData(file, start) {\n        if (getStringFromDB(file, start, 4) != \"Exif\") {\n            if (debug) console.log(\"Not valid EXIF data! \" + getStringFromDB(file, start, 4));\n            return false;\n        }\n\n        var bigEnd,\n            tags, tag,\n            exifData, gpsData,\n            tiffOffset = start + 6;\n\n        // test for TIFF validity and endianness\n        if (file.getUint16(tiffOffset) == 0x4949) {\n            bigEnd = false;\n        } else if (file.getUint16(tiffOffset) == 0x4D4D) {\n            bigEnd = true;\n        } else {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x4949 or 0x4D4D)\");\n            return false;\n        }\n\n        if (file.getUint16(tiffOffset+2, !bigEnd) != 0x002A) {\n            if (debug) console.log(\"Not valid TIFF data! (no 0x002A)\");\n            return false;\n        }\n\n        var firstIFDOffset = file.getUint32(tiffOffset+4, !bigEnd);\n\n        if (firstIFDOffset < 0x00000008) {\n            if (debug) console.log(\"Not valid TIFF data! (First offset less than 8)\", file.getUint32(tiffOffset+4, !bigEnd));\n            return false;\n        }\n\n        tags = readTags(file, tiffOffset, tiffOffset + firstIFDOffset, TiffTags, bigEnd);\n\n        if (tags.ExifIFDPointer) {\n            exifData = readTags(file, tiffOffset, tiffOffset + tags.ExifIFDPointer, ExifTags, bigEnd);\n            for (tag in exifData) {\n                switch (tag) {\n                    case \"LightSource\" :\n                    case \"Flash\" :\n                    case \"MeteringMode\" :\n                    case \"ExposureProgram\" :\n                    case \"SensingMethod\" :\n                    case \"SceneCaptureType\" :\n                    case \"SceneType\" :\n                    case \"CustomRendered\" :\n                    case \"WhiteBalance\" :\n                    case \"GainControl\" :\n                    case \"Contrast\" :\n                    case \"Saturation\" :\n                    case \"Sharpness\" :\n                    case \"SubjectDistanceRange\" :\n                    case \"FileSource\" :\n                        exifData[tag] = StringValues[tag][exifData[tag]];\n                        break;\n\n                    case \"ExifVersion\" :\n                    case \"FlashpixVersion\" :\n                        exifData[tag] = String.fromCharCode(exifData[tag][0], exifData[tag][1], exifData[tag][2], exifData[tag][3]);\n                        break;\n\n                    case \"ComponentsConfiguration\" :\n                        exifData[tag] =\n                            StringValues.Components[exifData[tag][0]] +\n                            StringValues.Components[exifData[tag][1]] +\n                            StringValues.Components[exifData[tag][2]] +\n                            StringValues.Components[exifData[tag][3]];\n                        break;\n                }\n                tags[tag] = exifData[tag];\n            }\n        }\n\n        if (tags.GPSInfoIFDPointer) {\n            gpsData = readTags(file, tiffOffset, tiffOffset + tags.GPSInfoIFDPointer, GPSTags, bigEnd);\n            for (tag in gpsData) {\n                switch (tag) {\n                    case \"GPSVersionID\" :\n                        gpsData[tag] = gpsData[tag][0] +\n                            \".\" + gpsData[tag][1] +\n                            \".\" + gpsData[tag][2] +\n                            \".\" + gpsData[tag][3];\n                        break;\n                }\n                tags[tag] = gpsData[tag];\n            }\n        }\n\n        // extract thumbnail\n        tags['thumbnail'] = readThumbnailImage(file, tiffOffset, firstIFDOffset, bigEnd);\n\n        return tags;\n    }\n\n   function findXMPinJPEG(file) {\n\n        if (!('DOMParser' in self)) {\n            // console.warn('XML parsing not supported without DOMParser');\n            return;\n        }\n        var dataView = new DataView(file);\n\n        if (debug) console.log(\"Got file of length \" + file.byteLength);\n        if ((dataView.getUint8(0) != 0xFF) || (dataView.getUint8(1) != 0xD8)) {\n           if (debug) console.log(\"Not a valid JPEG\");\n           return false; // not a valid jpeg\n        }\n\n        var offset = 2,\n            length = file.byteLength,\n            dom = new DOMParser();\n\n        while (offset < (length-4)) {\n            if (getStringFromDB(dataView, offset, 4) == \"http\") {\n                var startOffset = offset - 1;\n                var sectionLength = dataView.getUint16(offset - 2) - 1;\n                var xmpString = getStringFromDB(dataView, startOffset, sectionLength)\n                var xmpEndIndex = xmpString.indexOf('xmpmeta>') + 8;\n                xmpString = xmpString.substring( xmpString.indexOf( '<x:xmpmeta' ), xmpEndIndex );\n\n                var indexOfXmp = xmpString.indexOf('x:xmpmeta') + 10\n                //Many custom written programs embed xmp/xml without any namespace. Following are some of them.\n                //Without these namespaces, XML is thought to be invalid by parsers\n                xmpString = xmpString.slice(0, indexOfXmp)\n                            + 'xmlns:Iptc4xmpCore=\"http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/\" '\n                            + 'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" '\n                            + 'xmlns:tiff=\"http://ns.adobe.com/tiff/1.0/\" '\n                            + 'xmlns:plus=\"http://schemas.android.com/apk/lib/com.google.android.gms.plus\" '\n                            + 'xmlns:ext=\"http://www.gettyimages.com/xsltExtension/1.0\" '\n                            + 'xmlns:exif=\"http://ns.adobe.com/exif/1.0/\" '\n                            + 'xmlns:stEvt=\"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#\" '\n                            + 'xmlns:stRef=\"http://ns.adobe.com/xap/1.0/sType/ResourceRef#\" '\n                            + 'xmlns:crs=\"http://ns.adobe.com/camera-raw-settings/1.0/\" '\n                            + 'xmlns:xapGImg=\"http://ns.adobe.com/xap/1.0/g/img/\" '\n                            + 'xmlns:Iptc4xmpExt=\"http://iptc.org/std/Iptc4xmpExt/2008-02-29/\" '\n                            + xmpString.slice(indexOfXmp)\n\n                var domDocument = dom.parseFromString( xmpString, 'text/xml' );\n                return xml2Object(domDocument);\n            } else{\n             offset++;\n            }\n        }\n    }\n\n    function xml2json(xml) {\n        var json = {};\n      \n        if (xml.nodeType == 1) { // element node\n          if (xml.attributes.length > 0) {\n            json['@attributes'] = {};\n            for (var j = 0; j < xml.attributes.length; j++) {\n              var attribute = xml.attributes.item(j);\n              json['@attributes'][attribute.nodeName] = attribute.nodeValue;\n            }\n          }\n        } else if (xml.nodeType == 3) { // text node\n          return xml.nodeValue;\n        }\n      \n        // deal with children\n        if (xml.hasChildNodes()) {\n          for(var i = 0; i < xml.childNodes.length; i++) {\n            var child = xml.childNodes.item(i);\n            var nodeName = child.nodeName;\n            if (json[nodeName] == null) {\n              json[nodeName] = xml2json(child);\n            } else {\n              if (json[nodeName].push == null) {\n                var old = json[nodeName];\n                json[nodeName] = [];\n                json[nodeName].push(old);\n              }\n              json[nodeName].push(xml2json(child));\n            }\n          }\n        }\n        \n        return json;\n    }\n\n    function xml2Object(xml) {\n        try {\n            var obj = {};\n            if (xml.children.length > 0) {\n              for (var i = 0; i < xml.children.length; i++) {\n                var item = xml.children.item(i);\n                var attributes = item.attributes;\n                for(var idx in attributes) {\n                    var itemAtt = attributes[idx];\n                    var dataKey = itemAtt.nodeName;\n                    var dataValue = itemAtt.nodeValue;\n\n                    if(dataKey !== undefined) {\n                        obj[dataKey] = dataValue;\n                    }\n                }\n                var nodeName = item.nodeName;\n\n                if (typeof (obj[nodeName]) == \"undefined\") {\n                  obj[nodeName] = xml2json(item);\n                } else {\n                  if (typeof (obj[nodeName].push) == \"undefined\") {\n                    var old = obj[nodeName];\n\n                    obj[nodeName] = [];\n                    obj[nodeName].push(old);\n                  }\n                  obj[nodeName].push(xml2json(item));\n                }\n              }\n            } else {\n              obj = xml.textContent;\n            }\n            return obj;\n          } catch (e) {\n              console.log(e.message);\n          }\n    }\n\n    EXIF.enableXmp = function() {\n        EXIF.isXmpEnabled = true;\n    }\n\n    EXIF.disableXmp = function() {\n        EXIF.isXmpEnabled = false;\n    }\n\n    EXIF.getData = function(img, callback) {\n        if (((self.Image && img instanceof self.Image)\n            || (self.HTMLImageElement && img instanceof self.HTMLImageElement))\n            && !img.complete)\n            return false;\n\n        if (!imageHasData(img)) {\n            getImageData(img, callback);\n        } else {\n            if (callback) {\n                callback.call(img);\n            }\n        }\n        return true;\n    }\n\n    EXIF.getTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.exifdata[tag];\n    }\n    \n    EXIF.getIptcTag = function(img, tag) {\n        if (!imageHasData(img)) return;\n        return img.iptcdata[tag];\n    }\n\n    EXIF.getAllTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.exifdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n    \n    EXIF.getAllIptcTags = function(img) {\n        if (!imageHasData(img)) return {};\n        var a,\n            data = img.iptcdata,\n            tags = {};\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                tags[a] = data[a];\n            }\n        }\n        return tags;\n    }\n\n    EXIF.pretty = function(img) {\n        if (!imageHasData(img)) return \"\";\n        var a,\n            data = img.exifdata,\n            strPretty = \"\";\n        for (a in data) {\n            if (data.hasOwnProperty(a)) {\n                if (typeof data[a] == \"object\") {\n                    if (data[a] instanceof Number) {\n                        strPretty += a + \" : \" + data[a] + \" [\" + data[a].numerator + \"/\" + data[a].denominator + \"]\\r\\n\";\n                    } else {\n                        strPretty += a + \" : [\" + data[a].length + \" values]\\r\\n\";\n                    }\n                } else {\n                    strPretty += a + \" : \" + data[a] + \"\\r\\n\";\n                }\n            }\n        }\n        return strPretty;\n    }\n\n    EXIF.readFromBinaryFile = function(file) {\n        return findEXIFinJPEG(file);\n    }\n\n    if (typeof define === 'function' && define.amd) {\n        define('exif-js', [], function() {\n            return EXIF;\n        });\n    }\n}.call(this));\n\n","/**\n * Calculate a point transformed with an affine matrix\n * @param matrix {Matrix} Affine Matrix\n * @param  point {Point} Point\n * @returns {Point} Point\n */\nexport function applyToPoint (matrix, point) {\n  return Array.isArray(point)\n    ? [\n        matrix.a * point[0] + matrix.c * point[1] + matrix.e,\n        matrix.b * point[0] + matrix.d * point[1] + matrix.f\n      ]\n    : {\n        x: matrix.a * point.x + matrix.c * point.y + matrix.e,\n        y: matrix.b * point.x + matrix.d * point.y + matrix.f\n      }\n}\n\n/**\n * Calculate an array of points transformed with an affine matrix\n * @param matrix {Matrix} Affine Matrix\n * @param points {Point[]} Array of point\n * @returns {Point[]} Array of point\n */\nexport function applyToPoints (matrix, points) {\n  return points.map(point => applyToPoint(matrix, point))\n}\n","/**\n * Extract an affine matrix from an object that contains a,b,c,d,e,f keys\n * Any value could be a float or a string that contains a float\n * @param object {Object} Object that contains a,b,c,d,e,f keys\n * @return {Matrix} Affine Matrix\n */\nexport function fromObject (object) {\n  return {\n    a: parseFloat(object.a),\n    b: parseFloat(object.b),\n    c: parseFloat(object.c),\n    d: parseFloat(object.d),\n    e: parseFloat(object.e),\n    f: parseFloat(object.f)\n  }\n}\n","/**\n * @ignore\n * @type {RegExp}\n */\nconst matrixRegex = /^matrix\\(\\s*([0-9_+-.e]+)\\s*,\\s*([0-9_+-.e]+)\\s*,\\s*([0-9_+-.e]+)\\s*,\\s*([0-9_+-.e]+)\\s*,\\s*([0-9_+-.e]+)\\s*,\\s*([0-9_+-.e]+)\\s*\\)$/i\n\n/**\n * Parse a string formatted as matrix(a,b,c,d,e,f)\n * @param string {string} String with an affine matrix\n * @returns {Matrix} Affine Matrix\n *\n * @example\n * > fromString('matrix(1,2,3,4,5,6)')\n * {a: 1, b: 2, c: 3, d: 4, c: 5, e: 6}\n */\nexport function fromString (string) {\n  const parsed = string.match(matrixRegex)\n  if (parsed === null || parsed.length < 7) throw new Error(`'${string}' is not a matrix`)\n  return {\n    a: parseFloat(parsed[1]),\n    b: parseFloat(parsed[2]),\n    c: parseFloat(parsed[3]),\n    d: parseFloat(parsed[4]),\n    e: parseFloat(parsed[5]),\n    f: parseFloat(parsed[6])\n  }\n}\n","/**\n * Identity matrix\n * @returns {Matrix} Affine Matrix\n */\nexport function identity () {\n  return {\n    a: 1,\n    c: 0,\n    e: 0,\n    b: 0,\n    d: 1,\n    f: 0\n  }\n}\n","/**\n * Calculate a matrix that is the inverse of the provided matrix\n * @param matrix {Matrix} Affine Matrix\n * @returns {Matrix} Inverted Affine Matrix\n */\nexport function inverse (matrix) {\n  // http://www.wolframalpha.com/input/?i=Inverse+%5B%7B%7Ba,c,e%7D,%7Bb,d,f%7D,%7B0,0,1%7D%7D%5D\n\n  const { a, b, c, d, e, f } = matrix\n\n  const denom = a * d - b * c\n\n  return {\n    a: d / denom,\n    b: b / -denom,\n    c: c / -denom,\n    d: a / denom,\n    e: (d * e - c * f) / -denom,\n    f: (b * e - a * f) / denom\n  }\n}\n","export function isUndefined (val) {\n  return typeof val === 'undefined'\n}\n\nexport function isNumeric (n) {\n  return typeof n === 'number' &&\n    !Number.isNaN(n) &&\n    Number.isFinite(n)\n}\n\nexport function isObject (obj) {\n  return typeof obj === 'object' &&\n    obj !== null &&\n    !Array.isArray(obj)\n}\n\nexport function matchesShape (obj, keys) {\n  return keys.every(key => key in obj)\n}\n","import { isNumeric, isObject } from './utils'\n\n/**\n * Check if the object contain an affine matrix\n * @param object {Object} Generic Plain Object\n * @return {boolean} True if is an object and contains an affine matrix\n */\n\nexport function isAffineMatrix (object) {\n  return isObject(object) &&\n    'a' in object &&\n    isNumeric(object.a) &&\n    'b' in object &&\n    isNumeric(object.b) &&\n    'c' in object &&\n    isNumeric(object.c) &&\n    'd' in object &&\n    isNumeric(object.d) &&\n    'e' in object &&\n    isNumeric(object.e) &&\n    'f' in object &&\n    isNumeric(object.f)\n}\n","/**\n * Calculate a translate matrix\n * @param tx {number} Translation on axis x\n * @param [ty = 0] {number} Translation on axis y\n * @returns {Matrix} Affine Matrix\n */\nexport function translate (tx, ty = 0) {\n  return {\n    a: 1,\n    c: 0,\n    e: tx,\n    b: 0,\n    d: 1,\n    f: ty\n  }\n}\n","/**\n * Merge multiple matrices into one\n * @param matrices {...Matrix | Matrix[]} Matrices listed as separate parameters or in an array\n * @returns {Matrix} Affine Matrix\n */\nexport function transform (...matrices) {\n  matrices = Array.isArray(matrices[0]) ? matrices[0] : matrices\n\n  const multiply = (m1, m2) => {\n    return {\n      a: m1.a * m2.a + m1.c * m2.b,\n      c: m1.a * m2.c + m1.c * m2.d,\n      e: m1.a * m2.e + m1.c * m2.f + m1.e,\n      b: m1.b * m2.a + m1.d * m2.b,\n      d: m1.b * m2.c + m1.d * m2.d,\n      f: m1.b * m2.e + m1.d * m2.f + m1.f\n    }\n  }\n\n  switch (matrices.length) {\n    case 0:\n      throw new Error('no matrices provided')\n\n    case 1:\n      return matrices[0]\n\n    case 2:\n      return multiply(matrices[0], matrices[1])\n\n    default: {\n      const [m1, m2, ...rest] = matrices\n      const m = multiply(m1, m2)\n      return transform(m, ...rest)\n    }\n  }\n}\n\n/**\n * Merge multiple matrices into one\n * @param matrices {...Matrix | Matrix[]} Matrices listed as separate parameters or in an array\n * @returns {Matrix} Affine Matrix\n */\nexport function compose (...matrices) {\n  return transform(...matrices)\n}\n","import { isUndefined } from './utils'\nimport { translate } from './translate'\nimport { transform } from './transform'\n\nconst { cos, sin, PI } = Math\n/**\n * Calculate a rotation matrix\n * @param angle {number} Angle in radians\n * @param [cx] {number} If (cx,cy) are supplied the rotate is about this point\n * @param [cy] {number} If (cx,cy) are supplied the rotate is about this point\n * @returns {Matrix} Affine Matrix\n */\nexport function rotate (angle, cx, cy) {\n  const cosAngle = cos(angle)\n  const sinAngle = sin(angle)\n  const rotationMatrix = {\n    a: cosAngle,\n    c: -sinAngle,\n    e: 0,\n    b: sinAngle,\n    d: cosAngle,\n    f: 0\n  }\n  if (isUndefined(cx) || isUndefined(cy)) {\n    return rotationMatrix\n  }\n\n  return transform([\n    translate(cx, cy),\n    rotationMatrix,\n    translate(-cx, -cy)\n  ])\n}\n\n/**\n * Calculate a rotation matrix with a DEG angle\n * @param angle {number} Angle in degree\n * @param [cx] {number} If (cx,cy) are supplied the rotate is about this point\n * @param [cy] {number} If (cx,cy) are supplied the rotate is about this point\n * @returns {Matrix} Affine Matrix\n */\nexport function rotateDEG (angle, cx = undefined, cy = undefined) {\n  return rotate(angle * PI / 180, cx, cy)\n}\n","import { isUndefined } from './utils'\nimport { translate } from './translate'\nimport { transform } from './transform'\n\n/**\n * Calculate a scaling matrix\n * @param sx {number} Scaling on axis x\n * @param [sy = sx] {number} Scaling on axis y (default sx)\n * @param [cx] {number} If (cx,cy) are supplied the scaling is about this point\n * @param [cy] {number} If (cx,cy) are supplied the scaling is about this point\n * @returns {Matrix} Affine Matrix\n */\nexport function scale (sx, sy = undefined, cx = undefined, cy = undefined) {\n  if (isUndefined(sy)) sy = sx\n\n  const scaleMatrix = {\n    a: sx,\n    c: 0,\n    e: 0,\n    b: 0,\n    d: sy,\n    f: 0\n  }\n\n  if (isUndefined(cx) || isUndefined(cy)) {\n    return scaleMatrix\n  }\n\n  return transform([\n    translate(cx, cy),\n    scaleMatrix,\n    translate(-cx, -cy)\n  ])\n}\n","/**\n * Calculate a shear matrix\n * @param shx {number} Shear on axis x\n * @param shy {number} Shear on axis y\n * @returns {Matrix} Affine Matrix\n */\nexport function shear (shx, shy) {\n  return {\n    a: 1,\n    c: shx,\n    e: 0,\n    b: shy,\n    d: 1,\n    f: 0\n  }\n}\n","// https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/skew\nconst { tan } = Math\n\n/**\n * Calculate a skew matrix\n * @param ax {number} Skew on axis x\n * @param ay {number} Skew on axis y\n * @returns {Matrix} Affine Matrix\n */\nexport function skew (ax, ay) {\n  return {\n    a: 1,\n    c: tan(ax),\n    e: 0,\n    b: tan(ay),\n    d: 1,\n    f: 0\n  }\n}\n\n/**\n * Calculate a skew matrix using DEG angles\n * @param ax {number} Skew on axis x\n * @param ay {number} Skew on axis y\n * @returns {Matrix} Affine Matrix\n */\nexport function skewDEG (ax, ay) {\n  return skew(ax * Math.PI / 180, ay * Math.PI / 180)\n}\n","/**\n * Serialize an affine matrix to a string that can be used with CSS or SVG\n * @param matrix {Matrix} Affine Matrix\n * @returns {string} String that contains an affine matrix formatted as matrix(a,b,c,d,e,f)\n */\nexport function toCSS (matrix) {\n  return toString(matrix)\n}\n\n/**\n * Serialize an affine matrix to a string that can be used with CSS or SVG\n * @param matrix {Matrix} Affine Matrix\n * @returns {string} String that contains an affine matrix formatted as matrix(a,b,c,d,e,f)\n */\nexport function toSVG (matrix) {\n  return toString(matrix)\n}\n\n/**\n * Serialize an affine matrix to a string that can be used with CSS or SVG\n * @param matrix {Matrix} Affine Matrix\n * @returns {string} String that contains an affine matrix formatted as matrix(a,b,c,d,e,f)\n */\nexport function toString (matrix) {\n  return `matrix(${matrix.a},${matrix.b},${matrix.c},${matrix.d},${matrix.e},${matrix.f})`\n}\n","/**\n * Rounds all elements of the given matrix using the given precision\n * @param matrix {Matrix} An affine matrix to round\n * @param [precision] {number} A precision to use for Math.round. Defaults to 10000000000 (meaning which rounds to the 10th digit after the comma).\n * @returns {Matrix} The rounded Affine Matrix\n */\nexport function smoothMatrix (matrix, precision = 10000000000) {\n  return {\n    a: Math.round(matrix.a * precision) / precision,\n    b: Math.round(matrix.b * precision) / precision,\n    c: Math.round(matrix.c * precision) / precision,\n    d: Math.round(matrix.d * precision) / precision,\n    e: Math.round(matrix.e * precision) / precision,\n    f: Math.round(matrix.f * precision) / precision\n  }\n}\n","import { inverse } from './inverse'\nimport { transform } from './transform'\nimport { smoothMatrix } from './smoothMatrix'\n\n/**\n * Returns a matrix that transforms a triangle t1 into another triangle t2, or throws an exception if it is impossible.\n * @param t1 {Point[]} Array of points containing the three points for the first triangle\n * @param t2 {Point[]} Array of points containing the three points for the second triangle\n * @returns {Matrix} Matrix which transforms t1 to t2\n * @throws Exception if the matrix becomes not invertible\n */\nexport function fromTriangles (t1, t2) {\n  // point p = first point of the triangle\n  const px1 = t1[0].x != null ? t1[0].x : t1[0][0]\n  const py1 = t1[0].y != null ? t1[0].y : t1[0][1]\n  const px2 = t2[0].x != null ? t2[0].x : t2[0][0]\n  const py2 = t2[0].y != null ? t2[0].y : t2[0][1]\n\n  // point q = second point of the triangle\n  const qx1 = t1[1].x != null ? t1[1].x : t1[1][0]\n  const qy1 = t1[1].y != null ? t1[1].y : t1[1][1]\n  const qx2 = t2[1].x != null ? t2[1].x : t2[1][0]\n  const qy2 = t2[1].y != null ? t2[1].y : t2[1][1]\n\n  // point r = third point of the triangle\n  const rx1 = t1[2].x != null ? t1[2].x : t1[2][0]\n  const ry1 = t1[2].y != null ? t1[2].y : t1[2][1]\n  const rx2 = t2[2].x != null ? t2[2].x : t2[2][0]\n  const ry2 = t2[2].y != null ? t2[2].y : t2[2][1]\n\n  const r1 = {\n    a: px1 - rx1,\n    b: py1 - ry1,\n    c: qx1 - rx1,\n    d: qy1 - ry1,\n    e: rx1,\n    f: ry1\n  }\n  const r2 = {\n    a: px2 - rx2,\n    b: py2 - ry2,\n    c: qx2 - rx2,\n    d: qy2 - ry2,\n    e: rx2,\n    f: ry2\n  }\n\n  const inverseR1 = inverse(r1)\n  const affineMatrix = transform([r2, inverseR1])\n\n  // round the matrix elements to smooth the finite inversion\n  return smoothMatrix(affineMatrix)\n}\n","import { fromObject } from './fromObject'\nimport { translate } from './translate'\nimport { scale } from './scale'\nimport { rotateDEG } from './rotate'\nimport { skewDEG } from './skew'\nimport { shear } from './shear'\n\n/**\n * Converts array of matrix descriptor to array of matrix\n * @param definitionOrArrayOfDefinition {Object[]} Array of object describing the matrix\n * @returns {Matrix[]} Array of matrix\n *\n * @example\n * > fromDefinition([\n *  { type: 'matrix', a:1, b:2, c:3, d:4, e:5, f:6 },\n *  { type: 'translate', tx: 10, ty: 20 },\n *  { type: 'scale', sx: 2, sy: 4 },\n *  { type: 'rotate', angle: 90, cx: 50, cy: 25 },\n *  { type: 'skewX', angle: 45 },\n *  { type: 'skewY',  angle: 45 },\n *  { type: 'shear', shx: 10, shy: 20}\n * ])\n *\n * [\n *  { a: 1, b: 2, c: 3, d: 4, e: 5, f: 6 },\n *  { a: 1, c: 0, e: 10, b: 0, d: 1, f: 20 },\n *  { a: 2, c: 0, e: 0, b: 0, d: 4, f: 0 },\n *  { a: 6.123, c: -1, e: 0, b: 1, d: 6.123, f: 0 },\n *  { a: 1, c: 0.99.., e: 0, b: 0, d: 1, f: 0 },\n *  { a: 1, c: 0, e: 0, b: 0.99, d: 1, f: 0 },\n *  { a: 1, c: 10, e: 0, b: 20, d: 1, f: 0 }\n * ]\n **/\nexport function fromDefinition (definitionOrArrayOfDefinition) {\n  return Array.isArray(definitionOrArrayOfDefinition)\n    ? definitionOrArrayOfDefinition.map(mapper)\n    : mapper(definitionOrArrayOfDefinition)\n\n  function mapper (descriptor) {\n    switch (descriptor.type) {\n      case 'matrix':\n        if ('a' in descriptor &&\n          'b' in descriptor &&\n          'c' in descriptor &&\n          'd' in descriptor &&\n          'e' in descriptor &&\n          'f' in descriptor\n        ) {\n          return fromObject(descriptor)\n        } else {\n          throw new Error('MISSING_MANDATORY_PARAM')\n        }\n\n      case 'translate':\n        if (!('tx' in descriptor)) throw new Error('MISSING_MANDATORY_PARAM')\n\n        if ('ty' in descriptor) return translate(descriptor.tx, descriptor.ty)\n\n        return translate(descriptor.tx)\n\n      case 'scale':\n        if (!('sx' in descriptor)) throw new Error('MISSING_MANDATORY_PARAM')\n\n        if ('sy' in descriptor) return scale(descriptor.sx, descriptor.sy)\n\n        return scale(descriptor.sx)\n\n      case 'rotate':\n        if (!('angle' in descriptor)) throw new Error('MISSING_MANDATORY_PARAM')\n\n        if ('cx' in descriptor && 'cy' in descriptor) {\n          return rotateDEG(descriptor.angle, descriptor.cx, descriptor.cy)\n        }\n        return rotateDEG(descriptor.angle)\n\n      case 'skewX':\n        if (!('angle' in descriptor)) throw new Error('MISSING_MANDATORY_PARAM')\n        return skewDEG(descriptor.angle, 0)\n\n      case 'skewY':\n        if (!('angle' in descriptor)) throw new Error('MISSING_MANDATORY_PARAM')\n        return skewDEG(0, descriptor.angle)\n\n      case 'shear':\n        if (!('shx' in descriptor && 'shy' in descriptor)) throw new Error('MISSING_MANDATORY_PARAM')\n        return shear(descriptor.shx, descriptor.shy)\n\n      default:\n        throw new Error('UNSUPPORTED_DESCRIPTOR')\n    }\n  }\n}\n","// Generated by PEG.js v0.11.0-master.b7b87ea, https://pegjs.org/\n\nfunction peg$subclass(child, parent) {\n  function C() { this.constructor = child; }\n  C.prototype = parent.prototype;\n  child.prototype = new C();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message = message;\n  this.expected = expected;\n  this.found = found;\n  this.location = location;\n  this.name = \"SyntaxError\";\n\n  // istanbul ignore next\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found, location) {\n  var DESCRIBE_EXPECTATION_FNS = {\n    literal: function(expectation) {\n      return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n    },\n\n    class: function(expectation) {\n      var escapedParts = expectation.parts.map(function(part) {\n        return Array.isArray(part)\n          ? classEscape(part[0]) + \"-\" + classEscape(part[1])\n          : classEscape(part);\n      });\n\n      return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n    },\n\n    any: function() {\n      return \"any character\";\n    },\n\n    end: function() {\n      return \"end of input\";\n    },\n\n    other: function(expectation) {\n      return expectation.description;\n    },\n\n    not: function(expectation) {\n      return \"not \" + describeExpectation(expectation.expected);\n    }\n  };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\"/g,  \"\\\\\\\"\")\n      .replace(/\\0/g, \"\\\\0\")\n      .replace(/\\t/g, \"\\\\t\")\n      .replace(/\\n/g, \"\\\\n\")\n      .replace(/\\r/g, \"\\\\r\")\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return \"\\\\x0\" + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return \"\\\\x\"  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, \"\\\\\\\\\")\n      .replace(/\\]/g, \"\\\\]\")\n      .replace(/\\^/g, \"\\\\^\")\n      .replace(/-/g,  \"\\\\-\")\n      .replace(/\\0/g, \"\\\\0\")\n      .replace(/\\t/g, \"\\\\t\")\n      .replace(/\\n/g, \"\\\\n\")\n      .replace(/\\r/g, \"\\\\r\")\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return \"\\\\x0\" + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return \"\\\\x\"  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = expected.map(describeExpectation);\n    var i, j;\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== undefined ? options : {};\n\n  var peg$FAILED = {};\n\n  var peg$startRuleFunctions = { transformList: peg$parsetransformList };\n  var peg$startRuleFunction = peg$parsetransformList;\n\n  var peg$c0 = \"matrix\";\n  var peg$c1 = \"(\";\n  var peg$c2 = \")\";\n  var peg$c3 = \"translate\";\n  var peg$c4 = \"scale\";\n  var peg$c5 = \"rotate\";\n  var peg$c6 = \"skewX\";\n  var peg$c7 = \"skewY\";\n  var peg$c8 = \",\";\n  var peg$c9 = \".\";\n\n  var peg$r0 = /^[eE]/;\n  var peg$r1 = /^[+\\-]/;\n  var peg$r2 = /^[0-9]/;\n  var peg$r3 = /^[ \\t\\r\\n]/;\n\n  var peg$e0 = peg$literalExpectation(\"matrix\", false);\n  var peg$e1 = peg$literalExpectation(\"(\", false);\n  var peg$e2 = peg$literalExpectation(\")\", false);\n  var peg$e3 = peg$literalExpectation(\"translate\", false);\n  var peg$e4 = peg$literalExpectation(\"scale\", false);\n  var peg$e5 = peg$literalExpectation(\"rotate\", false);\n  var peg$e6 = peg$literalExpectation(\"skewX\", false);\n  var peg$e7 = peg$literalExpectation(\"skewY\", false);\n  var peg$e8 = peg$literalExpectation(\",\", false);\n  var peg$e9 = peg$otherExpectation(\"fractionalConstant\");\n  var peg$e10 = peg$classExpectation([\"e\", \"E\"], false, false);\n  var peg$e11 = peg$classExpectation([\"+\", \"-\"], false, false);\n  var peg$e12 = peg$classExpectation([[\"0\", \"9\"]], false, false);\n  var peg$e13 = peg$classExpectation([\" \", \"\\t\", \"\\r\", \"\\n\"], false, false);\n\n  var peg$f0 = function(ts) { return ts; };\n  var peg$f1 = function(t, ts) { return t.concat(ts) };\n  var peg$f2 = function(a, b, c, d, e, f) {\n        return [{type: 'matrix', a: a, b: b, c: c, d: d, e: e, f: f}];\n      };\n  var peg$f3 = function(tx, ty) {\n        var t = {type: 'translate', tx: tx};\n        if (ty) t.ty = ty;\n        return [t];\n      };\n  var peg$f4 = function(sx, sy) {\n        var s = {type:'scale', sx: sx};\n        if (sy) s.sy = sy;\n        return [s];\n      };\n  var peg$f5 = function(angle, c) {\n        var r = {type:'rotate', angle: angle};\n        if (c) {\n          r.cx = c[0];\n          r.cy = c[1];\n        }\n        return [r];\n      };\n  var peg$f6 = function(angle) {\n        return [{type: 'skewX', angle: angle}];\n      };\n  var peg$f7 = function(angle) {\n        return [{type: 'skewY', angle: angle}];\n      };\n  var peg$f8 = function(f) { return parseFloat(f.join(\"\")); };\n  var peg$f9 = function(i) { return parseInt(i.join(\"\")); };\n  var peg$f10 = function(n) { return n; };\n  var peg$f11 = function(n1, n2) { return [n1, n2]; };\n  var peg$f12 = function(ds) { return ds.join(\"\"); };\n  var peg$f13 = function(f, e) { return [f, e || null].join(\"\")};\n  var peg$f14 = function(d, e) { return [d, e].join(\"\")};\n  var peg$f15 = function(d1, d2) { return [d1 ? d1.join(\"\") : null, \".\", d2.join(\"\")].join(\"\"); };\n  var peg$f16 = function(d) { return d.join(\"\"); };\n  var peg$f17 = function(s, d) { return ['e', s, d.join(\"\")].join(\"\") };\n\n  var peg$currPos = 0;\n  var peg$savedPos = 0;\n  var peg$posDetailsCache = [{ line: 1, column: 1 }];\n  var peg$expected = [];\n  var peg$silentFails = 0;\n\n  var peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function offset() {\n    return peg$savedPos;\n  }\n\n  function range() {\n    return [peg$savedPos, peg$currPos];\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== undefined\n      ? location\n      : peg$computeLocation(peg$savedPos, peg$currPos);\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== undefined\n      ? location\n      : peg$computeLocation(peg$savedPos, peg$currPos);\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos];\n    var p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line: details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n\n      return details;\n    }\n  }\n\n  var peg$VALIDFILENAME = typeof options.filename === \"string\" && options.filename.length > 0;\n  function peg$computeLocation(startPos, endPos) {\n    var loc = {};\n\n    if ( peg$VALIDFILENAME ) loc.filename = options.filename;\n\n    var startPosDetails = peg$computePosDetails(startPos);\n    loc.start = {\n      offset: startPos,\n      line: startPosDetails.line,\n      column: startPosDetails.column\n    };\n\n    var endPosDetails = peg$computePosDetails(endPos);\n    loc.end = {\n      offset: endPos,\n      line: endPosDetails.line,\n      column: endPosDetails.column\n    };\n\n    return loc;\n  }\n\n  function peg$begin() {\n    peg$expected.push({ pos: peg$currPos, variants: [] });\n  }\n\n  function peg$expect(expected) {\n    var top = peg$expected[peg$expected.length - 1];\n\n    if (peg$currPos < top.pos) { return; }\n\n    if (peg$currPos > top.pos) {\n      top.pos = peg$currPos;\n      top.variants = [];\n    }\n\n    top.variants.push(expected);\n  }\n\n  function peg$end(invert) {\n    var expected = peg$expected.pop();\n    var top = peg$expected[peg$expected.length - 1];\n    var variants = expected.variants;\n\n    if (top.pos !== expected.pos) { return; }\n\n    if (invert) {\n      variants = variants.map(function(e) {\n        return e.type === \"not\" ? e.expected : { type: \"not\", expected: e };\n      });\n    }\n\n    Array.prototype.push.apply(top.variants, variants);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found, location),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$buildError() {\n    var expected = peg$expected[0];\n    var failPos = expected.pos;\n\n    return peg$buildStructuredError(\n      expected.variants,\n      failPos < input.length ? input.charAt(failPos) : null,\n      failPos < input.length\n        ? peg$computeLocation(failPos, failPos + 1)\n        : peg$computeLocation(failPos, failPos)\n    );\n  }\n\n  function peg$parsetransformList() {\n    var s0, s1, s2, s3, s4;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = [];\n    s2 = peg$parsewsp();\n    while (s2 !== peg$FAILED) {\n      s1.push(s2);\n      s2 = peg$parsewsp();\n    }\n    s2 = peg$parsetransforms();\n    if (s2 === peg$FAILED) {\n      s2 = null;\n    }\n    s3 = [];\n    s4 = peg$parsewsp();\n    while (s4 !== peg$FAILED) {\n      s3.push(s4);\n      s4 = peg$parsewsp();\n    }\n    peg$savedPos = s0;\n    s0 = peg$f0(s2);\n\n    return s0;\n  }\n\n  function peg$parsetransforms() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parsetransform();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsecommaWsp();\n      if (s3 !== peg$FAILED) {\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          s3 = peg$parsecommaWsp();\n        }\n      } else {\n        s2 = peg$FAILED;\n      }\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsetransforms();\n        if (s3 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f1(s1, s3);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$parsetransform();\n    }\n\n    return s0;\n  }\n\n  function peg$parsetransform() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$parsematrix();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parsetranslate();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parsescale();\n        if (s0 === peg$FAILED) {\n          s0 = peg$parserotate();\n          if (s0 === peg$FAILED) {\n            s0 = peg$parseskewX();\n            if (s0 === peg$FAILED) {\n              s0 = peg$parseskewY();\n            }\n          }\n        }\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parsematrix() {\n    var s0, s1, s2, s3, s4, s5, s6, s7, s8, s9, s10, s11, s12, s13, s14, s15, s16, s17;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e0);\n    if (input.substr(peg$currPos, 6) === peg$c0) {\n      s1 = peg$c0;\n      peg$currPos += 6;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewsp();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewsp();\n      }\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s3 = peg$c1;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = [];\n        s5 = peg$parsewsp();\n        while (s5 !== peg$FAILED) {\n          s4.push(s5);\n          s5 = peg$parsewsp();\n        }\n        s5 = peg$parsenumber();\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parsecommaWsp();\n          if (s6 !== peg$FAILED) {\n            s7 = peg$parsenumber();\n            if (s7 !== peg$FAILED) {\n              s8 = peg$parsecommaWsp();\n              if (s8 !== peg$FAILED) {\n                s9 = peg$parsenumber();\n                if (s9 !== peg$FAILED) {\n                  s10 = peg$parsecommaWsp();\n                  if (s10 !== peg$FAILED) {\n                    s11 = peg$parsenumber();\n                    if (s11 !== peg$FAILED) {\n                      s12 = peg$parsecommaWsp();\n                      if (s12 !== peg$FAILED) {\n                        s13 = peg$parsenumber();\n                        if (s13 !== peg$FAILED) {\n                          s14 = peg$parsecommaWsp();\n                          if (s14 !== peg$FAILED) {\n                            s15 = peg$parsenumber();\n                            if (s15 !== peg$FAILED) {\n                              s16 = [];\n                              s17 = peg$parsewsp();\n                              while (s17 !== peg$FAILED) {\n                                s16.push(s17);\n                                s17 = peg$parsewsp();\n                              }\n                              rule$expects(peg$e2);\n                              if (input.charCodeAt(peg$currPos) === 41) {\n                                s17 = peg$c2;\n                                peg$currPos++;\n                              } else {\n                                s17 = peg$FAILED;\n                              }\n                              if (s17 !== peg$FAILED) {\n                                peg$savedPos = s0;\n                                s0 = peg$f2(s5, s7, s9, s11, s13, s15);\n                              } else {\n                                peg$currPos = s0;\n                                s0 = peg$FAILED;\n                              }\n                            } else {\n                              peg$currPos = s0;\n                              s0 = peg$FAILED;\n                            }\n                          } else {\n                            peg$currPos = s0;\n                            s0 = peg$FAILED;\n                          }\n                        } else {\n                          peg$currPos = s0;\n                          s0 = peg$FAILED;\n                        }\n                      } else {\n                        peg$currPos = s0;\n                        s0 = peg$FAILED;\n                      }\n                    } else {\n                      peg$currPos = s0;\n                      s0 = peg$FAILED;\n                    }\n                  } else {\n                    peg$currPos = s0;\n                    s0 = peg$FAILED;\n                  }\n                } else {\n                  peg$currPos = s0;\n                  s0 = peg$FAILED;\n                }\n              } else {\n                peg$currPos = s0;\n                s0 = peg$FAILED;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsetranslate() {\n    var s0, s1, s2, s3, s4, s5, s6, s7, s8;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e3);\n    if (input.substr(peg$currPos, 9) === peg$c3) {\n      s1 = peg$c3;\n      peg$currPos += 9;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewsp();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewsp();\n      }\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s3 = peg$c1;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = [];\n        s5 = peg$parsewsp();\n        while (s5 !== peg$FAILED) {\n          s4.push(s5);\n          s5 = peg$parsewsp();\n        }\n        s5 = peg$parsenumber();\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parsecommaWspNumber();\n          if (s6 === peg$FAILED) {\n            s6 = null;\n          }\n          s7 = [];\n          s8 = peg$parsewsp();\n          while (s8 !== peg$FAILED) {\n            s7.push(s8);\n            s8 = peg$parsewsp();\n          }\n          rule$expects(peg$e2);\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s8 = peg$c2;\n            peg$currPos++;\n          } else {\n            s8 = peg$FAILED;\n          }\n          if (s8 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f3(s5, s6);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsescale() {\n    var s0, s1, s2, s3, s4, s5, s6, s7, s8;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e4);\n    if (input.substr(peg$currPos, 5) === peg$c4) {\n      s1 = peg$c4;\n      peg$currPos += 5;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewsp();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewsp();\n      }\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s3 = peg$c1;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = [];\n        s5 = peg$parsewsp();\n        while (s5 !== peg$FAILED) {\n          s4.push(s5);\n          s5 = peg$parsewsp();\n        }\n        s5 = peg$parsenumber();\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parsecommaWspNumber();\n          if (s6 === peg$FAILED) {\n            s6 = null;\n          }\n          s7 = [];\n          s8 = peg$parsewsp();\n          while (s8 !== peg$FAILED) {\n            s7.push(s8);\n            s8 = peg$parsewsp();\n          }\n          rule$expects(peg$e2);\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s8 = peg$c2;\n            peg$currPos++;\n          } else {\n            s8 = peg$FAILED;\n          }\n          if (s8 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f4(s5, s6);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parserotate() {\n    var s0, s1, s2, s3, s4, s5, s6, s7, s8;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e5);\n    if (input.substr(peg$currPos, 6) === peg$c5) {\n      s1 = peg$c5;\n      peg$currPos += 6;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewsp();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewsp();\n      }\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s3 = peg$c1;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = [];\n        s5 = peg$parsewsp();\n        while (s5 !== peg$FAILED) {\n          s4.push(s5);\n          s5 = peg$parsewsp();\n        }\n        s5 = peg$parsenumber();\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parsecommaWspTwoNumbers();\n          if (s6 === peg$FAILED) {\n            s6 = null;\n          }\n          s7 = [];\n          s8 = peg$parsewsp();\n          while (s8 !== peg$FAILED) {\n            s7.push(s8);\n            s8 = peg$parsewsp();\n          }\n          rule$expects(peg$e2);\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s8 = peg$c2;\n            peg$currPos++;\n          } else {\n            s8 = peg$FAILED;\n          }\n          if (s8 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f5(s5, s6);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseskewX() {\n    var s0, s1, s2, s3, s4, s5, s6, s7;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e6);\n    if (input.substr(peg$currPos, 5) === peg$c6) {\n      s1 = peg$c6;\n      peg$currPos += 5;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewsp();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewsp();\n      }\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s3 = peg$c1;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = [];\n        s5 = peg$parsewsp();\n        while (s5 !== peg$FAILED) {\n          s4.push(s5);\n          s5 = peg$parsewsp();\n        }\n        s5 = peg$parsenumber();\n        if (s5 !== peg$FAILED) {\n          s6 = [];\n          s7 = peg$parsewsp();\n          while (s7 !== peg$FAILED) {\n            s6.push(s7);\n            s7 = peg$parsewsp();\n          }\n          rule$expects(peg$e2);\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s7 = peg$c2;\n            peg$currPos++;\n          } else {\n            s7 = peg$FAILED;\n          }\n          if (s7 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f6(s5);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseskewY() {\n    var s0, s1, s2, s3, s4, s5, s6, s7;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e7);\n    if (input.substr(peg$currPos, 5) === peg$c7) {\n      s1 = peg$c7;\n      peg$currPos += 5;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$parsewsp();\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$parsewsp();\n      }\n      rule$expects(peg$e1);\n      if (input.charCodeAt(peg$currPos) === 40) {\n        s3 = peg$c1;\n        peg$currPos++;\n      } else {\n        s3 = peg$FAILED;\n      }\n      if (s3 !== peg$FAILED) {\n        s4 = [];\n        s5 = peg$parsewsp();\n        while (s5 !== peg$FAILED) {\n          s4.push(s5);\n          s5 = peg$parsewsp();\n        }\n        s5 = peg$parsenumber();\n        if (s5 !== peg$FAILED) {\n          s6 = [];\n          s7 = peg$parsewsp();\n          while (s7 !== peg$FAILED) {\n            s6.push(s7);\n            s7 = peg$parsewsp();\n          }\n          rule$expects(peg$e2);\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s7 = peg$c2;\n            peg$currPos++;\n          } else {\n            s7 = peg$FAILED;\n          }\n          if (s7 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f7(s5);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsenumber() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$currPos;\n    s2 = peg$parsesign();\n    if (s2 === peg$FAILED) {\n      s2 = null;\n    }\n    s3 = peg$parsefloatingPointConstant();\n    if (s3 !== peg$FAILED) {\n      s2 = [s2, s3];\n      s1 = s2;\n    } else {\n      peg$currPos = s1;\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f8(s1);\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$currPos;\n      s2 = peg$parsesign();\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      s3 = peg$parseintegerConstant();\n      if (s3 !== peg$FAILED) {\n        s2 = [s2, s3];\n        s1 = s2;\n      } else {\n        peg$currPos = s1;\n        s1 = peg$FAILED;\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$f9(s1);\n      }\n      s0 = s1;\n    }\n\n    return s0;\n  }\n\n  function peg$parsecommaWspNumber() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parsecommaWsp();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsenumber();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s0 = peg$f10(s2);\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsecommaWspTwoNumbers() {\n    var s0, s1, s2, s3, s4;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parsecommaWsp();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsenumber();\n      if (s2 !== peg$FAILED) {\n        s3 = peg$parsecommaWsp();\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parsenumber();\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s0 = peg$f11(s2, s4);\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsecommaWsp() {\n    var s0, s1, s2, s3, s4;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = [];\n    s2 = peg$parsewsp();\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        s2 = peg$parsewsp();\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsecomma();\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      s3 = [];\n      s4 = peg$parsewsp();\n      while (s4 !== peg$FAILED) {\n        s3.push(s4);\n        s4 = peg$parsewsp();\n      }\n      s1 = [s1, s2, s3];\n      s0 = s1;\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsecomma();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$parsewsp();\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          s3 = peg$parsewsp();\n        }\n        s1 = [s1, s2];\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parsecomma() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e8);\n    if (input.charCodeAt(peg$currPos) === 44) {\n      s0 = peg$c8;\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parseintegerConstant() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parsedigitSequence();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$f12(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parsefloatingPointConstant() {\n    var s0, s1, s2;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    s1 = peg$parsefractionalConstant();\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseexponent();\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      peg$savedPos = s0;\n      s0 = peg$f13(s1, s2);\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsedigitSequence();\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parseexponent();\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f14(s1, s2);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parsefractionalConstant() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e9);\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parsedigitSequence();\n    if (s1 === peg$FAILED) {\n      s1 = null;\n    }\n    if (input.charCodeAt(peg$currPos) === 46) {\n      s2 = peg$c9;\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n    }\n    if (s2 !== peg$FAILED) {\n      s3 = peg$parsedigitSequence();\n      if (s3 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s0 = peg$f15(s1, s3);\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsedigitSequence();\n      if (s1 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 46) {\n          s2 = peg$c9;\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n        }\n        if (s2 !== peg$FAILED) {\n          peg$savedPos = s0;\n          s0 = peg$f16(s1);\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    }\n    peg$silentFails--;\n\n    return s0;\n  }\n\n  function peg$parseexponent() {\n    var s0, s1, s2, s3;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = peg$currPos;\n    rule$expects(peg$e10);\n    if (peg$r0.test(input.charAt(peg$currPos))) {\n      s1 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsesign();\n      if (s2 === peg$FAILED) {\n        s2 = null;\n      }\n      s3 = peg$parsedigitSequence();\n      if (s3 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s0 = peg$f17(s2, s3);\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsesign() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e11);\n    if (peg$r1.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsedigitSequence() {\n    var s0, s1;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    s0 = [];\n    s1 = peg$parsedigit();\n    if (s1 !== peg$FAILED) {\n      while (s1 !== peg$FAILED) {\n        s0.push(s1);\n        s1 = peg$parsedigit();\n      }\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsedigit() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e12);\n    if (peg$r2.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  function peg$parsewsp() {\n    var s0;\n\n    var rule$expects = function (expected) {\n      if (peg$silentFails === 0) peg$expect(expected);\n    }\n\n    rule$expects(peg$e13);\n    if (peg$r3.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n    }\n\n    return s0;\n  }\n\n  peg$begin();\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$expect(peg$endExpectation());\n    }\n\n    throw peg$buildError();\n  }\n}\n\nexport {\n  peg$SyntaxError as SyntaxError,\n  peg$parse as parse\n};\n\nexport default {\n  SyntaxError: peg$SyntaxError,\n  parse: peg$parse\n};\n","import { parse } from './fromTransformAttribute.autogenerated'\n\n/**\n * Parser for SVG Trasform Attribute http://www.w3.org/TR/SVG/coords.html#TransformAttribute <br/>\n * Warning: This should be considered BETA until it is released a stable version of pegjs.\n * @param transformString {string} Transform string as defined by w3 Consortium\n * @returns {MatrixDescriptor[]} Array of MatrixDescriptor\n *\n * @example\n * > fromTransformAttribute('translate(-10,-10) scale(2,2) translate(10,10)')\n * [\n *  { type: 'translate', tx: -10, ty: -10},\n *  { type: 'scale', sx: 2, sy: 2 },\n *  { type: 'translate', tx: 10, ty: 10}\n * ]\n *\n * > compose(fromDefinition(fromTransformAttribute('translate(-10, -10) scale(10, 10)')))\n * { a: 10, c: 0, e: -10, b: 0, d: 10, f: -10 }\n */\nexport function fromTransformAttribute (transformString) {\n  return parse(transformString)\n}\n"],"sourceRoot":""}